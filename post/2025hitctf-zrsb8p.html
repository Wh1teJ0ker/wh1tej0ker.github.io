<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>Wh1teJ0kerã®Blog</title>
<meta charset=utf-8><meta name=description content="Ladder@24Hçš„é–æˆ˜ï¼ŒğŸ¥¹æœ€åè¢«è¶…äº†"><meta name=author content="Wh1teJ0ker"><link rel=canonical href=https://wh1tej0ker.github.io/post/2025hitctf-zrsb8p.html><link rel=alternate type=application/rss+xml href=https://wh1tej0ker.github.io//index.xml title=Wh1teJ0kerã®Blog><script async defer data-website-id=56cc42c1-3656-4d3e-af3c-acded927b8ed src=https://analytics.umami.is/script.js></script><meta property="og:url" content="https://wh1tej0ker.github.io/post/2025hitctf-zrsb8p.html"><meta property="og:site_name" content="Wh1teJ0kerã®Blog"><meta property="og:title" content="2025HITCTF"><meta property="og:description" content="24Hçš„é–æˆ˜ï¼ŒğŸ¥¹æœ€åè¢«è¶…äº†"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2025-12-06T14:06:53+08:00"><meta property="article:modified_time" content="2025-12-09T22:40:16+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="2025HITCTF"><meta name=twitter:description content="24Hçš„é–æˆ˜ï¼ŒğŸ¥¹æœ€åè¢«è¶…äº†"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wh1tej0ker.github.io/post/"},{"@type":"ListItem","position":2,"name":"2025HITCTF","item":"https://wh1tej0ker.github.io/post/2025hitctf-zrsb8p.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"2025HITCTF","name":"2025HITCTF","description":"24Hçš„é–æˆ˜ï¼ŒğŸ¥¹æœ€åè¢«è¶…äº†","keywords":[],"articleBody":"2025HITCTF Misc 5-Layer-Fog æ‰“å¼€ flag_cert.pemï¼Œè¿™æ˜¯ä¸€ä¸ª X.509 è¯ä¹¦ï¼Œsubject/issuer é‡Œå†™ç€ï¼š\nâ€‹algorithms: Xor+Base64, Rot13, BasE64, CaEsAr(3), SwApCaSeâ€‹\nç”¨åº“ï¼ˆå¦‚ cryptographyï¼‰è§£æè¯ä¹¦ï¼Œå‘ç°æœ‰ä¸€ä¸ªè‡ªå®šä¹‰æ‰©å±• OID 1.2.3.4.5.6.7.8.1ï¼Œå†…å®¹æ˜¯ä¸€ä¸² Base64ï¼š\nâ€‹uMkIvhvNuWSdaWu5tXW0qNAotWoeaXyCvMT5egIvqjqbSqEEy3ylSW4wUhgASqo3unywvrEmUhcYSNu4tnv5rrAlvZEhwqALtjAIUg==â€‹\nå¯¹è¿™ä¸²å¯†æ–‡æŒ‰æç¤ºåšâ€œé€†æ“ä½œâ€ï¼š\nå…ˆ swapcaseï¼ˆå¤§å°å†™äº’æ¢ï¼‰ å† Caesar -3ï¼ˆè¿˜åŸ CaEsAr(3)ï¼‰ å† rot13â€‹ ç„¶å Base64 è§£ç  å¾—åˆ°ä¸€æ®µäºŒè¿›åˆ¶æ•°æ®ï¼Œå¯¹å®ƒåšå•å­—èŠ‚ XOR çˆ†ç ´ï¼Œkey = 0x40ï¼ˆå³å­—ç¬¦ '@'ï¼‰æ—¶å¾—åˆ°æ–°çš„ Base64 ä¸²ï¼š\nâ€‹SElUQ1RGMjAyNXtCYXNFNjRfWG9yKEApK0Jhc2U2NF9Td0FwQ2FTZV9Sb3QxM19DYUVzQXIoMyl9â€‹ æœ€åå† Base64 è§£ç ï¼Œå³ä¸ºä¸Šé¢çš„ flagã€‚ gptç§’äº†\n1 https://chatgpt.com/share/6933cf1b-d090-800f-969a-6d83684b747d Regex Beast â€\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 import re import sys # Increase recursion limit just in case sys.setrecursionlimit(2000000) def solve(): print(\"Reading file...\") try: with open('/Users/joker/Code/2025HITCTF/enc.txt', 'r') as f: content = f.read().strip() except FileNotFoundError: print(\"File not found.\") return if content.startswith('/'): content = content[1:] # Simple check for trailing characters # The file ends with ...)) so we might want to trim until the last ) # But usually strip() is enough if there are no flags print(\"Extracting blocks...\") block_map = {} reverse_map = {} next_id = 0 def replace_callback(match): nonlocal next_id b = match.group(0) if b not in block_map: block_map[b] = next_id reverse_map[next_id] = b next_id += 1 return f'B{block_map[b]} ' content_sub = re.sub(r'(?:\\\\x[0-9a-f]{2})+', replace_callback, content) print(f\"Unique blocks: {len(block_map)}\") # Tokenize # Add spaces around special chars to split easily tokens_str = content_sub.replace('(?:', ' ( ').replace('(?=', ' [ ').replace(')', ' ) ').replace('|', ' | ') tokens = tokens_str.split() print(f\"Total tokens: {len(tokens)}\") stack = [] # Root frame # A frame represents the current Group or Lookahead being parsed. # alts: list of Alternatives. # Alternative: list of Terms. # Term: (SetOfPaths, is_lookahead) stack.append({ 'type': 'ROOT', 'alts': [ [] ] }) def make_block_set(bid): return { (bid,) } def union_sets(sets): res = set() for s in sets: res.update(s) return res def concat_sets(list_of_sets): if not list_of_sets: return {()} # If any set is empty, result is empty (invalid path) for s in list_of_sets: if not s: return set() res = list_of_sets[0] for i in range(1, len(list_of_sets)): next_s = list_of_sets[i] new_res = set() # If sets are large, this cross product is expensive. # But we expect singletons. if len(res) \u003e 100 or len(next_s) \u003e 100: print(f\"Warning: Large sets in concat: {len(res)} * {len(next_s)}\") for p1 in res: for p2 in next_s: new_res.add(p1 + p2) res = new_res if not res: break return res def intersect_sets(s1, s2): return s1.intersection(s2) for i, tok in enumerate(tokens): if i % 50000 == 0: print(f\"Processing token {i}/{len(tokens)} stack depth {len(stack)}\") if tok == '(': stack.append({ 'type': 'GROUP', 'alts': [ [] ] }) elif tok == '[': # Lookahead stack.append({ 'type': 'LOOKAHEAD', 'alts': [ [] ] }) elif tok == '|': stack[-1]['alts'].append([]) elif tok == ')': frame = stack.pop() # Evaluate alternatives alt_results = [] for alt in frame['alts']: # alt is list of (Set, is_lookahead) # Concatenate them # If we have [ (A, True), (B, False) ] -\u003e A \\cap B # If we have [ (A, False), (B, True) ] -\u003e A + B (and B is asserted) # Wait, my logic in the loop below handles the merge of (Lookahead, Next). # So `alt` here already contains merged terms? # No, `alt` contains the terms accumulated in this frame. # But inside the loop (elif tok == 'B' or tok == ')') we merge into parent. # Here we are processing the CLOSED frame. # We need to evaluate the content OF THE FRAME. # Inside the frame, we also had terms. # The terms inside the frame were already merged? # No. `stack[-1]` refers to the frame we are building. # When we are IN the frame, we append terms to IT. # So `frame['alts']` contains the terms. # We need to process the terms in the alternative. # The logic `if current_alt and current_alt[-1][1]: merge` # was applied when ADDING to the frame. # So `alt` list is already \"Lookaheads merged into following consumers\". # EXCEPT for trailing lookaheads. sets_to_concat = [x[0] for x in alt] val = concat_sets(sets_to_concat) alt_results.append(val) frame_res = union_sets(alt_results) is_lookahead = (frame['type'] == 'LOOKAHEAD') if not stack: # Should not happen if balanced break parent = stack[-1] current_alt = parent['alts'][-1] # Merge into parent if is_lookahead: current_alt.append( (frame_res, True) ) else: if current_alt and current_alt[-1][1]: prev_set, _ = current_alt.pop() inter = intersect_sets(prev_set, frame_res) current_alt.append( (inter, False) ) else: current_alt.append( (frame_res, False) ) elif tok.startswith('B'): bid = int(tok[1:]) s = make_block_set(bid) parent = stack[-1] current_alt = parent['alts'][-1] if current_alt and current_alt[-1][1]: prev_set, _ = current_alt.pop() inter = intersect_sets(prev_set, s) current_alt.append( (inter, False) ) else: current_alt.append( (s, False) ) # Final result root_frame = stack[0] final_sets = [] for alt in root_frame['alts']: sets_to_concat = [x[0] for x in alt] final_sets.append(concat_sets(sets_to_concat)) final_res = union_sets(final_sets) print(f\"Found {len(final_res)} valid paths.\") if len(final_res) \u003e 0: path = list(final_res)[0] decoded = b'' for bid in path: hex_str = reverse_map[bid] parts = hex_str.split(r'\\x') for p in parts: if p: decoded += bytes.fromhex(p) with open('decoded_flag.txt', 'wb') as f: f.write(decoded) print(\"Decoded flag written to decoded_flag.txt\") # Check if it's a zip or text # print head print(\"First 100 bytes:\", decoded[:100]) if __name__ == '__main__': solve() 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 import re def analyze(): with open('/Users/joker/Code/2025HITCTF/enc.txt', 'r') as f: content = f.read() # Find all hex blocks # A block seems to be a sequence of \\xNN # Let's assume they are reasonably long to avoid matching short things if any # The snippet shows long blocks. # We'll regex replace them. block_pattern = re.compile(r'(?:\\\\x[0-9a-f]{2})+') unique_blocks = {} next_id = 0 def replace_func(match): nonlocal next_id block = match.group(0) if block not in unique_blocks: unique_blocks[block] = next_id next_id += 1 return f'BLOCK_{unique_blocks[block]}' simplified = block_pattern.sub(replace_func, content) print(f\"Found {len(unique_blocks)} unique blocks.\") print(\"Simplified structure (first 500 chars):\") print(simplified[:500]) # Let's also print the simplified structure around the middle to see if it changes print(\"Simplified structure (middle):\") mid = len(simplified) // 2 print(simplified[mid:mid+500]) if __name__ == '__main__': analyze() ç„¶åæ‰«ç å³å¯\ntraeç§’äº†\nBerkeley ä½¿ç”¨elf freebsdçš„æ–‡ä»¶å¤´ï¼Œè¿›è¡Œæ˜æ–‡æ”»å‡»\n1 echo -n \"7f454c4602010109000000000000000004003e00010000000000000000000000\" | xxd -r -ps \u003e freebsd_header1 è¿™é‡Œçš„æ–‡ä»¶å¤´æ˜¯æŸ¥è¯¢äº†Berkeleyè”æƒ³åˆ°freebsdç³»ç»Ÿï¼Œå› æ­¤éƒ¨åˆ†å­—èŠ‚éœ€è¦ä¸€è‡´\n1 bkcrack.exe -C strong_encrypted.zip -c veracrypt.core -p freebsd_header1 -o 0 æå–å‡ºæ¥äº†1å’Œcoreæ–‡ä»¶\n1 2 bkcrack -C strong_encrypted.zip -c veracrypt.core -k 25b0091d 6687a00d 791e474d -d veracrypt.core bkcrack -C strong_encrypted.zip -c veracrypt.core -k 25b0091d 6687a00d 791e474d -d 1 åœ¨coreæ–‡ä»¶å†…æŸ¥æ‰¾åˆ°å¯†ç \n1 strings veracrypt.core | grep -i \"password\" ç„¶åçœ‹åˆ°è¿™ä¸ªSecurePassword12\nç„¶åæŒ‚è½½\nä½¿ç”¨rstudioå°±å¯ä»¥æ‰«ææ¢å¤æ–‡ä»¶ï¼Œåœ¨.snapä¸‹æ‰¾åˆ°2ï¼Œç‚¹è¿›å»å°±æ˜¯flag\n1 flag{Fr33BSD_part1t10n_taB1e_Is_StraNg3} VanYouSee ğŸ¤¡ä¿®äº†ä¸€ä¸ªæ™šä¸Š\n1 https://pan.baidu.com/s/1Tzad98GtbeuLs5RS0V_wuw?pwd=avev Crypto Scan4fLaG æ‰«ç å¾—\nPSï¼šè¢«å¯†ç æ‰‹çŒœå‡ºæ¥çš„ï¼Œéƒéƒäº†ğŸ¤¡\nåˆ†ç¦»å‹ç¼©åŒ…ï¼Œç”¨ä¸Šé¢çš„å¯†ç è§£å¯†\nReverse EasyVm ä¸ƒé“reï¼Œæˆ‘ä»¬ä¸€ä¸ªreæ‰‹ä¸å ªé‡ä»»ï¼Œå¸®å¿™åšäº†ä¸€é¢˜easyçš„ï¼ŒAIå¤ªå¥½ç”¨äº†\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 #!/usr/bin/env python3 # -*- coding: utf-8 -*- \"\"\" é€†å‘è‡ª Calendar.dll ä¸­çš„è‡ªå®šä¹‰ VMï¼Œæ¢å¤ FLAG çš„è„šæœ¬ã€‚ æ€è·¯ç®€è¿°ï¼š 1. æŠŠ .rdata é‡Œçš„å­—èŠ‚ç æŠ„å‡ºæ¥ï¼ˆ0x14001DA90 é‚£ä¸€æ®µï¼‰ã€‚ 2. æŒ‰ç…§ sub_140001270 çš„é€»è¾‘å†™ä¸€ä¸ª Python ç‰ˆ VM è§£é‡Šå™¨ã€‚ 3. æ ¹æ®é€†å‘åˆ†æå¾—åˆ°çš„ç­‰å¼ï¼ˆå…¨æ˜¯ + / - / ^ / == è¿™ç§ï¼‰ï¼Œåœ¨ Python é‡Œ æŠŠå„ä¸ªå­—ç¬¦ç®—å‡ºæ¥ï¼Œç»„è£…å‡º flagï¼Œå¹¶ç”¨ VM çœŸå®è·‘ä¸€éæ ¡éªŒã€‚ \"\"\" # ---------------------------- # 1. è¿˜åŸå‡ºæ¥çš„ VM å­—èŠ‚ç  # ---------------------------- CODE = bytes([ 0x0D,0x3C,0x01,0x06,0x0A,0x01,0x02,0x6F,0x01,0x00,0x57,0x01,0x05,0x21,0x01,0x03, 0x6E,0x01,0x01,0x72,0x01,0x04,0x67,0x01,0x07,0x00,0x11,0x00,0x01,0x04,0x65,0x01, 0x05,0x63,0x01,0x09,0x00,0x01,0x01,0x6F,0x01,0x03,0x72,0x01,0x07,0x21,0x01,0x02, 0x72,0x01,0x08,0x0A,0x01,0x00,0x43,0x01,0x06,0x74,0x11,0x00,0x10,0x02,0x00,0x00, 0x0C,0x00,0x66,0x0E,0x02,0x02,0x00,0x01,0x03,0x01,0x00,0x06,0x01,0x01,0x0C,0x01, 0x6D,0x0E,0x02,0x02,0x01,0x02,0x02,0x02,0x03,0x02,0x03,0x04,0x03,0x00,0x01,0x09, 0x00,0x02,0x0C,0x00,0x06,0x0E,0x02,0x03,0x00,0x02,0x09,0x00,0x03,0x0C,0x00,0x1C, 0x0E,0x02,0x03,0x00,0x01,0x09,0x00,0x03,0x0C,0x00,0x1A,0x0E,0x02,0x02,0x01,0x05, 0x02,0x02,0x06,0x02,0x03,0x07,0x0C,0x02,0x69,0x0E,0x02,0x03,0x00,0x01,0x09,0x00, 0x02,0x0C,0x00,0x21,0x0E,0x02,0x03,0x00,0x03,0x09,0x00,0x02,0x0C,0x00,0x3D,0x0E, 0x02,0x02,0x04,0x08,0x02,0x05,0x09,0x02,0x06,0x0A,0x0B,0x05,0x03,0x0E,0x02,0x03, 0x00,0x04,0x09,0x00,0x05,0x0C,0x00,0x17,0x0E,0x02,0x03,0x00,0x06,0x09,0x00,0x05, 0x0C,0x00,0x12,0x0E,0x02,0x02,0x01,0x0B,0x02,0x02,0x0C,0x02,0x03,0x0D,0x02,0x04, 0x0E,0x02,0x05,0x0F,0x02,0x06,0x10,0x02,0x07,0x11,0x0B,0x02,0x04,0x0E,0x02,0x03, 0x00,0x01,0x05,0x00,0x00,0x0C,0x00,0xBE,0x0E,0x02,0x09,0x00,0x00,0x0B,0x00,0x07, 0x0E,0x02,0x05,0x00,0x02,0x0C,0x00,0x32,0x0E,0x02,0x08,0x00,0x02,0x0C,0x00,0x30, 0x0E,0x02,0x06,0x00,0x05,0x0B,0x00,0x05,0x0E,0x02,0x02,0x00,0x04,0x07,0x06,0x00, 0x0C,0x06,0x02,0x0E,0x02,0x0D,0x1C,0x00 ]) # æ“ä½œç åˆ°åå­—ï¼Œä»…ç”¨äºè°ƒè¯•ï¼ˆè„šæœ¬çœŸæ­£æ‰§è¡Œä¸ä¾èµ–è¿™ä¸ªï¼‰ OPMAP = { 0: \"HALT\", 1: \"STORE\", 2: \"LDMEM\", 3: \"MOV\", 4: \"LDI\", 5: \"ADD\", 6: \"ADD_I\", 7: \"SUB\", 8: \"SUB_I\", 9: \"XOR\", 10: \"XOR_I\", 11: \"CMP\", 12: \"CMP_I\", 13: \"JMP\", 14: \"JNZ\", 16: \"IN\", 17: \"OUT\", } # ------------------------------------------------- # 2. Python ç‰ˆ VM è§£é‡Šå™¨ï¼šä»¿ sub_140001270 çš„æ ¸å¿ƒé€»è¾‘ # ------------------------------------------------- def vm_run(flag_bytes: bytes, debug: bool = False) -\u003e bool: \"\"\" ç”¨ Python è·‘ä¸€é VM é€»è¾‘ï¼Œåˆ¤æ–­ç»™å®šè¾“å…¥æ˜¯å¦èµ°åˆ°â€œæ­£ç¡®â€åˆ†æ”¯ã€‚ flag_bytesï¼šæˆ‘ä»¬è¦ä¼ ç»™ VM çš„â€œè¾“å…¥å­—ç¬¦ä¸²â€ï¼ˆä¸å« \\nï¼‰ï¼Œ VM è¯»ä¸åˆ°çš„ä½ç½®æŒ‰ 0 å¤„ç†ã€‚ è¿”å›å€¼ï¼šTrue è¡¨ç¤ºé€šè¿‡æ‰€æœ‰æ ¡éªŒï¼Œèµ°åˆ°äº†æˆåŠŸåˆ†æ”¯ï¼›False è¡¨ç¤ºèµ°é”™åˆ†æ”¯ã€‚ \"\"\" code = CODE regs = [0] * 8 # 8 ä¸ªé€šç”¨å¯„å­˜å™¨ r0..r7ï¼Œæ¯ä¸ª 32 bit zf = 0 # åªæ¨¡æ‹Ÿ Zero Flagï¼ˆZFï¼‰ï¼Œå¯¹åº” a1+1064 çš„æœ€ä½ä½ ip = 0 # instruction pointerï¼Œä» 0 å¼€å§‹ steps = 0 # å®é™… VM é‡Œï¼šè¾“å…¥ä» a1+1084 å¼€å§‹ï¼Œæˆ‘ä»¬è¿™é‡Œç›´æ¥ç”¨ flag_bytes æ•°ç»„ä»£æ›¿ def read_input(idx: int) -\u003e int: return flag_bytes[idx] if idx \u003c len(flag_bytes) else 0 while ip \u003c len(code): steps += 1 if steps \u003e 20000: # ç†è®ºä¸Šä¸ä¼šæ­»å¾ªç¯ï¼Œè¿™é‡ŒåŠ ä¸ªä¿é™© raise RuntimeError(\"VM å¯èƒ½é™·å…¥æ­»å¾ªç¯ï¼Œç»ˆæ­¢è°ƒè¯•\") op = code[ip] if debug: print(f\"IP={ip:03d} OP={op:02X} {OPMAP.get(op, '?'):\u003c5} regs={regs} ZF={zf}\") # ------- æ— å‚æ•°æŒ‡ä»¤ ------- if op == 0: # HALT # é¢˜ç›®é‡Œæœ‰ä¸¤ä¸ª HALTï¼š # - é”™è¯¯åˆ†æ”¯æ˜¯å‰é¢æ„é€  \"Wrong...\" åçš„ HALTï¼ˆåœ¨ ip=27ï¼‰ # - æ­£ç¡®åˆ†æ”¯åœ¨æœ€åæ„é€  \"Correct!\" å HALTï¼ˆåœ¨ ip=279ï¼‰ return ip != 27 elif op == 16: # INï¼šçœŸå®ç¨‹åºé‡Œ fgets è¯»å…¥ï¼Œæˆ‘ä»¬åœ¨è„šæœ¬ä¸­ç›´æ¥å¿½ç•¥ ip += 1 continue elif op == 17: # OUTï¼šçœŸå®ç¨‹åºæŠŠ a1+1134 çš„å­—ç¬¦ä¸²è¾“å‡ºï¼Œè¿™é‡Œä¹Ÿç›´æ¥è·³è¿‡ ip += 1 continue # ------- å•å­—èŠ‚å‚æ•°ï¼ˆè·³è½¬ï¼‰ ------- elif op == 13: # JMP imm8 target = code[ip + 1] ip = target continue elif op == 14: # JNZ imm8 ï¼šå¦‚æœ ZF == 0 å°±è·³è½¬ target = code[ip + 1] if zf == 0: ip = target else: ip += 2 continue # ------- åŒå­—èŠ‚å‚æ•°çš„ç®—æœ¯ / è®¿å­˜ / mov / cmp ------- # ä¸‹é¢æ‰€æœ‰åˆ†æ”¯éƒ½ä¼šè¯»ä¸¤ä¸ªç´§è·Ÿçš„å­—èŠ‚ä½œä¸ºå‚æ•° # å½¢å¼ç»Ÿä¸€ï¼š [op, a, b] # -------------------------------------------- if ip + 2 \u003e= len(code): # é˜²å¾¡æ€§æ£€æŸ¥ raise RuntimeError(\"å­—èŠ‚ç éæ³•ï¼Œè¯»å–è¶Šç•Œ\") a = code[ip + 1] b = code[ip + 2] # è¯´æ˜ï¼šåŸ VM å¯¹å¯„å­˜å™¨ç¼–å· \u003e=8 ä¼šè¿”å›é”™è¯¯ï¼Œè¿™ä¸ªå­—èŠ‚ç é‡Œéƒ½åœ¨ 0..7 èŒƒå›´ if op == 1: # STOREï¼›åªå½±å“ VM å†…éƒ¨çš„è¾“å‡ºç¼“å†²ï¼Œå¯¹é€»è¾‘æ— å½±å“ï¼Œè¿™é‡Œå¿½ç•¥ ip += 3 continue elif op == 2: # LDMEM r, idx -\u003e ä»è¾“å…¥ç¼“å†² flag[idx] è¯»å…¥å¯„å­˜å™¨ r, idx = a, b regs[r] = read_input(idx) ip += 3 continue elif op == 3: # MOV rd, rs rd, rs = a, b regs[rd] = regs[rs] ip += 3 continue elif op == 4: # LDI r, imm8 r, imm = a, b regs[r] = imm ip += 3 continue elif op == 5: # ADD rd, rs rd, rs = a, b regs[rd] = (regs[rd] + regs[rs]) \u0026 0xFFFFFFFF zf = 1 if regs[rd] == 0 else 0 ip += 3 continue elif op == 6: # ADD_I r, imm8 r, imm = a, b regs[r] = (regs[r] + imm) \u0026 0xFFFFFFFF zf = 1 if regs[r] == 0 else 0 ip += 3 continue elif op == 7: # SUB rd, rs rd, rs = a, b regs[rd] = (regs[rd] - regs[rs]) \u0026 0xFFFFFFFF zf = 1 if regs[rd] == 0 else 0 ip += 3 continue elif op == 8: # SUB_I r, imm8 r, imm = a, b regs[r] = (regs[r] - imm) \u0026 0xFFFFFFFF zf = 1 if regs[r] == 0 else 0 ip += 3 continue elif op == 9: # XOR rd, rs rd, rs = a, b regs[rd] = regs[rd] ^ regs[rs] zf = 1 if regs[rd] == 0 else 0 ip += 3 continue elif op == 10: # XOR_I r, imm8 r, imm = a, b regs[r] = regs[r] ^ imm zf = 1 if regs[r] == 0 else 0 ip += 3 continue elif op == 11: # CMP r1, r2 -\u003e è®¾ç½® ZF = (r1 - r2 == 0) r1, r2 = a, b res = (regs[r1] - regs[r2]) \u0026 0xFFFFFFFF zf = 1 if res == 0 else 0 ip += 3 continue elif op == 12: # CMP_I r, imm8 -\u003e è®¾ç½® ZF = (r - imm == 0) r, imm = a, b res = (regs[r] - imm) \u0026 0xFFFFFFFF zf = 1 if res == 0 else 0 ip += 3 continue else: raise RuntimeError(f\"æœªçŸ¥æŒ‡ä»¤ op={op} @ ip={ip}\") # æ­£å¸¸ä¸ä¼šè·‘åˆ°è¿™é‡Œ return False # ------------------------------------------------- # 3. åˆ©ç”¨é€†å‘å‡ºæ¥çš„æ–¹ç¨‹ï¼Œåœ¨ Python é‡Œè¿˜åŸ FLAG # ------------------------------------------------- def solve_flag() -\u003e str: \"\"\" æ ¹æ® VM ä¸­çš„æ¯”è¾ƒä¸è·³è½¬é€»è¾‘ï¼Œæ¢å¤æ‰€æœ‰å­—ç¬¦ã€‚ è¿™é‡Œåªåšâ€œæ•°å­¦è§£æ–¹ç¨‹â€ï¼Œè€Œä¸æ˜¯çæšä¸¾ã€‚ \"\"\" # flag[i] ä»£è¡¨ç¬¬ i ä¸ªå­—ç¬¦ï¼ˆ0-basedï¼‰ flag = [0] * 17 # å®é™…ç”¨åˆ°ç´¢å¼• 0..16ï¼Œå…¶ä¸­ 17 ä½ç½®åœ¨å†…å­˜ä¸­æ˜¯ 0 ç»ˆæ­¢ç¬¦ # ---- 0,1: ç›´æ¥æ¯”è¾ƒ ---- # LDMEM r0, [0] ; CMP_I r0, 102 ('f') flag[0] = ord('f') # LDMEM r0, [1] ; MOV r1, r0 ; ADD_I r1, 1 ; CMP_I r1, 109 # =\u003e flag[1] + 1 = 109 -\u003e flag[1] = 108 ('l') flag[1] = ord('l') # ---- 2,3,4: ä¸‰ä¸ªå¼‚æˆ–æ–¹ç¨‹ ---- # r1 = flag[2] # r2 = flag[3] # r3 = flag[4] # CMP_I (r1 ^ r2), 6 # CMP_I (r2 ^ r3), 28 # CMP_I (r1 ^ r3), 26 # # è¿™ç»„æ–¹ç¨‹æœ‰å¾ˆå¤šæ•°å€¼è§£ï¼Œä½†æˆ‘ä»¬çŸ¥é“ä¸€èˆ¬ CTF flag ä¼šæ˜¯ \"flag{...}\" # ä»£å…¥ 'a','g','{' å¯ä»¥éªŒè¯ï¼š # ord('a') ^ ord('g') == 6 # ord('g') ^ ord('{') == 28 # ord('a') ^ ord('{') == 26 flag[2] = ord('a') flag[3] = ord('g') flag[4] = ord('{') # ---- 5,6,7: ä¸ 'H','i','T' ç›¸å…³ ---- # LDMEM r1,[5]; LDMEM r2,[6]; LDMEM r3,[7] # CMP_I r2, 105 -\u003e flag[6] == 'i' flag[6] = ord('i') # MOV r0,r1; XOR r0,r2; CMP_I r0,33 -\u003e flag[5] ^ flag[6] = 33 # ord('H') ^ ord('i') == 72 ^ 105 == 33 flag[5] = ord('H') # MOV r0,r3; XOR r0,r2; CMP_I r0,61 -\u003e flag[7] ^ flag[6] = 61 -\u003e flag[7] = 84 'T' flag[7] = ord('T') # ---- 8,9,10: ä¸å‰é¢çš„ 'T' ç»„åˆå‡ºæ¥ \"CTF\" ---- # LDMEM r4,[8]; LDMEM r5,[9]; LDMEM r6,[10] # CMP r5,r3 -\u003e flag[9] == flag[7] == 'T' flag[9] = flag[7] # 'T' # MOV r0,r4; XOR r0,r5; CMP_I r0,23 -\u003e flag[8] ^ flag[9] = 23 # MOV r0,r6; XOR r0,r5; CMP_I r0,18 -\u003e flag[10] ^ flag[9] = 18 flag[8] = flag[9] ^ 23 # 'C' flag[10] = flag[9] ^ 18 # 'F' # éªŒè¯ä¸€ä¸‹ï¼šchr(flag[8]) == 'C', chr(flag[9]) == 'T', chr(flag[10]) == 'F' # ---- 11..16: å°¾å·´éƒ¨åˆ† ---- # LDMEM r1,[11] ; r1 = flag[11] # CMP_I (r1+r1), 190 -\u003e 2*flag[11] = 190 -\u003e flag[11] = 95 -\u003e '_' flag[11] = ord('_') # r7 = flag[17], ç»è¿‡ä¸€ç³»åˆ—æ“ä½œåè¦æ±‚ 0ï¼Œè¯´æ˜ç¬¬ 18 ä¸ªä½ç½®æ˜¯ 0 ç»ˆæ­¢ç¬¦ï¼Œ # è€Œä¸æ˜¯æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ï¼ˆä¹Ÿå°±æ˜¯è¯´è¾“å…¥é•¿åº¦ä¸ç”¨åˆ° 18ï¼‰ã€‚ # CMP r2,r4 -\u003e flag[12] == flag[14] # åé¢ï¼š # r0 = flag[12]; CMP_I r0,50 -\u003e flag[12] == '2' # ç„¶å r0 -= 2 == 48 å†åŠ  5 == 53 ä¸ flag[15] æ¯”è¾ƒ -\u003e flag[15] == '5' flag[12] = ord('2') flag[14] = ord('2') flag[15] = ord('5') # æœ€åï¼š # LDMEM r0,[4] -\u003e r0=flag[4]='{' # SUB r6,r0 -\u003e r6 = flag[16] - flag[4] # CMP_I r6,2 -\u003e flag[16] - flag[4] = 2 -\u003e flag[16] = '{' + 2 = '}' flag[16] = ord('}') # 123 + 2 = 125 -\u003e '}' # flag[13] åœ¨å­—èŠ‚ç ä¸­ä»…è¢« LDMEM è¯»å…¥ï¼Œä»æœªå‚ä¸æ¯”è¾ƒï¼Œå› æ­¤æ˜¯è‡ªç”±å˜é‡ã€‚ # ç»“åˆ CTF å¹´ä»½ï¼Œâ€œ_2 0 2 5â€ æ¯”è¾ƒè‡ªç„¶ï¼Œæˆ‘ä»¬å°±å¡« '0'ã€‚ flag[13] = ord('0') return \"\".join(chr(c) for c in flag) def main(): flag = solve_flag() print(\"Recovered flag:\", flag) # ç”¨ VM çœŸæœºè·‘ä¸€éæ ¡éªŒ ok = vm_run(flag.encode()) print(\"VM check:\", \"PASS\" if ok else \"FAIL\") if not ok: raise SystemExit(\"æ±‚å‡ºæ¥çš„ flag æ²¡é€šè¿‡ VM æ ¡éªŒï¼Œè¯·æ£€æŸ¥è„šæœ¬é€»è¾‘ã€‚\") if __name__ == \"__main__\": main() ","wordCount":"4271","inLanguage":"en","datePublished":"2025-12-06T14:06:53+08:00","dateModified":"2025-12-09T22:40:16+08:00","author":{"@type":"Person","name":"Wh1teJ0ker"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wh1tej0ker.github.io/post/2025hitctf-zrsb8p.html"},"publisher":{"@type":"Organization","name":"Wh1teJ0kerã®Blog","logo":{"@type":"ImageObject","url":"https://wh1tej0ker.github.io/favicon.ico"}}}</script><link rel=icon type=image/png href=/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/favicon.ico><link rel=manifest href=/favicon.ico><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.9d998bab4720091d5ec1e0fbbffd92b254a2e791623df6106cd7ea760bfc5c28.css integrity="sha256-nZmLq0cgCR1eweD7v/2SslSi55FiPfYQbNfqdgv8XCg=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.c607d6febd16934a82eb61d3a896ed9d869f54373cc63ce95864ed5488fe3128.js></script><script>hljs.highlightAll()</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/categories/>åˆ†ç±»</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives/>å½’æ¡£</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/friends/>å‹é“¾</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/about/>å…³äº</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=https://cloud.umami.is/share/5RZUCwaG2fOysYPa/wh1tej0ker.github.io>Dashboard</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/Wh1teJ0ker><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>2025HITCTF</h1></header><p><small>December 6, 2025&nbsp;Â· &nbsp;Â·</small><p><div class=blog-toc><nav id=TableOfContents><ul><li><a href=#5-layer-fog>5-Layer-Fog</a></li><li><a href=#regex-beast>Regex Beast</a></li><li><a href=#berkeley>Berkeley</a></li><li><a href=#vanyousee>VanYouSee</a></li></ul><ul><li><a href=#scan4flag>Scan4fLaG</a></li></ul><ul><li><a href=#easyvm>EasyVm</a></li></ul></nav></div><section class=blog-content><h1 id=2025hitctf>2025HITCTF</h1><h1 id=misc>Misc</h1><h2 id=5-layer-fog>5-Layer-Fog</h2><ol><li><p>æ‰“å¼€ <code>flag_cert.pem</code>ï¼Œè¿™æ˜¯ä¸€ä¸ª X.509 è¯ä¹¦ï¼Œsubject/issuer é‡Œå†™ç€ï¼š<br>â€‹<code>algorithms: Xor+Base64, Rot13, BasE64, CaEsAr(3), SwApCaSe</code>â€‹</p></li><li><p>ç”¨åº“ï¼ˆå¦‚ <code>cryptography</code>ï¼‰è§£æè¯ä¹¦ï¼Œå‘ç°æœ‰ä¸€ä¸ªè‡ªå®šä¹‰æ‰©å±• OID <code>1.2.3.4.5.6.7.8.1</code>ï¼Œå†…å®¹æ˜¯ä¸€ä¸² Base64ï¼š<br>â€‹<code>uMkIvhvNuWSdaWu5tXW0qNAotWoeaXyCvMT5egIvqjqbSqEEy3ylSW4wUhgASqo3unywvrEmUhcYSNu4tnv5rrAlvZEhwqALtjAIUg==</code>â€‹</p></li><li><p>å¯¹è¿™ä¸²å¯†æ–‡æŒ‰æç¤ºåšâ€œé€†æ“ä½œâ€ï¼š</p><ul><li>å…ˆ <code>swapcase</code>ï¼ˆå¤§å°å†™äº’æ¢ï¼‰</li><li>å† Caesar -3ï¼ˆè¿˜åŸ CaEsAr(3)ï¼‰</li><li>å† <code>rot13</code>â€‹</li><li>ç„¶å Base64 è§£ç </li><li>å¾—åˆ°ä¸€æ®µäºŒè¿›åˆ¶æ•°æ®ï¼Œå¯¹å®ƒåšå•å­—èŠ‚ XOR çˆ†ç ´ï¼Œkey = <code>0x40</code>ï¼ˆå³å­—ç¬¦ <code>'@'</code>ï¼‰æ—¶å¾—åˆ°æ–°çš„ Base64 ä¸²ï¼š<br>â€‹<code>SElUQ1RGMjAyNXtCYXNFNjRfWG9yKEApK0Jhc2U2NF9Td0FwQ2FTZV9Sb3QxM19DYUVzQXIoMyl9</code>â€‹</li><li>æœ€åå† Base64 è§£ç ï¼Œå³ä¸ºä¸Šé¢çš„ flagã€‚</li></ul></li></ol><p>gptç§’äº†</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>https://chatgpt.com/share/6933cf1b-d090-800f-969a-6d83684b747d
</span></span></code></pre></td></tr></table></div></div><h2 id=regex-beast>Regex Beast</h2><p>â€</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Increase recursion limit just in case</span>
</span></span><span class=line><span class=cl><span class=n>sys</span><span class=o>.</span><span class=n>setrecursionlimit</span><span class=p>(</span><span class=mi>2000000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Reading file...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;/Users/joker/Code/2025HITCTF/enc.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>content</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>FileNotFoundError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;File not found.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>content</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>content</span> <span class=o>=</span> <span class=n>content</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Simple check for trailing characters</span>
</span></span><span class=line><span class=cl>    <span class=c1># The file ends with ...)) so we might want to trim until the last )</span>
</span></span><span class=line><span class=cl>    <span class=c1># But usually strip() is enough if there are no flags</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Extracting blocks...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>block_map</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=n>reverse_map</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=n>next_id</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>replace_callback</span><span class=p>(</span><span class=k>match</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>nonlocal</span> <span class=n>next_id</span>
</span></span><span class=line><span class=cl>        <span class=n>b</span> <span class=o>=</span> <span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>b</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>block_map</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>block_map</span><span class=p>[</span><span class=n>b</span><span class=p>]</span> <span class=o>=</span> <span class=n>next_id</span>
</span></span><span class=line><span class=cl>            <span class=n>reverse_map</span><span class=p>[</span><span class=n>next_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>            <span class=n>next_id</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;B</span><span class=si>{</span><span class=n>block_map</span><span class=p>[</span><span class=n>b</span><span class=p>]</span><span class=si>}</span><span class=s1> &#39;</span> 
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=n>content_sub</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;(?:</span><span class=se>\\</span><span class=s1>x[0-9a-f]</span><span class=si>{2}</span><span class=s1>)+&#39;</span><span class=p>,</span> <span class=n>replace_callback</span><span class=p>,</span> <span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Unique blocks: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>block_map</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Tokenize</span>
</span></span><span class=line><span class=cl>    <span class=c1># Add spaces around special chars to split easily</span>
</span></span><span class=line><span class=cl>    <span class=n>tokens_str</span> <span class=o>=</span> <span class=n>content_sub</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;(?:&#39;</span><span class=p>,</span> <span class=s1>&#39; ( &#39;</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;(?=&#39;</span><span class=p>,</span> <span class=s1>&#39; [ &#39;</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;)&#39;</span><span class=p>,</span> <span class=s1>&#39; ) &#39;</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;|&#39;</span><span class=p>,</span> <span class=s1>&#39; | &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>tokens</span> <span class=o>=</span> <span class=n>tokens_str</span><span class=o>.</span><span class=n>split</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Total tokens: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>tokens</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>stack</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=c1># Root frame</span>
</span></span><span class=line><span class=cl>    <span class=c1># A frame represents the current Group or Lookahead being parsed.</span>
</span></span><span class=line><span class=cl>    <span class=c1># alts: list of Alternatives.</span>
</span></span><span class=line><span class=cl>    <span class=c1># Alternative: list of Terms.</span>
</span></span><span class=line><span class=cl>    <span class=c1># Term: (SetOfPaths, is_lookahead)</span>
</span></span><span class=line><span class=cl>    <span class=n>stack</span><span class=o>.</span><span class=n>append</span><span class=p>({</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;ROOT&#39;</span><span class=p>,</span> <span class=s1>&#39;alts&#39;</span><span class=p>:</span> <span class=p>[</span> <span class=p>[]</span> <span class=p>]</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>make_block_set</span><span class=p>(</span><span class=n>bid</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span> <span class=p>(</span><span class=n>bid</span><span class=p>,)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>union_sets</span><span class=p>(</span><span class=n>sets</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>sets</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>res</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>res</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>concat_sets</span><span class=p>(</span><span class=n>list_of_sets</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>list_of_sets</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{()}</span> 
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># If any set is empty, result is empty (invalid path)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>list_of_sets</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>s</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nb>set</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>=</span> <span class=n>list_of_sets</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>list_of_sets</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>            <span class=n>next_s</span> <span class=o>=</span> <span class=n>list_of_sets</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>new_res</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=c1># If sets are large, this cross product is expensive.</span>
</span></span><span class=line><span class=cl>            <span class=c1># But we expect singletons.</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>res</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>100</span> <span class=ow>or</span> <span class=nb>len</span><span class=p>(</span><span class=n>next_s</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>100</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                 <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Warning: Large sets in concat: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>res</span><span class=p>)</span><span class=si>}</span><span class=s2> * </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>next_s</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>p1</span> <span class=ow>in</span> <span class=n>res</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>p2</span> <span class=ow>in</span> <span class=n>next_s</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>new_res</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>p1</span> <span class=o>+</span> <span class=n>p2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>res</span> <span class=o>=</span> <span class=n>new_res</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>res</span><span class=p>:</span> <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>res</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>intersect_sets</span><span class=p>(</span><span class=n>s1</span><span class=p>,</span> <span class=n>s2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>s1</span><span class=o>.</span><span class=n>intersection</span><span class=p>(</span><span class=n>s2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>tok</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>tokens</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>i</span> <span class=o>%</span> <span class=mi>50000</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Processing token </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>tokens</span><span class=p>)</span><span class=si>}</span><span class=s2> stack depth </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>stack</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>tok</span> <span class=o>==</span> <span class=s1>&#39;(&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>stack</span><span class=o>.</span><span class=n>append</span><span class=p>({</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;GROUP&#39;</span><span class=p>,</span> <span class=s1>&#39;alts&#39;</span><span class=p>:</span> <span class=p>[</span> <span class=p>[]</span> <span class=p>]</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>tok</span> <span class=o>==</span> <span class=s1>&#39;[&#39;</span><span class=p>:</span> <span class=c1># Lookahead</span>
</span></span><span class=line><span class=cl>            <span class=n>stack</span><span class=o>.</span><span class=n>append</span><span class=p>({</span> <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;LOOKAHEAD&#39;</span><span class=p>,</span> <span class=s1>&#39;alts&#39;</span><span class=p>:</span> <span class=p>[</span> <span class=p>[]</span> <span class=p>]</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>tok</span> <span class=o>==</span> <span class=s1>&#39;|&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>stack</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=s1>&#39;alts&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>([])</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>tok</span> <span class=o>==</span> <span class=s1>&#39;)&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>frame</span> <span class=o>=</span> <span class=n>stack</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Evaluate alternatives</span>
</span></span><span class=line><span class=cl>            <span class=n>alt_results</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>alt</span> <span class=ow>in</span> <span class=n>frame</span><span class=p>[</span><span class=s1>&#39;alts&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=c1># alt is list of (Set, is_lookahead)</span>
</span></span><span class=line><span class=cl>                <span class=c1># Concatenate them</span>
</span></span><span class=line><span class=cl>                <span class=c1># If we have [ (A, True), (B, False) ] -&gt; A \cap B</span>
</span></span><span class=line><span class=cl>                <span class=c1># If we have [ (A, False), (B, True) ] -&gt; A + B (and B is asserted)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># Wait, my logic in the loop below handles the merge of (Lookahead, Next).</span>
</span></span><span class=line><span class=cl>                <span class=c1># So `alt` here already contains merged terms?</span>
</span></span><span class=line><span class=cl>                <span class=c1># No, `alt` contains the terms accumulated in this frame.</span>
</span></span><span class=line><span class=cl>                <span class=c1># But inside the loop (elif tok == &#39;B&#39; or tok == &#39;)&#39;) we merge into parent.</span>
</span></span><span class=line><span class=cl>                <span class=c1># Here we are processing the CLOSED frame.</span>
</span></span><span class=line><span class=cl>                <span class=c1># We need to evaluate the content OF THE FRAME.</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># Inside the frame, we also had terms.</span>
</span></span><span class=line><span class=cl>                <span class=c1># The terms inside the frame were already merged?</span>
</span></span><span class=line><span class=cl>                <span class=c1># No. `stack[-1]` refers to the frame we are building.</span>
</span></span><span class=line><span class=cl>                <span class=c1># When we are IN the frame, we append terms to IT.</span>
</span></span><span class=line><span class=cl>                <span class=c1># So `frame[&#39;alts&#39;]` contains the terms.</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># We need to process the terms in the alternative.</span>
</span></span><span class=line><span class=cl>                <span class=c1># The logic `if current_alt and current_alt[-1][1]: merge` </span>
</span></span><span class=line><span class=cl>                <span class=c1># was applied when ADDING to the frame.</span>
</span></span><span class=line><span class=cl>                <span class=c1># So `alt` list is already &#34;Lookaheads merged into following consumers&#34;.</span>
</span></span><span class=line><span class=cl>                <span class=c1># EXCEPT for trailing lookaheads.</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=n>sets_to_concat</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>alt</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>val</span> <span class=o>=</span> <span class=n>concat_sets</span><span class=p>(</span><span class=n>sets_to_concat</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>alt_results</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>frame_res</span> <span class=o>=</span> <span class=n>union_sets</span><span class=p>(</span><span class=n>alt_results</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>is_lookahead</span> <span class=o>=</span> <span class=p>(</span><span class=n>frame</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;LOOKAHEAD&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>stack</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># Should not happen if balanced</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=n>parent</span> <span class=o>=</span> <span class=n>stack</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>current_alt</span> <span class=o>=</span> <span class=n>parent</span><span class=p>[</span><span class=s1>&#39;alts&#39;</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Merge into parent</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>is_lookahead</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>current_alt</span><span class=o>.</span><span class=n>append</span><span class=p>(</span> <span class=p>(</span><span class=n>frame_res</span><span class=p>,</span> <span class=kc>True</span><span class=p>)</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>current_alt</span> <span class=ow>and</span> <span class=n>current_alt</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                    <span class=n>prev_set</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>current_alt</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                    <span class=n>inter</span> <span class=o>=</span> <span class=n>intersect_sets</span><span class=p>(</span><span class=n>prev_set</span><span class=p>,</span> <span class=n>frame_res</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>current_alt</span><span class=o>.</span><span class=n>append</span><span class=p>(</span> <span class=p>(</span><span class=n>inter</span><span class=p>,</span> <span class=kc>False</span><span class=p>)</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>current_alt</span><span class=o>.</span><span class=n>append</span><span class=p>(</span> <span class=p>(</span><span class=n>frame_res</span><span class=p>,</span> <span class=kc>False</span><span class=p>)</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>tok</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;B&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>bid</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>tok</span><span class=p>[</span><span class=mi>1</span><span class=p>:])</span>
</span></span><span class=line><span class=cl>            <span class=n>s</span> <span class=o>=</span> <span class=n>make_block_set</span><span class=p>(</span><span class=n>bid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>parent</span> <span class=o>=</span> <span class=n>stack</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>current_alt</span> <span class=o>=</span> <span class=n>parent</span><span class=p>[</span><span class=s1>&#39;alts&#39;</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>current_alt</span> <span class=ow>and</span> <span class=n>current_alt</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                 <span class=n>prev_set</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>current_alt</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                 <span class=n>inter</span> <span class=o>=</span> <span class=n>intersect_sets</span><span class=p>(</span><span class=n>prev_set</span><span class=p>,</span> <span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=n>current_alt</span><span class=o>.</span><span class=n>append</span><span class=p>(</span> <span class=p>(</span><span class=n>inter</span><span class=p>,</span> <span class=kc>False</span><span class=p>)</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                 <span class=n>current_alt</span><span class=o>.</span><span class=n>append</span><span class=p>(</span> <span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=kc>False</span><span class=p>)</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>                 
</span></span><span class=line><span class=cl>    <span class=c1># Final result</span>
</span></span><span class=line><span class=cl>    <span class=n>root_frame</span> <span class=o>=</span> <span class=n>stack</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>final_sets</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>alt</span> <span class=ow>in</span> <span class=n>root_frame</span><span class=p>[</span><span class=s1>&#39;alts&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>sets_to_concat</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>alt</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>final_sets</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>concat_sets</span><span class=p>(</span><span class=n>sets_to_concat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=n>final_res</span> <span class=o>=</span> <span class=n>union_sets</span><span class=p>(</span><span class=n>final_sets</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Found </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>final_res</span><span class=p>)</span><span class=si>}</span><span class=s2> valid paths.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>final_res</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>path</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>final_res</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>decoded</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>bid</span> <span class=ow>in</span> <span class=n>path</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>hex_str</span> <span class=o>=</span> <span class=n>reverse_map</span><span class=p>[</span><span class=n>bid</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>parts</span> <span class=o>=</span> <span class=n>hex_str</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;\x&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>parts</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>p</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>decoded</span> <span class=o>+=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;decoded_flag.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>decoded</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Decoded flag written to decoded_flag.txt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># Check if it&#39;s a zip or text</span>
</span></span><span class=line><span class=cl>        <span class=c1># print head</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;First 100 bytes:&#34;</span><span class=p>,</span> <span class=n>decoded</span><span class=p>[:</span><span class=mi>100</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>solve</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>analyze</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;/Users/joker/Code/2025HITCTF/enc.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>content</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Find all hex blocks</span>
</span></span><span class=line><span class=cl>    <span class=c1># A block seems to be a sequence of \xNN</span>
</span></span><span class=line><span class=cl>    <span class=c1># Let&#39;s assume they are reasonably long to avoid matching short things if any</span>
</span></span><span class=line><span class=cl>    <span class=c1># The snippet shows long blocks.</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># We&#39;ll regex replace them.</span>
</span></span><span class=line><span class=cl>    <span class=n>block_pattern</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;(?:</span><span class=se>\\</span><span class=s1>x[0-9a-f]</span><span class=si>{2}</span><span class=s1>)+&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>unique_blocks</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=n>next_id</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>replace_func</span><span class=p>(</span><span class=k>match</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>nonlocal</span> <span class=n>next_id</span>
</span></span><span class=line><span class=cl>        <span class=n>block</span> <span class=o>=</span> <span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>block</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>unique_blocks</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>unique_blocks</span><span class=p>[</span><span class=n>block</span><span class=p>]</span> <span class=o>=</span> <span class=n>next_id</span>
</span></span><span class=line><span class=cl>            <span class=n>next_id</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;BLOCK_</span><span class=si>{</span><span class=n>unique_blocks</span><span class=p>[</span><span class=n>block</span><span class=p>]</span><span class=si>}</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>simplified</span> <span class=o>=</span> <span class=n>block_pattern</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=n>replace_func</span><span class=p>,</span> <span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Found </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>unique_blocks</span><span class=p>)</span><span class=si>}</span><span class=s2> unique blocks.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Simplified structure (first 500 chars):&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>simplified</span><span class=p>[:</span><span class=mi>500</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Let&#39;s also print the simplified structure around the middle to see if it changes</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Simplified structure (middle):&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>mid</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>simplified</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>simplified</span><span class=p>[</span><span class=n>mid</span><span class=p>:</span><span class=n>mid</span><span class=o>+</span><span class=mi>500</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>analyze</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åæ‰«ç å³å¯</p><p><img src=assets/image-20251206150727-vm7zyp5.png alt=image></p><p>traeç§’äº†</p><h2 id=berkeley>Berkeley</h2><p>ä½¿ç”¨elf freebsdçš„æ–‡ä»¶å¤´ï¼Œè¿›è¡Œæ˜æ–‡æ”»å‡»</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> -n <span class=s2>&#34;7f454c4602010109000000000000000004003e00010000000000000000000000&#34;</span> <span class=p>|</span> xxd -r -ps &gt; freebsd_header1
</span></span></code></pre></td></tr></table></div></div><p>è¿™é‡Œçš„æ–‡ä»¶å¤´æ˜¯æŸ¥è¯¢äº†Berkeleyè”æƒ³åˆ°freebsdç³»ç»Ÿï¼Œå› æ­¤éƒ¨åˆ†å­—èŠ‚éœ€è¦ä¸€è‡´</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bkcrack.exe -C strong_encrypted.zip -c veracrypt.core -p freebsd_header1 -o <span class=m>0</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=assets/network-asset-asynccode-20251209221116-z3c5b95.png alt></p><p>æå–å‡ºæ¥äº†1å’Œcoreæ–‡ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bkcrack -C strong_encrypted.zip -c veracrypt.core -k 25b0091d 6687a00d 791e474d -d veracrypt.core
</span></span><span class=line><span class=cl>bkcrack -C strong_encrypted.zip -c veracrypt.core -k 25b0091d 6687a00d 791e474d -d <span class=m>1</span>
</span></span></code></pre></td></tr></table></div></div><p>åœ¨coreæ–‡ä»¶å†…æŸ¥æ‰¾åˆ°å¯†ç </p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>strings veracrypt.core <span class=p>|</span> grep -i <span class=s2>&#34;password&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=assets/network-asset-asynccode-20251209221117-ulfdiyo.png alt></p><p>ç„¶åçœ‹åˆ°è¿™ä¸ªSecurePassword12</p><p>ç„¶åæŒ‚è½½</p><p><img src=assets/network-asset-asynccode-20251209221117-3bmttxl.png alt></p><p>ä½¿ç”¨rstudioå°±å¯ä»¥æ‰«ææ¢å¤æ–‡ä»¶ï¼Œåœ¨.snapä¸‹æ‰¾åˆ°2ï¼Œç‚¹è¿›å»å°±æ˜¯flag</p><p><img src=assets/network-asset-asynccode-20251209221117-0m53ddg.png alt></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>flag<span class=o>{</span>Fr33BSD_part1t10n_taB1e_Is_StraNg3<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=vanyousee>VanYouSee</h2><p>ğŸ¤¡ä¿®äº†ä¸€ä¸ªæ™šä¸Š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>https://pan.baidu.com/s/1Tzad98GtbeuLs5RS0V_wuw?pwd<span class=o>=</span>avev
</span></span></code></pre></td></tr></table></div></div><h1 id=crypto>Crypto</h1><h2 id=scan4flag>Scan4fLaG</h2><p><img src=assets/image-20251209221319-c54z0c2.png alt=image></p><p>æ‰«ç å¾—</p><p><img src=assets/image-20251209221519-rcj9twr.png alt=image></p><p>PSï¼šè¢«å¯†ç æ‰‹çŒœå‡ºæ¥çš„ï¼Œéƒéƒäº†ğŸ¤¡</p><p>åˆ†ç¦»å‹ç¼©åŒ…ï¼Œç”¨ä¸Šé¢çš„å¯†ç è§£å¯†</p><p><img src=assets/image-20251209221616-ss3ggts.png alt=image></p><h1 id=reverse>Reverse</h1><h2 id=easyvm>EasyVm</h2><p>ä¸ƒé“reï¼Œæˆ‘ä»¬ä¸€ä¸ªreæ‰‹ä¸å ªé‡ä»»ï¼Œå¸®å¿™åšäº†ä¸€é¢˜easyçš„ï¼ŒAIå¤ªå¥½ç”¨äº†</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span><span class=lnt>234
</span><span class=lnt>235
</span><span class=lnt>236
</span><span class=lnt>237
</span><span class=lnt>238
</span><span class=lnt>239
</span><span class=lnt>240
</span><span class=lnt>241
</span><span class=lnt>242
</span><span class=lnt>243
</span><span class=lnt>244
</span><span class=lnt>245
</span><span class=lnt>246
</span><span class=lnt>247
</span><span class=lnt>248
</span><span class=lnt>249
</span><span class=lnt>250
</span><span class=lnt>251
</span><span class=lnt>252
</span><span class=lnt>253
</span><span class=lnt>254
</span><span class=lnt>255
</span><span class=lnt>256
</span><span class=lnt>257
</span><span class=lnt>258
</span><span class=lnt>259
</span><span class=lnt>260
</span><span class=lnt>261
</span><span class=lnt>262
</span><span class=lnt>263
</span><span class=lnt>264
</span><span class=lnt>265
</span><span class=lnt>266
</span><span class=lnt>267
</span><span class=lnt>268
</span><span class=lnt>269
</span><span class=lnt>270
</span><span class=lnt>271
</span><span class=lnt>272
</span><span class=lnt>273
</span><span class=lnt>274
</span><span class=lnt>275
</span><span class=lnt>276
</span><span class=lnt>277
</span><span class=lnt>278
</span><span class=lnt>279
</span><span class=lnt>280
</span><span class=lnt>281
</span><span class=lnt>282
</span><span class=lnt>283
</span><span class=lnt>284
</span><span class=lnt>285
</span><span class=lnt>286
</span><span class=lnt>287
</span><span class=lnt>288
</span><span class=lnt>289
</span><span class=lnt>290
</span><span class=lnt>291
</span><span class=lnt>292
</span><span class=lnt>293
</span><span class=lnt>294
</span><span class=lnt>295
</span><span class=lnt>296
</span><span class=lnt>297
</span><span class=lnt>298
</span><span class=lnt>299
</span><span class=lnt>300
</span><span class=lnt>301
</span><span class=lnt>302
</span><span class=lnt>303
</span><span class=lnt>304
</span><span class=lnt>305
</span><span class=lnt>306
</span><span class=lnt>307
</span><span class=lnt>308
</span><span class=lnt>309
</span><span class=lnt>310
</span><span class=lnt>311
</span><span class=lnt>312
</span><span class=lnt>313
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl><span class=c1># -*- coding: utf-8 -*-</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>é€†å‘è‡ª Calendar.dll ä¸­çš„è‡ªå®šä¹‰ VMï¼Œæ¢å¤ FLAG çš„è„šæœ¬ã€‚
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>æ€è·¯ç®€è¿°ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>1. æŠŠ .rdata é‡Œçš„å­—èŠ‚ç æŠ„å‡ºæ¥ï¼ˆ0x14001DA90 é‚£ä¸€æ®µï¼‰ã€‚
</span></span></span><span class=line><span class=cl><span class=s2>2. æŒ‰ç…§ sub_140001270 çš„é€»è¾‘å†™ä¸€ä¸ª Python ç‰ˆ VM è§£é‡Šå™¨ã€‚
</span></span></span><span class=line><span class=cl><span class=s2>3. æ ¹æ®é€†å‘åˆ†æå¾—åˆ°çš„ç­‰å¼ï¼ˆå…¨æ˜¯ + / - / ^ / == è¿™ç§ï¼‰ï¼Œåœ¨ Python é‡Œ
</span></span></span><span class=line><span class=cl><span class=s2>   æŠŠå„ä¸ªå­—ç¬¦ç®—å‡ºæ¥ï¼Œç»„è£…å‡º flagï¼Œå¹¶ç”¨ VM çœŸå®è·‘ä¸€éæ ¡éªŒã€‚
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ----------------------------</span>
</span></span><span class=line><span class=cl><span class=c1># 1. è¿˜åŸå‡ºæ¥çš„ VM å­—èŠ‚ç </span>
</span></span><span class=line><span class=cl><span class=c1># ----------------------------</span>
</span></span><span class=line><span class=cl><span class=n>CODE</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>([</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x0D</span><span class=p>,</span><span class=mh>0x3C</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x06</span><span class=p>,</span><span class=mh>0x0A</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x6F</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x57</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x05</span><span class=p>,</span><span class=mh>0x21</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x6E</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x72</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x04</span><span class=p>,</span><span class=mh>0x67</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x07</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x11</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x04</span><span class=p>,</span><span class=mh>0x65</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x05</span><span class=p>,</span><span class=mh>0x63</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x09</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x6F</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span><span class=mh>0x72</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x07</span><span class=p>,</span><span class=mh>0x21</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x72</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x08</span><span class=p>,</span><span class=mh>0x0A</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x43</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x06</span><span class=p>,</span><span class=mh>0x74</span><span class=p>,</span><span class=mh>0x11</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x10</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x0C</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x66</span><span class=p>,</span><span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x06</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x0C</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x6D</span><span class=p>,</span><span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span><span class=mh>0x04</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x09</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x00</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x0C</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x06</span><span class=p>,</span><span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x09</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span><span class=mh>0x0C</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x1C</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x09</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span><span class=mh>0x0C</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x1A</span><span class=p>,</span><span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x05</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x02</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x06</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span><span class=mh>0x07</span><span class=p>,</span><span class=mh>0x0C</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x69</span><span class=p>,</span><span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x09</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x02</span><span class=p>,</span><span class=mh>0x0C</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x21</span><span class=p>,</span><span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span><span class=mh>0x09</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x0C</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x3D</span><span class=p>,</span><span class=mh>0x0E</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x02</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x04</span><span class=p>,</span><span class=mh>0x08</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x05</span><span class=p>,</span><span class=mh>0x09</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x06</span><span class=p>,</span><span class=mh>0x0A</span><span class=p>,</span><span class=mh>0x0B</span><span class=p>,</span><span class=mh>0x05</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span><span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x00</span><span class=p>,</span><span class=mh>0x04</span><span class=p>,</span><span class=mh>0x09</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x05</span><span class=p>,</span><span class=mh>0x0C</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x17</span><span class=p>,</span><span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x06</span><span class=p>,</span><span class=mh>0x09</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x05</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x0C</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x12</span><span class=p>,</span><span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x0B</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x0C</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span><span class=mh>0x0D</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x04</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x05</span><span class=p>,</span><span class=mh>0x0F</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x06</span><span class=p>,</span><span class=mh>0x10</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x07</span><span class=p>,</span><span class=mh>0x11</span><span class=p>,</span><span class=mh>0x0B</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x04</span><span class=p>,</span><span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x03</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x00</span><span class=p>,</span><span class=mh>0x01</span><span class=p>,</span><span class=mh>0x05</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x0C</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0xBE</span><span class=p>,</span><span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x09</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x0B</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x07</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x05</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x0C</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x32</span><span class=p>,</span><span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x08</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x0C</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x30</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x06</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x05</span><span class=p>,</span><span class=mh>0x0B</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x05</span><span class=p>,</span><span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0x04</span><span class=p>,</span><span class=mh>0x07</span><span class=p>,</span><span class=mh>0x06</span><span class=p>,</span><span class=mh>0x00</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x0C</span><span class=p>,</span><span class=mh>0x06</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x0E</span><span class=p>,</span><span class=mh>0x02</span><span class=p>,</span><span class=mh>0x0D</span><span class=p>,</span><span class=mh>0x1C</span><span class=p>,</span><span class=mh>0x00</span>
</span></span><span class=line><span class=cl><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ“ä½œç åˆ°åå­—ï¼Œä»…ç”¨äºè°ƒè¯•ï¼ˆè„šæœ¬çœŸæ­£æ‰§è¡Œä¸ä¾èµ–è¿™ä¸ªï¼‰</span>
</span></span><span class=line><span class=cl><span class=n>OPMAP</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=mi>0</span><span class=p>:</span> <span class=s2>&#34;HALT&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>1</span><span class=p>:</span> <span class=s2>&#34;STORE&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>2</span><span class=p>:</span> <span class=s2>&#34;LDMEM&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>3</span><span class=p>:</span> <span class=s2>&#34;MOV&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>4</span><span class=p>:</span> <span class=s2>&#34;LDI&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>5</span><span class=p>:</span> <span class=s2>&#34;ADD&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>6</span><span class=p>:</span> <span class=s2>&#34;ADD_I&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>7</span><span class=p>:</span> <span class=s2>&#34;SUB&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>8</span><span class=p>:</span> <span class=s2>&#34;SUB_I&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>9</span><span class=p>:</span> <span class=s2>&#34;XOR&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>10</span><span class=p>:</span> <span class=s2>&#34;XOR_I&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>11</span><span class=p>:</span> <span class=s2>&#34;CMP&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>12</span><span class=p>:</span> <span class=s2>&#34;CMP_I&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>13</span><span class=p>:</span> <span class=s2>&#34;JMP&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>14</span><span class=p>:</span> <span class=s2>&#34;JNZ&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>16</span><span class=p>:</span> <span class=s2>&#34;IN&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>17</span><span class=p>:</span> <span class=s2>&#34;OUT&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------</span>
</span></span><span class=line><span class=cl><span class=c1># 2. Python ç‰ˆ VM è§£é‡Šå™¨ï¼šä»¿ sub_140001270 çš„æ ¸å¿ƒé€»è¾‘</span>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>vm_run</span><span class=p>(</span><span class=n>flag_bytes</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>,</span> <span class=n>debug</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    ç”¨ Python è·‘ä¸€é VM é€»è¾‘ï¼Œåˆ¤æ–­ç»™å®šè¾“å…¥æ˜¯å¦èµ°åˆ°â€œæ­£ç¡®â€åˆ†æ”¯ã€‚
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    flag_bytesï¼šæˆ‘ä»¬è¦ä¼ ç»™ VM çš„â€œè¾“å…¥å­—ç¬¦ä¸²â€ï¼ˆä¸å« </span><span class=se>\n</span><span class=s2>ï¼‰ï¼Œ
</span></span></span><span class=line><span class=cl><span class=s2>                VM è¯»ä¸åˆ°çš„ä½ç½®æŒ‰ 0 å¤„ç†ã€‚
</span></span></span><span class=line><span class=cl><span class=s2>    è¿”å›å€¼ï¼šTrue è¡¨ç¤ºé€šè¿‡æ‰€æœ‰æ ¡éªŒï¼Œèµ°åˆ°äº†æˆåŠŸåˆ†æ”¯ï¼›False è¡¨ç¤ºèµ°é”™åˆ†æ”¯ã€‚
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>code</span> <span class=o>=</span> <span class=n>CODE</span>
</span></span><span class=line><span class=cl>    <span class=n>regs</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>8</span>           <span class=c1># 8 ä¸ªé€šç”¨å¯„å­˜å™¨ r0..r7ï¼Œæ¯ä¸ª 32 bit</span>
</span></span><span class=line><span class=cl>    <span class=n>zf</span> <span class=o>=</span> <span class=mi>0</span>                   <span class=c1># åªæ¨¡æ‹Ÿ Zero Flagï¼ˆZFï¼‰ï¼Œå¯¹åº” a1+1064 çš„æœ€ä½ä½</span>
</span></span><span class=line><span class=cl>    <span class=n>ip</span> <span class=o>=</span> <span class=mi>0</span>                   <span class=c1># instruction pointerï¼Œä» 0 å¼€å§‹</span>
</span></span><span class=line><span class=cl>    <span class=n>steps</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># å®é™… VM é‡Œï¼šè¾“å…¥ä» a1+1084 å¼€å§‹ï¼Œæˆ‘ä»¬è¿™é‡Œç›´æ¥ç”¨ flag_bytes æ•°ç»„ä»£æ›¿</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>read_input</span><span class=p>(</span><span class=n>idx</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>flag_bytes</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span> <span class=k>if</span> <span class=n>idx</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>flag_bytes</span><span class=p>)</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>ip</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>code</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>steps</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>steps</span> <span class=o>&gt;</span> <span class=mi>20000</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># ç†è®ºä¸Šä¸ä¼šæ­»å¾ªç¯ï¼Œè¿™é‡ŒåŠ ä¸ªä¿é™©</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span><span class=s2>&#34;VM å¯èƒ½é™·å…¥æ­»å¾ªç¯ï¼Œç»ˆæ­¢è°ƒè¯•&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>op</span> <span class=o>=</span> <span class=n>code</span><span class=p>[</span><span class=n>ip</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>debug</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;IP=</span><span class=si>{</span><span class=n>ip</span><span class=si>:</span><span class=s2>03d</span><span class=si>}</span><span class=s2> OP=</span><span class=si>{</span><span class=n>op</span><span class=si>:</span><span class=s2>02X</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>OPMAP</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=s1>&#39;?&#39;</span><span class=p>)</span><span class=si>:</span><span class=s2>&lt;5</span><span class=si>}</span><span class=s2> regs=</span><span class=si>{</span><span class=n>regs</span><span class=si>}</span><span class=s2> ZF=</span><span class=si>{</span><span class=n>zf</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># ------- æ— å‚æ•°æŒ‡ä»¤ -------</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>  <span class=c1># HALT</span>
</span></span><span class=line><span class=cl>            <span class=c1># é¢˜ç›®é‡Œæœ‰ä¸¤ä¸ª HALTï¼š</span>
</span></span><span class=line><span class=cl>            <span class=c1>#  - é”™è¯¯åˆ†æ”¯æ˜¯å‰é¢æ„é€  &#34;Wrong...&#34; åçš„ HALTï¼ˆåœ¨ ip=27ï¼‰</span>
</span></span><span class=line><span class=cl>            <span class=c1>#  - æ­£ç¡®åˆ†æ”¯åœ¨æœ€åæ„é€  &#34;Correct!&#34; å HALTï¼ˆåœ¨ ip=279ï¼‰</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>ip</span> <span class=o>!=</span> <span class=mi>27</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>16</span><span class=p>:</span>  <span class=c1># INï¼šçœŸå®ç¨‹åºé‡Œ fgets è¯»å…¥ï¼Œæˆ‘ä»¬åœ¨è„šæœ¬ä¸­ç›´æ¥å¿½ç•¥</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>17</span><span class=p>:</span>  <span class=c1># OUTï¼šçœŸå®ç¨‹åºæŠŠ a1+1134 çš„å­—ç¬¦ä¸²è¾“å‡ºï¼Œè¿™é‡Œä¹Ÿç›´æ¥è·³è¿‡</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># ------- å•å­—èŠ‚å‚æ•°ï¼ˆè·³è½¬ï¼‰ -------</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>13</span><span class=p>:</span>  <span class=c1># JMP imm8</span>
</span></span><span class=line><span class=cl>            <span class=n>target</span> <span class=o>=</span> <span class=n>code</span><span class=p>[</span><span class=n>ip</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span> <span class=o>=</span> <span class=n>target</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>14</span><span class=p>:</span>  <span class=c1># JNZ imm8 ï¼šå¦‚æœ ZF == 0 å°±è·³è½¬</span>
</span></span><span class=line><span class=cl>            <span class=n>target</span> <span class=o>=</span> <span class=n>code</span><span class=p>[</span><span class=n>ip</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>zf</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>ip</span> <span class=o>=</span> <span class=n>target</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>ip</span> <span class=o>+=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># ------- åŒå­—èŠ‚å‚æ•°çš„ç®—æœ¯ / è®¿å­˜ / mov / cmp -------</span>
</span></span><span class=line><span class=cl>        <span class=c1># ä¸‹é¢æ‰€æœ‰åˆ†æ”¯éƒ½ä¼šè¯»ä¸¤ä¸ªç´§è·Ÿçš„å­—èŠ‚ä½œä¸ºå‚æ•°</span>
</span></span><span class=line><span class=cl>        <span class=c1># å½¢å¼ç»Ÿä¸€ï¼š [op, a, b]</span>
</span></span><span class=line><span class=cl>        <span class=c1># --------------------------------------------</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>ip</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>&gt;=</span> <span class=nb>len</span><span class=p>(</span><span class=n>code</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=c1># é˜²å¾¡æ€§æ£€æŸ¥</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span><span class=s2>&#34;å­—èŠ‚ç éæ³•ï¼Œè¯»å–è¶Šç•Œ&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>a</span> <span class=o>=</span> <span class=n>code</span><span class=p>[</span><span class=n>ip</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>b</span> <span class=o>=</span> <span class=n>code</span><span class=p>[</span><span class=n>ip</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># è¯´æ˜ï¼šåŸ VM å¯¹å¯„å­˜å™¨ç¼–å· &gt;=8 ä¼šè¿”å›é”™è¯¯ï¼Œè¿™ä¸ªå­—èŠ‚ç é‡Œéƒ½åœ¨ 0..7 èŒƒå›´</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>  <span class=c1># STOREï¼›åªå½±å“ VM å†…éƒ¨çš„è¾“å‡ºç¼“å†²ï¼Œå¯¹é€»è¾‘æ— å½±å“ï¼Œè¿™é‡Œå¿½ç•¥</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>  <span class=c1># LDMEM r, idx   -&gt; ä»è¾“å…¥ç¼“å†² flag[idx] è¯»å…¥å¯„å­˜å™¨</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span> <span class=n>idx</span> <span class=o>=</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>            <span class=n>regs</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>=</span> <span class=n>read_input</span><span class=p>(</span><span class=n>idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>3</span><span class=p>:</span>  <span class=c1># MOV rd, rs</span>
</span></span><span class=line><span class=cl>            <span class=n>rd</span><span class=p>,</span> <span class=n>rs</span> <span class=o>=</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>            <span class=n>regs</span><span class=p>[</span><span class=n>rd</span><span class=p>]</span> <span class=o>=</span> <span class=n>regs</span><span class=p>[</span><span class=n>rs</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>4</span><span class=p>:</span>  <span class=c1># LDI r, imm8</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span> <span class=n>imm</span> <span class=o>=</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>            <span class=n>regs</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>=</span> <span class=n>imm</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>5</span><span class=p>:</span>  <span class=c1># ADD rd, rs</span>
</span></span><span class=line><span class=cl>            <span class=n>rd</span><span class=p>,</span> <span class=n>rs</span> <span class=o>=</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>            <span class=n>regs</span><span class=p>[</span><span class=n>rd</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>regs</span><span class=p>[</span><span class=n>rd</span><span class=p>]</span> <span class=o>+</span> <span class=n>regs</span><span class=p>[</span><span class=n>rs</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>            <span class=n>zf</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>regs</span><span class=p>[</span><span class=n>rd</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>6</span><span class=p>:</span>  <span class=c1># ADD_I r, imm8</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span> <span class=n>imm</span> <span class=o>=</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>            <span class=n>regs</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>regs</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>+</span> <span class=n>imm</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>            <span class=n>zf</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>regs</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>7</span><span class=p>:</span>  <span class=c1># SUB rd, rs</span>
</span></span><span class=line><span class=cl>            <span class=n>rd</span><span class=p>,</span> <span class=n>rs</span> <span class=o>=</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>            <span class=n>regs</span><span class=p>[</span><span class=n>rd</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>regs</span><span class=p>[</span><span class=n>rd</span><span class=p>]</span> <span class=o>-</span> <span class=n>regs</span><span class=p>[</span><span class=n>rs</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>            <span class=n>zf</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>regs</span><span class=p>[</span><span class=n>rd</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>8</span><span class=p>:</span>  <span class=c1># SUB_I r, imm8</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span> <span class=n>imm</span> <span class=o>=</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>            <span class=n>regs</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>regs</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>-</span> <span class=n>imm</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>            <span class=n>zf</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>regs</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>9</span><span class=p>:</span>  <span class=c1># XOR rd, rs</span>
</span></span><span class=line><span class=cl>            <span class=n>rd</span><span class=p>,</span> <span class=n>rs</span> <span class=o>=</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>            <span class=n>regs</span><span class=p>[</span><span class=n>rd</span><span class=p>]</span> <span class=o>=</span> <span class=n>regs</span><span class=p>[</span><span class=n>rd</span><span class=p>]</span> <span class=o>^</span> <span class=n>regs</span><span class=p>[</span><span class=n>rs</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>zf</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>regs</span><span class=p>[</span><span class=n>rd</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>10</span><span class=p>:</span>  <span class=c1># XOR_I r, imm8</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span> <span class=n>imm</span> <span class=o>=</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>            <span class=n>regs</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>=</span> <span class=n>regs</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>^</span> <span class=n>imm</span>
</span></span><span class=line><span class=cl>            <span class=n>zf</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>regs</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>11</span><span class=p>:</span>  <span class=c1># CMP r1, r2  -&gt; è®¾ç½® ZF = (r1 - r2 == 0)</span>
</span></span><span class=line><span class=cl>            <span class=n>r1</span><span class=p>,</span> <span class=n>r2</span> <span class=o>=</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>            <span class=n>res</span> <span class=o>=</span> <span class=p>(</span><span class=n>regs</span><span class=p>[</span><span class=n>r1</span><span class=p>]</span> <span class=o>-</span> <span class=n>regs</span><span class=p>[</span><span class=n>r2</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>            <span class=n>zf</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>res</span> <span class=o>==</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>12</span><span class=p>:</span>  <span class=c1># CMP_I r, imm8 -&gt; è®¾ç½® ZF = (r - imm == 0)</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span><span class=p>,</span> <span class=n>imm</span> <span class=o>=</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>            <span class=n>res</span> <span class=o>=</span> <span class=p>(</span><span class=n>regs</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>-</span> <span class=n>imm</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>            <span class=n>zf</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>res</span> <span class=o>==</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;æœªçŸ¥æŒ‡ä»¤ op=</span><span class=si>{</span><span class=n>op</span><span class=si>}</span><span class=s2> @ ip=</span><span class=si>{</span><span class=n>ip</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># æ­£å¸¸ä¸ä¼šè·‘åˆ°è¿™é‡Œ</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------</span>
</span></span><span class=line><span class=cl><span class=c1># 3. åˆ©ç”¨é€†å‘å‡ºæ¥çš„æ–¹ç¨‹ï¼Œåœ¨ Python é‡Œè¿˜åŸ FLAG</span>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve_flag</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    æ ¹æ® VM ä¸­çš„æ¯”è¾ƒä¸è·³è½¬é€»è¾‘ï¼Œæ¢å¤æ‰€æœ‰å­—ç¬¦ã€‚
</span></span></span><span class=line><span class=cl><span class=s2>    è¿™é‡Œåªåšâ€œæ•°å­¦è§£æ–¹ç¨‹â€ï¼Œè€Œä¸æ˜¯çæšä¸¾ã€‚
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># flag[i] ä»£è¡¨ç¬¬ i ä¸ªå­—ç¬¦ï¼ˆ0-basedï¼‰</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>17</span>  <span class=c1># å®é™…ç”¨åˆ°ç´¢å¼• 0..16ï¼Œå…¶ä¸­ 17 ä½ç½®åœ¨å†…å­˜ä¸­æ˜¯ 0 ç»ˆæ­¢ç¬¦</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># ---- 0,1: ç›´æ¥æ¯”è¾ƒ ----</span>
</span></span><span class=line><span class=cl>    <span class=c1># LDMEM r0, [0] ; CMP_I r0, 102 (&#39;f&#39;)</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;f&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># LDMEM r0, [1] ; MOV r1, r0 ; ADD_I r1, 1 ; CMP_I r1, 109</span>
</span></span><span class=line><span class=cl>    <span class=c1># =&gt; flag[1] + 1 = 109 -&gt; flag[1] = 108 (&#39;l&#39;)</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;l&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># ---- 2,3,4: ä¸‰ä¸ªå¼‚æˆ–æ–¹ç¨‹ ----</span>
</span></span><span class=line><span class=cl>    <span class=c1>#  r1 = flag[2]</span>
</span></span><span class=line><span class=cl>    <span class=c1>#  r2 = flag[3]</span>
</span></span><span class=line><span class=cl>    <span class=c1>#  r3 = flag[4]</span>
</span></span><span class=line><span class=cl>    <span class=c1>#  CMP_I (r1 ^ r2), 6</span>
</span></span><span class=line><span class=cl>    <span class=c1>#  CMP_I (r2 ^ r3), 28</span>
</span></span><span class=line><span class=cl>    <span class=c1>#  CMP_I (r1 ^ r3), 26</span>
</span></span><span class=line><span class=cl>    <span class=c1>#</span>
</span></span><span class=line><span class=cl>    <span class=c1># è¿™ç»„æ–¹ç¨‹æœ‰å¾ˆå¤šæ•°å€¼è§£ï¼Œä½†æˆ‘ä»¬çŸ¥é“ä¸€èˆ¬ CTF flag ä¼šæ˜¯ &#34;flag{...}&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># ä»£å…¥ &#39;a&#39;,&#39;g&#39;,&#39;{&#39; å¯ä»¥éªŒè¯ï¼š</span>
</span></span><span class=line><span class=cl>    <span class=c1>#   ord(&#39;a&#39;) ^ ord(&#39;g&#39;) == 6</span>
</span></span><span class=line><span class=cl>    <span class=c1>#   ord(&#39;g&#39;) ^ ord(&#39;{&#39;) == 28</span>
</span></span><span class=line><span class=cl>    <span class=c1>#   ord(&#39;a&#39;) ^ ord(&#39;{&#39;) == 26</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;g&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;{&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># ---- 5,6,7: ä¸ &#39;H&#39;,&#39;i&#39;,&#39;T&#39; ç›¸å…³ ----</span>
</span></span><span class=line><span class=cl>    <span class=c1># LDMEM r1,[5]; LDMEM r2,[6]; LDMEM r3,[7]</span>
</span></span><span class=line><span class=cl>    <span class=c1># CMP_I r2, 105          -&gt; flag[6] == &#39;i&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;i&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># MOV r0,r1; XOR r0,r2; CMP_I r0,33  -&gt; flag[5] ^ flag[6] = 33</span>
</span></span><span class=line><span class=cl>    <span class=c1>#     ord(&#39;H&#39;) ^ ord(&#39;i&#39;) == 72 ^ 105 == 33</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;H&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># MOV r0,r3; XOR r0,r2; CMP_I r0,61  -&gt; flag[7] ^ flag[6] = 61 -&gt; flag[7] = 84 &#39;T&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;T&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># ---- 8,9,10: ä¸å‰é¢çš„ &#39;T&#39; ç»„åˆå‡ºæ¥ &#34;CTF&#34; ----</span>
</span></span><span class=line><span class=cl>    <span class=c1># LDMEM r4,[8]; LDMEM r5,[9]; LDMEM r6,[10]</span>
</span></span><span class=line><span class=cl>    <span class=c1># CMP r5,r3     -&gt; flag[9] == flag[7] == &#39;T&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>=</span> <span class=n>flag</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span>                <span class=c1># &#39;T&#39;</span>
</span></span><span class=line><span class=cl>    <span class=c1># MOV r0,r4; XOR r0,r5; CMP_I r0,23 -&gt; flag[8] ^ flag[9] = 23</span>
</span></span><span class=line><span class=cl>    <span class=c1># MOV r0,r6; XOR r0,r5; CMP_I r0,18 -&gt; flag[10] ^ flag[9] = 18</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>=</span> <span class=n>flag</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>^</span> <span class=mi>23</span>           <span class=c1># &#39;C&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span> <span class=o>=</span> <span class=n>flag</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>^</span> <span class=mi>18</span>          <span class=c1># &#39;F&#39;</span>
</span></span><span class=line><span class=cl>    <span class=c1># éªŒè¯ä¸€ä¸‹ï¼šchr(flag[8]) == &#39;C&#39;, chr(flag[9]) == &#39;T&#39;, chr(flag[10]) == &#39;F&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># ---- 11..16: å°¾å·´éƒ¨åˆ† ----</span>
</span></span><span class=line><span class=cl>    <span class=c1># LDMEM r1,[11] ; r1 = flag[11]</span>
</span></span><span class=line><span class=cl>    <span class=c1># CMP_I (r1+r1), 190          -&gt; 2*flag[11] = 190 -&gt; flag[11] = 95 -&gt; &#39;_&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>11</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;_&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># r7 = flag[17], ç»è¿‡ä¸€ç³»åˆ—æ“ä½œåè¦æ±‚ 0ï¼Œè¯´æ˜ç¬¬ 18 ä¸ªä½ç½®æ˜¯ 0 ç»ˆæ­¢ç¬¦ï¼Œ</span>
</span></span><span class=line><span class=cl>    <span class=c1># è€Œä¸æ˜¯æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ï¼ˆä¹Ÿå°±æ˜¯è¯´è¾“å…¥é•¿åº¦ä¸ç”¨åˆ° 18ï¼‰ã€‚</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># CMP r2,r4 -&gt; flag[12] == flag[14]</span>
</span></span><span class=line><span class=cl>    <span class=c1># åé¢ï¼š</span>
</span></span><span class=line><span class=cl>    <span class=c1>#   r0 = flag[12]; CMP_I r0,50 -&gt; flag[12] == &#39;2&#39;</span>
</span></span><span class=line><span class=cl>    <span class=c1>#   ç„¶å r0 -= 2 == 48 å†åŠ  5 == 53 ä¸ flag[15] æ¯”è¾ƒ -&gt; flag[15] == &#39;5&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>12</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>15</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;5&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># æœ€åï¼š</span>
</span></span><span class=line><span class=cl>    <span class=c1>#   LDMEM r0,[4] -&gt; r0=flag[4]=&#39;{&#39;</span>
</span></span><span class=line><span class=cl>    <span class=c1>#   SUB r6,r0   -&gt; r6 = flag[16] - flag[4]</span>
</span></span><span class=line><span class=cl>    <span class=c1>#   CMP_I r6,2  -&gt; flag[16] - flag[4] = 2  -&gt; flag[16] = &#39;{&#39; + 2 = &#39;}&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>16</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;}&#39;</span><span class=p>)</span>  <span class=c1># 123 + 2 = 125 -&gt; &#39;}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># flag[13] åœ¨å­—èŠ‚ç ä¸­ä»…è¢« LDMEM è¯»å…¥ï¼Œä»æœªå‚ä¸æ¯”è¾ƒï¼Œå› æ­¤æ˜¯è‡ªç”±å˜é‡ã€‚</span>
</span></span><span class=line><span class=cl>    <span class=c1># ç»“åˆ CTF å¹´ä»½ï¼Œâ€œ_2 0 2 5â€ æ¯”è¾ƒè‡ªç„¶ï¼Œæˆ‘ä»¬å°±å¡« &#39;0&#39;ã€‚</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>13</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;0&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=n>solve_flag</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Recovered flag:&#34;</span><span class=p>,</span> <span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># ç”¨ VM çœŸæœºè·‘ä¸€éæ ¡éªŒ</span>
</span></span><span class=line><span class=cl>    <span class=n>ok</span> <span class=o>=</span> <span class=n>vm_run</span><span class=p>(</span><span class=n>flag</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;VM check:&#34;</span><span class=p>,</span> <span class=s2>&#34;PASS&#34;</span> <span class=k>if</span> <span class=n>ok</span> <span class=k>else</span> <span class=s2>&#34;FAIL&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>ok</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>SystemExit</span><span class=p>(</span><span class=s2>&#34;æ±‚å‡ºæ¥çš„ flag æ²¡é€šè¿‡ VM æ ¡éªŒï¼Œè¯·æ£€æŸ¥è„šæœ¬é€»è¾‘ã€‚&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div></section><div class=comments><script>const getTheme=window.localStorage&&window.localStorage.getItem("theme");let theme=getTheme==="dark"?"dark":"light",s=document.createElement("script");s.src="https://giscus.app/client.js",s.setAttribute("data-repo","Wh1teJ0ker/discussion"),s.setAttribute("data-repo-id","R_kgDOOTzcZA"),s.setAttribute("data-category","Announcements"),s.setAttribute("data-category-id","DIC_kwDOOTzcZM4CoxXV"),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","top"),s.setAttribute("data-theme",theme),s.setAttribute("data-lang","zh-CN"),s.setAttribute("data-loading","lazy"),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div><div class=paginator><a class=next href=https://wh1tej0ker.github.io/post/2025uwsp-pointer-overflow-ctf-zrympb.html><span>2025UWSP Pointer Overflow CTF</span><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966 16.0174 11.8297 16.0154 11.9753 15.9494 12.0063 14.945 12.4779 13.0706 13.9264 12.055 15m3.5006-3.0333C13.1345 12.0608 8 12 6 11" stroke="currentcolor" stroke-linecap="round"/></svg></a></div></article></div><footer class=footer><p>&copy; 2025 <a href=https://wh1tej0ker.github.io/>Wh1teJ0kerã®Blog</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugoï¸ï¸</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
ï¸</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=/main.min.cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e.js integrity="sha512-z4PhNX7vuL3xVChQ1m2AB9Yg5AULVxXcg/SpIdNs6c5H0NE8XYXysP+DGNKHfuwvY7kxvUdBeoGlODJ6+SfaPg==" crossorigin=anonymous defer></script></html>