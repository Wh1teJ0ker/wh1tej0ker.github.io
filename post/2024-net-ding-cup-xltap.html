<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>Wh1teJ0kerのBlog</title>
<meta charset=utf-8><meta name=description content="Ladder@也是笑话了，p成什么鬼样子了"><meta name=author content="Wh1teJ0ker"><link rel=canonical href=https://wh1tej0ker.github.io/post/2024-net-ding-cup-xltap.html><link rel=alternate type=application/rss+xml href=https://wh1tej0ker.github.io//index.xml title=Wh1teJ0kerのBlog><script async defer data-website-id=56cc42c1-3656-4d3e-af3c-acded927b8ed src=https://analytics.umami.is/script.js></script><meta property="og:url" content="https://wh1tej0ker.github.io/post/2024-net-ding-cup-xltap.html"><meta property="og:site_name" content="Wh1teJ0kerのBlog"><meta property="og:title" content="2024网鼎杯"><meta property="og:description" content="也是笑话了，p成什么鬼样子了"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-10-29T11:59:39+08:00"><meta property="article:modified_time" content="2025-04-05T00:37:09+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="2024网鼎杯"><meta name=twitter:description content="也是笑话了，p成什么鬼样子了"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wh1tej0ker.github.io/post/"},{"@type":"ListItem","position":2,"name":"2024网鼎杯","item":"https://wh1tej0ker.github.io/post/2024-net-ding-cup-xltap.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"2024网鼎杯","name":"2024网鼎杯","description":"也是笑话了，p成什么鬼样子了","keywords":[],"articleBody":"2024网鼎杯 Misc MISC01 首先打开流量，发现存在多种协议\n1 2 3 S1AP GTPv2 DIAMETER 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 在移动通信协议中，S1AP、GTPv2 和 Diameter 协议都可能涉及位置信息。这些协议通常携带不同层级的位置信息，用于不同的功能，如位置更新、会话管理和用户的移动性管理。以下是每种协议中与位置信息相关的字段： --- ### 1. **S1AP (S1 Application Protocol)** S1AP 是 EPC 和 eNodeB 之间的接口协议，用于管理和信令。以下是 S1AP 中一些与位置信息相关的字段： - **eCGI (E-UTRAN Cell Global Identifier)**: 包含了小区的唯一标识符。 - **组成**：PLMN ID (包含 MCC 和 MNC) 和 Cell ID。 - **TAI (Tracking Area Identity)**: 标识用户当前所在的跟踪区域。 - **组成**：PLMN ID 和 TAC (Tracking Area Code)。 - **MME Code 和 MME Group ID**: 用于标识用户接入的 MME。 - **Location Reporting Information**: 包含用户的位置报告设置，用于位置更新和用户的移动管理。 - **Global-ENB-ID**: 标识特定的 eNodeB，包含 PLMN ID 和 eNodeB ID。 这些字段用于位置更新、移动管理和跟踪用户在网络中的位置变化。 --- ### 2. **GTPv2 (GPRS Tunneling Protocol Version 2)** GTPv2 用于 EPC 中的信令和会话管理，特别是在 S-GW 和 P-GW 之间。以下是 GTPv2 中常见的位置信息字段： - **User Location Information (ULI)**: 包含用户的位置信息。 - 可能包含多个字段，如 CGI (Cell Global Identity)、SAI (Service Area Identity)、RAI (Routing Area Identity)、TAI、ECGI 等。 - **CGI (Cell Global Identity)**: 包含 PLMN ID 和 Cell ID，用于标识具体的小区。 - **SAI (Service Area Identity)**: 包含 PLMN ID 和 Service Area Code，用于标识服务区域。 - **RAI (Routing Area Identity)**: 包含 PLMN ID 和 Routing Area Code，用于路由区域标识。 - **TAI (Tracking Area Identity)**: 用于标识用户所在的跟踪区域，与 S1AP 中的 TAI 类似。 这些字段在位置更新和会话管理消息中经常使用，例如位置更新请求和建立会话时。 --- ### 3. **Diameter (用于 S6a/S6d 接口)** Diameter 协议用于 MME 和 HSS 之间的信令，通常承载用户订阅和认证信息。在 Diameter 中，位置信息通常存在于以下字段中： - **EPS-Location-Information**: 包含 eNodeB 信息，用于标识用户的位置信息。 - 可能包含 MME Code、MME Group ID、ECGI、TAI 等。 - **Location-Information**: 包含用户的位置信息，可用于鉴权或更新位置请求。 - **RAT-Type**: 虽然不直接是位置字段，但可以指示用户接入的无线接入类型（如 LTE），这与位置信息一起使用。 - **Origin-Host 和 Origin-Realm**: 表示请求的来源 MME 和域，用于标识服务的源位置。 - **Serving-Node**: 表示服务节点的信息，包括可能的 MME 信息。 这些字段在用户位置更新和设备连接的认证请求中被频繁使用。 --- ### 总结 | 协议 | 位置相关字段 | 说明 | |-----------|-------------------------------------------|-------------------------------------------------| | **S1AP** | eCGI, TAI, MME Code, MME Group ID | 小区标识、跟踪区域标识、MME 标识 | | **GTPv2** | ULI, CGI, SAI, RAI, TAI | 用户位置信息、服务区域、路由区域、跟踪区域 | | **Diameter** | EPS-Location-Information, Location-Information, Origin-Host | 用户位置信息、位置更新 | 这些字段用于标识用户的位置和当前连接的网络组件，在不同的通信阶段为用户提供会话管理和位置更新支持。 根据gpt的回复，再加上附件名称位MME，重点怀疑是Diameter\n依次寻找尝试\n​​\n最终在这个流中发现EPS-Location-Information字段\n​​\n1 da18bee581c4ae md5加密一下\n1 daedc32bdeceb78094502e481c90c6cc MISC02 1 LinuxUbuntu_6_5_0-41-generic_profilex64 MISC03 一个数据很多的流量\n开始的时候查找到有相关webshell的信息\n开始的时候一直怀疑需要将webshell进行解密\n​​\n但是解了半天，一直有问题，后来发现原来是将源ip直接提交就行\n过滤一下200响应的流，就很容易找到了\n​​\n最终提交这个ip即可\n1 39.168.5.60 MISC04 原题在IrisCTF2024peanoscramble\n然后找到原题的wp\nhttps://almostgph.github.io/2024/01/08/IrisCTF2024/\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 from PIL import Image from tqdm import tqdm def peano(n): if n == 0: return [[0,0]] else: in_lst = peano(n - 1) lst = in_lst.copy() px,py = lst[-1] lst.extend([px - i[0], py + 1 + i[1]] for i in in_lst) px,py = lst[-1] lst.extend([px + i[0], py + 1 + i[1]] for i in in_lst) px,py = lst[-1] lst.extend([px + 1 + i[0], py - i[1]] for i in in_lst) px,py = lst[-1] lst.extend([px - i[0], py - 1 - i[1]] for i in in_lst) px,py = lst[-1] lst.extend([px + i[0], py - 1 - i[1]] for i in in_lst) px,py = lst[-1] lst.extend([px + 1 + i[0], py + i[1]] for i in in_lst) px,py = lst[-1] lst.extend([px - i[0], py + 1 + i[1]] for i in in_lst) px,py = lst[-1] lst.extend([px + i[0], py + 1 + i[1]] for i in in_lst) return lst order = peano(6) img = Image.open(r\"C:\\Users\\ASUSROG\\Desktop\\chal.png\") width, height = img.size block_width = width # // 3 block_height = height # // 3 new_image = Image.new(\"RGB\", (width, height)) for i, (x, y) in tqdm(enumerate(order)): # 根据列表顺序获取新的坐标 new_x, new_y = i % width, i // width # 获取原图像素 pixel = img.getpixel((x, height - 1 - y)) # 在新图像中放置像素 new_image.putpixel((new_x, new_y), pixel) new_image.save(\"rearranged_image.jpg\") ​​\n翻转图像后使用微信扫码得到flag\n1 wdflag{3f531c43-3b8b-42ab-babf-567f1216fa06} ‍\n","wordCount":"1651","inLanguage":"en","datePublished":"2024-10-29T11:59:39+08:00","dateModified":"2025-04-05T00:37:09+08:00","author":{"@type":"Person","name":"Wh1teJ0ker"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wh1tej0ker.github.io/post/2024-net-ding-cup-xltap.html"},"publisher":{"@type":"Organization","name":"Wh1teJ0kerのBlog","logo":{"@type":"ImageObject","url":"https://wh1tej0ker.github.io/favicon.ico"}}}</script><link rel=icon type=image/png href=/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/favicon.ico><link rel=manifest href=/favicon.ico><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.9d998bab4720091d5ec1e0fbbffd92b254a2e791623df6106cd7ea760bfc5c28.css integrity="sha256-nZmLq0cgCR1eweD7v/2SslSi55FiPfYQbNfqdgv8XCg=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.c607d6febd16934a82eb61d3a896ed9d869f54373cc63ce95864ed5488fe3128.js></script><script>hljs.highlightAll()</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/categories/>分类</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives/>归档</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/friends/>友链</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/about/>关于</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=https://cloud.umami.is/share/5RZUCwaG2fOysYPa/wh1tej0ker.github.io>Dashboard</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/Wh1teJ0ker><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>2024网鼎杯</h1></header><p><small>October 29, 2024&nbsp;· &nbsp;·</small><p><div class=blog-toc><nav id=TableOfContents><ul><li><a href=#misc01>MISC01</a></li><li><a href=#misc02>MISC02</a></li><li><a href=#misc03>MISC03</a></li><li><a href=#misc04>MISC04</a></li></ul></nav></div><section class=blog-content><h1 id=2024网鼎杯>2024网鼎杯</h1><h1 id=misc>Misc</h1><h2 id=misc01>MISC01</h2><p>首先打开流量，发现存在多种协议</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>S1AP
</span></span><span class=line><span class=cl>GTPv2
</span></span><span class=line><span class=cl>DIAMETER
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>在移动通信协议中，S1AP、GTPv2 和 Diameter 协议都可能涉及位置信息。这些协议通常携带不同层级的位置信息，用于不同的功能，如位置更新、会话管理和用户的移动性管理。以下是每种协议中与位置信息相关的字段：
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>### 1. **S1AP (S1 Application Protocol)**</span>
</span></span><span class=line><span class=cl>S1AP 是 EPC 和 eNodeB 之间的接口协议，用于管理和信令。以下是 S1AP 中一些与位置信息相关的字段：
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- **eCGI <span class=o>(</span>E-UTRAN Cell Global Identifier<span class=o>)</span>**: 包含了小区的唯一标识符。
</span></span><span class=line><span class=cl>  - **组成**：PLMN ID <span class=o>(</span>包含 MCC 和 MNC<span class=o>)</span> 和 Cell ID。
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>- **TAI <span class=o>(</span>Tracking Area Identity<span class=o>)</span>**: 标识用户当前所在的跟踪区域。
</span></span><span class=line><span class=cl>  - **组成**：PLMN ID 和 TAC <span class=o>(</span>Tracking Area Code<span class=o>)</span>。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- **MME Code 和 MME Group ID**: 用于标识用户接入的 MME。
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>- **Location Reporting Information**: 包含用户的位置报告设置，用于位置更新和用户的移动管理。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- **Global-ENB-ID**: 标识特定的 eNodeB，包含 PLMN ID 和 eNodeB ID。
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>这些字段用于位置更新、移动管理和跟踪用户在网络中的位置变化。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>### 2. **GTPv2 (GPRS Tunneling Protocol Version 2)**</span>
</span></span><span class=line><span class=cl>GTPv2 用于 EPC 中的信令和会话管理，特别是在 S-GW 和 P-GW 之间。以下是 GTPv2 中常见的位置信息字段：
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- **User Location Information <span class=o>(</span>ULI<span class=o>)</span>**: 包含用户的位置信息。
</span></span><span class=line><span class=cl>  - 可能包含多个字段，如 CGI <span class=o>(</span>Cell Global Identity<span class=o>)</span>、SAI <span class=o>(</span>Service Area Identity<span class=o>)</span>、RAI <span class=o>(</span>Routing Area Identity<span class=o>)</span>、TAI、ECGI 等。
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>- **CGI <span class=o>(</span>Cell Global Identity<span class=o>)</span>**: 包含 PLMN ID 和 Cell ID，用于标识具体的小区。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- **SAI <span class=o>(</span>Service Area Identity<span class=o>)</span>**: 包含 PLMN ID 和 Service Area Code，用于标识服务区域。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- **RAI <span class=o>(</span>Routing Area Identity<span class=o>)</span>**: 包含 PLMN ID 和 Routing Area Code，用于路由区域标识。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- **TAI <span class=o>(</span>Tracking Area Identity<span class=o>)</span>**: 用于标识用户所在的跟踪区域，与 S1AP 中的 TAI 类似。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>这些字段在位置更新和会话管理消息中经常使用，例如位置更新请求和建立会话时。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>### 3. **Diameter (用于 S6a/S6d 接口)**</span>
</span></span><span class=line><span class=cl>Diameter 协议用于 MME 和 HSS 之间的信令，通常承载用户订阅和认证信息。在 Diameter 中，位置信息通常存在于以下字段中：
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- **EPS-Location-Information**: 包含 eNodeB 信息，用于标识用户的位置信息。
</span></span><span class=line><span class=cl>  - 可能包含 MME Code、MME Group ID、ECGI、TAI 等。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- **Location-Information**: 包含用户的位置信息，可用于鉴权或更新位置请求。
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>- **RAT-Type**: 虽然不直接是位置字段，但可以指示用户接入的无线接入类型（如 LTE），这与位置信息一起使用。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- **Origin-Host 和 Origin-Realm**: 表示请求的来源 MME 和域，用于标识服务的源位置。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- **Serving-Node**: 表示服务节点的信息，包括可能的 MME 信息。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>这些字段在用户位置更新和设备连接的认证请求中被频繁使用。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>### 总结</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>|</span> 协议      <span class=p>|</span> 位置相关字段                               <span class=p>|</span> 说明                                            <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>-----------<span class=p>|</span>-------------------------------------------<span class=p>|</span>-------------------------------------------------<span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> **S1AP**  <span class=p>|</span> eCGI, TAI, MME Code, MME Group ID         <span class=p>|</span> 小区标识、跟踪区域标识、MME 标识                <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> **GTPv2** <span class=p>|</span> ULI, CGI, SAI, RAI, TAI                   <span class=p>|</span> 用户位置信息、服务区域、路由区域、跟踪区域      <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> **Diameter** <span class=p>|</span> EPS-Location-Information, Location-Information, Origin-Host <span class=p>|</span> 用户位置信息、位置更新                           <span class=p>|</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>这些字段用于标识用户的位置和当前连接的网络组件，在不同的通信阶段为用户提供会话管理和位置更新支持。
</span></span></code></pre></td></tr></table></div></div><p>根据gpt的回复，再加上附件名称位MME，重点怀疑是Diameter</p><p>依次寻找尝试</p><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/QQ_1730190191264-20241029162313-4j2oci3.png alt=QQ_1730190191264>​</p><p>最终在这个流中发现EPS-Location-Information字段</p><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/QQ_1730190262965-20241029162426-zut3olm.png alt=QQ_1730190262965>​</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>da18bee581c4ae
</span></span></code></pre></td></tr></table></div></div><p>md5加密一下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>daedc32bdeceb78094502e481c90c6cc
</span></span></code></pre></td></tr></table></div></div><h2 id=misc02>MISC02</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>LinuxUbuntu_6_5_0-41-generic_profilex64
</span></span></code></pre></td></tr></table></div></div><h2 id=misc03>MISC03</h2><p>一个数据很多的流量</p><p>开始的时候查找到有相关webshell的信息</p><p>开始的时候一直怀疑需要将webshell进行解密</p><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/QQ_1730189599339-20241029161324-441xbp1.png alt=QQ_1730189599339>​</p><p>但是解了半天，一直有问题，后来发现原来是将源ip直接提交就行</p><p>过滤一下200响应的流，就很容易找到了</p><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/QQ_1730189771130-20241029161616-l31904r.png alt=QQ_1730189771130>​</p><p>最终提交这个ip即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>39.168.5.60
</span></span></code></pre></td></tr></table></div></div><h2 id=misc04>MISC04</h2><p>原题在IrisCTF2024peanoscramble</p><p>然后找到原题的wp</p><p><a href=https://almostgph.github.io/2024/01/08/IrisCTF2024/>https://almostgph.github.io/2024/01/08/IrisCTF2024/</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tqdm</span> <span class=kn>import</span> <span class=n>tqdm</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>peano</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[[</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>in_lst</span> <span class=o>=</span> <span class=n>peano</span><span class=p>(</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>lst</span> <span class=o>=</span> <span class=n>in_lst</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>px</span><span class=p>,</span><span class=n>py</span> <span class=o>=</span> <span class=n>lst</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>lst</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=n>px</span> <span class=o>-</span> <span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>py</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>+</span> <span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>in_lst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>px</span><span class=p>,</span><span class=n>py</span> <span class=o>=</span> <span class=n>lst</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>lst</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=n>px</span> <span class=o>+</span> <span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>py</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>+</span> <span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>in_lst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>px</span><span class=p>,</span><span class=n>py</span> <span class=o>=</span> <span class=n>lst</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>lst</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=n>px</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>+</span> <span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>py</span> <span class=o>-</span> <span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>in_lst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>px</span><span class=p>,</span><span class=n>py</span> <span class=o>=</span> <span class=n>lst</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>lst</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=n>px</span> <span class=o>-</span> <span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>py</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>in_lst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>px</span><span class=p>,</span><span class=n>py</span> <span class=o>=</span> <span class=n>lst</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>lst</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=n>px</span> <span class=o>+</span> <span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>py</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>in_lst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>px</span><span class=p>,</span><span class=n>py</span> <span class=o>=</span> <span class=n>lst</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>lst</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=n>px</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>+</span> <span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>py</span> <span class=o>+</span> <span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>in_lst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>px</span><span class=p>,</span><span class=n>py</span> <span class=o>=</span> <span class=n>lst</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>lst</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=n>px</span> <span class=o>-</span> <span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>py</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>+</span> <span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>in_lst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>px</span><span class=p>,</span><span class=n>py</span> <span class=o>=</span> <span class=n>lst</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>lst</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=n>px</span> <span class=o>+</span> <span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>py</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>+</span> <span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>in_lst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>lst</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>order</span> <span class=o>=</span> <span class=n>peano</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;C:\Users\ASUSROG\Desktop\chal.png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>width</span><span class=p>,</span> <span class=n>height</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>block_width</span> <span class=o>=</span> <span class=n>width</span> <span class=c1># // 3</span>
</span></span><span class=line><span class=cl><span class=n>block_height</span> <span class=o>=</span> <span class=n>height</span> <span class=c1># // 3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>new_image</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s2>&#34;RGB&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span> <span class=ow>in</span> <span class=n>tqdm</span><span class=p>(</span><span class=nb>enumerate</span><span class=p>(</span><span class=n>order</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 根据列表顺序获取新的坐标</span>
</span></span><span class=line><span class=cl>    <span class=n>new_x</span><span class=p>,</span> <span class=n>new_y</span> <span class=o>=</span> <span class=n>i</span> <span class=o>%</span> <span class=n>width</span><span class=p>,</span> <span class=n>i</span> <span class=o>//</span> <span class=n>width</span>
</span></span><span class=line><span class=cl>    <span class=c1># 获取原图像素</span>
</span></span><span class=line><span class=cl>    <span class=n>pixel</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>getpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>height</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1># 在新图像中放置像素</span>
</span></span><span class=line><span class=cl>    <span class=n>new_image</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>new_x</span><span class=p>,</span> <span class=n>new_y</span><span class=p>),</span> <span class=n>pixel</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>new_image</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s2>&#34;rearranged_image.jpg&#34;</span><span class=p>)</span> 
</span></span></code></pre></td></tr></table></div></div><p>​<img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic/QQ_1730189087698-20241029160451-lo0ip5f.png alt=QQ_1730189087698>​</p><p>翻转图像后使用微信扫码得到flag</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>wdflag<span class=o>{</span>3f531c43-3b8b-42ab-babf-567f1216fa06<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>‍</p></section><div class=comments><script>const getTheme=window.localStorage&&window.localStorage.getItem("theme");let theme=getTheme==="dark"?"dark":"light",s=document.createElement("script");s.src="https://giscus.app/client.js",s.setAttribute("data-repo","Wh1teJ0ker/discussion"),s.setAttribute("data-repo-id","R_kgDOOTzcZA"),s.setAttribute("data-category","Announcements"),s.setAttribute("data-category-id","DIC_kwDOOTzcZM4CoxXV"),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","top"),s.setAttribute("data-theme",theme),s.setAttribute("data-lang","zh-CN"),s.setAttribute("data-loading","lazy"),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div><div class=paginator><a class=prev href=https://wh1tej0ker.github.io/post/2024-digital-news-cup-offline-final-bakek.html><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M9.94496 9C9.28897 9.61644 7.63215 10.997 6.04814 11.7966 5.98257 11.8297 5.98456 11.9753 6.05061 12.0063c1.00435.4716 2.8788 1.9201 3.89435 2.9937M6.44444 11.9667C8.86549 12.0608 14 12 16 11" stroke="currentcolor" stroke-linecap="round"/></svg>
<span>2024数信杯线下决赛</span></a>
<a class=next href=https://wh1tej0ker.github.io/post/2024-strong-network-arabia-z2jdx0.html><span>2024强网拟态</span><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966 16.0174 11.8297 16.0154 11.9753 15.9494 12.0063 14.945 12.4779 13.0706 13.9264 12.055 15m3.5006-3.0333C13.1345 12.0608 8 12 6 11" stroke="currentcolor" stroke-linecap="round"/></svg></a></div></article></div><footer class=footer><p>&copy; 2026 <a href=https://wh1tej0ker.github.io/>Wh1teJ0kerのBlog</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=/main.min.cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e.js integrity="sha512-z4PhNX7vuL3xVChQ1m2AB9Yg5AULVxXcg/SpIdNs6c5H0NE8XYXysP+DGNKHfuwvY7kxvUdBeoGlODJ6+SfaPg==" crossorigin=anonymous defer></script></html>