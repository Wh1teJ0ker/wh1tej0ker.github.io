<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>Wh1teJ0kerのBlog</title>
<meta charset=utf-8><meta name=description content="Ladder@原题+AI一把嗦"><meta name=author content="Wh1teJ0ker"><link rel=canonical href=https://wh1tej0ker.github.io/post/2025yang-cheng-bei-14spwm.html><link rel=alternate type=application/rss+xml href=https://wh1tej0ker.github.io//index.xml title=Wh1teJ0kerのBlog><script async defer data-website-id=56cc42c1-3656-4d3e-af3c-acded927b8ed src=https://analytics.umami.is/script.js></script><meta property="og:url" content="https://wh1tej0ker.github.io/post/2025yang-cheng-bei-14spwm.html"><meta property="og:site_name" content="Wh1teJ0kerのBlog"><meta property="og:title" content="2025羊城杯"><meta property="og:description" content="原题+AI一把嗦"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2025-10-11T13:20:43+08:00"><meta property="article:modified_time" content="2025-10-30T13:53:18+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="2025羊城杯"><meta name=twitter:description content="原题+AI一把嗦"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wh1tej0ker.github.io/post/"},{"@type":"ListItem","position":2,"name":"2025羊城杯","item":"https://wh1tej0ker.github.io/post/2025yang-cheng-bei-14spwm.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"2025羊城杯","name":"2025羊城杯","description":"原题+AI一把嗦","keywords":[],"articleBody":"2025羊城杯 Misc 别笑，你试你也过不了第二关 第一关要求\n1 2 3 4 5 6 7 编写代码使字符串 hilogo 的内容为以下图案： ##### ##### ### # # ##### ##### ##### ##### ### # # ##### # # # # # # # # # # # # # # # # # # # ##### # # # # # # # ##### # # # # # # # # # # # # # # # # # # # # # ##### ##### # # ##### ##### ##### ##### ##### ##### # # ##### ##### ##### 使用替换的方法，比较容易\n1 2 3 4 s='ebecccafafeaeaeaecccafafe|ahadacabafafacaaaeagadacabafafaca|ahadebafafacaaaeagadebafafaca|ahadacabafafacaaaeagadacabafafaca|ebebacabebebeaeaeaebacabebebe';r='';i=j=0;t='# ' while j\u003clen(s): c=s[j];r=r+('\\n'if c=='|'else t[i%2]*(ord(c)\u002615));i=0 if c=='|'else i+1;j=j+1 hilogo=r 第二关要求\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 请编写 code 以输出前0x114514个数的序数词后缀: def get_ordinal(n): if 10 \u003c= n % 100 \u003c= 20: suffix = 'th' else: suffix = ['st', 'nd', 'rd', 'th', 'th', 'th', 'th', 'th', 'th', 'th'][n % 10 - 1] return suffix test_passed = True user_function = eval(f\"lambda n: {code}\", {}, {}) for i in range(1, 0x114514): if user_function(i) != get_ordinal(i): test_passed = False 这里开始使用基础的切片方法，始终过不去\n最后在cofegolf上找到了结果\n1 'tsnrhtdd'[n%5*(n%100^15\u003e4\u003en%10)::4] 帅的被人砍 只补全解密后部分，如何得到第二行密钥还需要补充\n图片文件名 hide.jpg 提示可能有隐写，稍作尝试后使用 steghide 提取出 key.txt：\n1 PZNCKSLLLNWUMILYTNQSXCIDUNBHBDFV 怀疑其是加密使用的密钥，尝试代入解密器源码中编译运行：\n1 2 3 4 5 6 7 8 9 int main() { unsigned char key[32] = { 'P', 'Z', 'N', 'C', 'K', 'S', 'L', 'L', 'L', 'N', 'W', 'U', 'M', 'I', 'L', 'Y', 'T', 'N', 'Q', 'S', 'X', 'C', 'I', 'D', 'U', 'N', 'B', 'H', 'B', 'D', 'F', 'V' }; //需要将其换成获得的key decrypt_file(\"动态KEY生成器.lock\", \"动态KEY生成器.re\", key); system(\"chmod +x 动态KEY生成器.re\"); return 0; } 运行后输出 .re 文件，经验证是合法的 Linux ELF 程序。对其进行逆向分析，是取运行时的系统时间，处理后与硬编码数据逐位异或输出。主函数反编译代码：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 v15 = __readfsqword(0x28u); v10 = time(0LL); snprintf(s, 0x40uLL, \"%lld\", v10 * (__int64)v10); v11 = strlen(s); if ( v11 \u003e 15 ) { v3 = \u0026s[v11 - 16]; v4 = *((_QWORD *)v3 + 1); v12 = *(_QWORD *)v3; v13 = v4; } else { memset(\u0026v12, 48, 16 - v11); memcpy((char *)\u0026v12 + 16 - v11, s, v11); } for ( i = 0; i \u003c= 3; ++i ) { v5 = \u0026s[16 * i + 64]; v6 = v13; *(_QWORD *)v5 = v12; *((_QWORD *)v5 + 1) = v6; } printf(\"KEY\u003e\u003e \"); for ( j = 0; j \u003c= 63; ++j ) putchar(s[j + 64] ^ byte_B60[j]); puts(\u0026::s); return 0LL; ​byte_B60 是已知的，但时间我们不知道。考虑到前面从 flag 生成器中得到的未知字符串，可能是加密后数据，于是结合 key 生成逻辑，用脚本进行反推：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 from binascii import unhexlify mask_hex=\"5E5544425C07040D0751010B42010E000558004B4641454C464A52545F5B5D01767660756D7D4A575C495309070704555E404146405953480201090E0250054B00\" M=bytearray(unhexlify(mask_hex)); M=M[:64] cipher=b\"oeqqh2550i12v3964h5xrtttqrbmkij7\" cands=[] for start in (0,16,32): ms=M[start:start+32] Q=bytes([c ^ m for c,m in zip(cipher, ms)]) a, b = Q[:16], Q[16:] ok_digits = all(48 \u003c= x \u003c= 57 for x in a) if len(ms)==32 and a==b and ok_digits: cands.append((start, a.decode())) print(\"candidates:\", cands) # candidates: [(0, '1053451878094276')] 得到 1053451878094276 这一个数字，为异或过程用到的 key，解密：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 from binascii import unhexlify S=b'1053451878094276' P=S*4 mask_hex='5E5544425C07040D0751010B42010E000558004B4641454C464A52545F5B5D01767660756D7D4A575C495309070704555E404146405953480201090E0250054B00' M=bytearray(unhexlify(mask_hex))[:64] O=bytes([p^m for p,m in zip(P,M)]) print('full64:',O.decode('latin1')) print('first32:',O[:32].decode('latin1')) print('last32:',O[32:].decode('latin1')) # full64: oeqqh2550i12v3964h5xrtttqrbmkij7GFUFYH{okqc0353coptutlbp59976b2} # first32: oeqqh2550i12v3964h5xrtttqrbmkij7 # last32: GFUFYH{okqc0353coptutlbp59976b2} 得到的 full64 即为经 flag 生成器处理前的原内容，输入后得到 Flag：\npolar ‍\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 def construction(N, K, eps): infoIndex = np.array([4, 5, 6, 7], dtype=int) frozenIndex = np.array([0, 1, 2, 3], dtype=int) return infoIndex, frozenIndex, np.arange(N, dtype=int) ] def encode(u, N): x = np.zeros(N, dtype=int) x[0] = u[4]; x[1] = u[4] x[2] = u[5]; x[3] = u[5] x[4] = u[6]; x[5] = u[6] x[6] = u[7]; x[7] = u[7] return x def decode(y, frozenIndex): N = len(y) uh = np.zeros(N, dtype=int) def decide(p, q): a = y[p]; b = y[q] if a is None and b is None: return np.random.randint(0, 2) if a is None: return b if b is None: return a return 1 if (a + b) \u003e= 1 else 0 uh[4] = decide(0, 1) uh[5] = decide(2, 3) uh[6] = decide(4, 5) uh[7] = decide(6, 7) for i in frozenIndex: uh[i] = 0 return uh DS\u0026AI Mini-modelscope 发现使用tensflow，合理猜想思路应该是通过写入，让模型在导入的时候实现命令执行\n根据题目描述，推理时，模型的签名 serve 会返回指定文件（这里是 /flag）的内容\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 import tensorflow as tf import os import shutil import zipfile EXPORT_DIR = \"mdoel\" ZIP_NAME = \"model.zip\" FLAG_PATH = \"/flag\" if os.path.exists(EXPORT_DIR): shutil.rmtree(EXPORT_DIR) if os.path.exists(ZIP_NAME): os.remove(ZIP_NAME) @tf.function(input_signature=[tf.TensorSpec(shape=[None, 1], dtype=tf.float32)]) def serve_fn(x): data = tf.io.read_file(FLAG_PATH) batch_dim = tf.shape(x)[0] data_vec = tf.repeat(tf.expand_dims(data, 0), repeats=batch_dim) return {\"prediction\": data_vec} class ModelWrapper(tf.Module): @tf.function(input_signature=[tf.TensorSpec(shape=[None, 1], dtype=tf.float32)]) def __call__(self, inputs): return serve_fn(inputs) model_instance = ModelWrapper() tf.saved_model.save(model_instance, EXPORT_DIR, signatures={\"serve\": serve_fn}) with zipfile.ZipFile(ZIP_NAME, \"w\", zipfile.ZIP_DEFLATED) as zf: for root, _, files in os.walk(EXPORT_DIR): for file in files: full_path = os.path.join(root, file) rel_path = os.path.relpath(full_path, EXPORT_DIR) zf.write(full_path, rel_path) dataIdSort 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 import re, csv from pathlib import Path from datetime import datetime from collections import Counter # ---------------- 工具函数 ---------------- def is_valid_date_yyyymmdd(s: str) -\u003e bool: try: datetime.strptime(s, \"%Y%m%d\") return True except Exception: return False def id_checksum_char(id17: str) -\u003e str: w = [7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2] tab = ['1','0','X','9','8','7','6','5','4','3','2'] return tab[sum(int(a)*b for a,b in zip(id17, w)) % 11] def valid_id(raw: str) -\u003e bool: core = re.sub(r'[-\\s]', '', raw).upper() if not re.fullmatch(r'\\d{17}[0-9X]', core): return False if core[:6] == '000000': return False try: prov = int(core[:2]) if not (11 \u003c= prov \u003c= 65): return False except: return False if core[14:17] == '000': return False b = core[6:14] try: bd = datetime.strptime(b, \"%Y%m%d\") if bd.year \u003c 1900 or bd \u003e datetime.now(): return False except: return False return core[-1] == id_checksum_char(core[:17]) def luhn_ok(num: str) -\u003e bool: num = re.sub(r'[\\s-]', '', num) if not (16 \u003c= len(num) \u003c= 19 and num.isdigit()): return False ds = [int(x) for x in num[::-1]] s = 0 for i, d in enumerate(ds): if i % 2: d = d * 2 - 9 if d * 2 \u003e 9 else d * 2 s += d return s % 10 == 0 def valid_ip(ip: str) -\u003e bool: ip = ip.replace(\"．\", \".\").replace(\"。\", \".\") parts = ip.split('.') if len(parts) != 4: return False try: for p in parts: if not (0 \u003c= int(p) \u003c= 255): return False if len(p) \u003e 1 and p.startswith('0'): return False return True except Exception: return False # ---------------- 常量集合 ---------------- PHONE_PREFIX3 = { '130','131','132','133','134','135','136','137','138','139', '140','145','146','149','150','151','152','153','155','156', '166','167','171','172','173','174','175','176','177','178', '180','181','182','183','184','185','186','187','188','189', '190','191','193','195','196','198','199','147','148' } prefix_alt = \"(?:\" + \"|\".join(sorted(PHONE_PREFIX3)) + \")\" # ---------------- 正则模式 ---------------- PATTERNS = { \"idcard\": re.compile(r'(?\u003c!\\d)(?:\\d{17}[0-9Xx]|\\d{6}[-\\s]+\\d{8}[-\\s]+\\d{3}[0-9Xx])(?!\\d)'), \"phone\": re.compile(rf''' (?\u003c!\\d) (?:\\+86\\s*|\\(\\+86\\)\\s*)? ({prefix_alt}) (?: \\d{{8}} # 连续 11 位（已含前三位） | [-\\s]\\d{{4}}[-\\s]\\d{{4}} # 严格 3-4-4：恰好两处分隔 ) (?!\\d) ''', re.VERBOSE), \"bankcard\": re.compile( r'(?\u003c!\\d)(?:' r'(?:[1-9]\\d{15,18})' r')(?!\\d)' ), \"ip\": re.compile(r'(?\u003c!\\d)(?:\\d{1,3}\\.){3}\\d{1,3}(?!\\d)'), \"mac\": re.compile(r'[0-9A-Fa-f]{2}(?::[0-9A-Fa-f]{2}){5}') } # ---------------- 核心识别函数 ---------------- def detect_sensitive_data(text: str): out, seen = [], set() def push(cat, val, pos): if (cat, val) not in seen: seen.add((cat, val)) out.append((pos, cat, val.strip())) for m in PATTERNS[\"idcard\"].finditer(text): s = m.group(0) if valid_id(s): push(\"idcard\", s, m.start()) for m in PATTERNS[\"phone\"].finditer(text): s = m.group(0) digits = re.sub(r\"\\D\", \"\", s) if digits.startswith(\"86\") and len(digits) \u003e 11: digits = digits[2:] if len(digits) == 11 and digits[:3] in PHONE_PREFIX3: mid = digits[3:7] if not re.match(r\"(19|20)\\d{2}\", mid): push(\"phone\", s.strip(), m.start()) for m in PATTERNS[\"bankcard\"].finditer(text): s = m.group(0) if luhn_ok(s): if not re.match(r'\\d{6}(19|20)\\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\\d|3[01])', s): push(\"bankcard\", s, m.start()) for m in PATTERNS[\"ip\"].finditer(text): s = m.group(0) if valid_ip(s): push(\"ip\", s, m.start()) for m in PATTERNS[\"mac\"].finditer(text): s = m.group(0).lower() if all(re.fullmatch(r\"[0-9A-Fa-f]{2}\", seg) for seg in s.split(\":\")): push(\"mac\", s.lower(), m.start()) # ✳️ 改动关键处：分类排序（不按出现顺序，而按类别块排序） category_order = [\"idcard\", \"phone\", \"bankcard\", \"ip\", \"mac\"] out.sort(key=lambda x: (category_order.index(x[1]), x[0])) return out # ---------------- 输出 ---------------- def write_to_csv(out_data, output_path: Path): with output_path.open(\"w\", encoding=\"utf-8\", newline=\"\") as f: writer = csv.writer(f) writer.writerow([\"category\", \"value\"]) for _, cat, val in out_data: writer.writerow([cat, val]) # ---------------- 主程序 ---------------- def main(): DATA_PATH = Path(\"data.txt\") OUT_PATH = Path(\"result_plus_grouped.csv\") text = DATA_PATH.read_text(encoding=\"utf-8\", errors=\"ignore\") results = detect_sensitive_data(text) write_to_csv(results, OUT_PATH) cnt = Counter(c for _, c, _ in results) print(f\"✅ 输出文件: {OUT_PATH}\") print(\"📊 统计:\", dict(cnt)) if __name__ == \"__main__\": main() ","wordCount":"2174","inLanguage":"en","datePublished":"2025-10-11T13:20:43+08:00","dateModified":"2025-10-30T13:53:18+08:00","author":{"@type":"Person","name":"Wh1teJ0ker"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wh1tej0ker.github.io/post/2025yang-cheng-bei-14spwm.html"},"publisher":{"@type":"Organization","name":"Wh1teJ0kerのBlog","logo":{"@type":"ImageObject","url":"https://wh1tej0ker.github.io/favicon.ico"}}}</script><link rel=icon type=image/png href=/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/favicon.ico><link rel=manifest href=/favicon.ico><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.9d998bab4720091d5ec1e0fbbffd92b254a2e791623df6106cd7ea760bfc5c28.css integrity="sha256-nZmLq0cgCR1eweD7v/2SslSi55FiPfYQbNfqdgv8XCg=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.c607d6febd16934a82eb61d3a896ed9d869f54373cc63ce95864ed5488fe3128.js></script><script>hljs.highlightAll()</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/categories/>分类</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives/>归档</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/friends/>友链</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/about/>关于</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=https://cloud.umami.is/share/5RZUCwaG2fOysYPa/wh1tej0ker.github.io>Dashboard</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/Wh1teJ0ker><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>2025羊城杯</h1></header><p><small>October 11, 2025&nbsp;· &nbsp;·</small><p><div class=blog-toc><nav id=TableOfContents><ul><li><a href=#别笑你试你也过不了第二关>别笑，你试你也过不了第二关</a></li><li><a href=#帅的被人砍>帅的被人砍</a></li><li><a href=#polar>polar</a></li></ul><ul><li><a href=#dataidsort>dataIdSort</a></li></ul></nav></div><section class=blog-content><h1 id=2025羊城杯>2025羊城杯</h1><h1 id=misc>Misc</h1><h2 id=别笑你试你也过不了第二关>别笑，你试你也过不了第二关</h2><p>第一关要求</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>编写代码使字符串</span> <span class=err>hilogo</span> <span class=err>的内容为以下图案：</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>#####</span>  <span class=err>#####</span>   <span class=err>###</span>   <span class=err>#</span>      <span class=err>#</span>      <span class=err>#####</span> <span class=err>#####</span> <span class=err>#####</span> <span class=err>#####</span>   <span class=err>###</span>   <span class=err>#</span>      <span class=err>#</span>      <span class=err>#####</span>
</span></span><span class=line><span class=cl><span class=err>#</span>        <span class=err>#</span>    <span class=err>#</span>   <span class=err>#</span>  <span class=err>#</span>      <span class=err>#</span>      <span class=err>#</span>   <span class=err>#</span> <span class=err>#</span>     <span class=err>#</span>       <span class=err>#</span>    <span class=err>#</span>   <span class=err>#</span>  <span class=err>#</span>      <span class=err>#</span>      <span class=err>#</span>   <span class=err>#</span>
</span></span><span class=line><span class=cl><span class=err>#</span>        <span class=err>#</span>    <span class=err>#####</span>  <span class=err>#</span>      <span class=err>#</span>      <span class=err>#</span>   <span class=err>#</span> <span class=err>#</span>     <span class=err>#</span>       <span class=err>#</span>    <span class=err>#####</span>  <span class=err>#</span>      <span class=err>#</span>      <span class=err>#</span>   <span class=err>#</span>
</span></span><span class=line><span class=cl><span class=err>#</span>        <span class=err>#</span>    <span class=err>#</span>   <span class=err>#</span>  <span class=err>#</span>      <span class=err>#</span>      <span class=err>#</span>   <span class=err>#</span> <span class=err>#</span>     <span class=err>#</span>       <span class=err>#</span>    <span class=err>#</span>   <span class=err>#</span>  <span class=err>#</span>      <span class=err>#</span>      <span class=err>#</span>   <span class=err>#</span>
</span></span><span class=line><span class=cl><span class=err>#####</span>  <span class=err>#####</span>  <span class=err>#</span>   <span class=err>#</span>  <span class=err>#####</span>  <span class=err>#####</span>  <span class=err>#####</span> <span class=err>#####</span> <span class=err>#####</span> <span class=err>#####</span>  <span class=err>#</span>   <span class=err>#</span>  <span class=err>#####</span>  <span class=err>#####</span>  <span class=err>#####</span>
</span></span></code></pre></td></tr></table></div></div><p>使用替换的方法，比较容易</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>s</span><span class=o>=</span><span class=s1>&#39;ebecccafafeaeaeaecccafafe|ahadacabafafacaaaeagadacabafafaca|ahadebafafacaaaeagadebafafaca|ahadacabafafacaaaeagadacabafafaca|ebebacabebebeaeaeaebacabebebe&#39;</span><span class=p>;</span><span class=n>r</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=n>i</span><span class=o>=</span><span class=n>j</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=n>t</span><span class=o>=</span><span class=s1>&#39;# &#39;</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>j</span><span class=o>&lt;</span><span class=nb>len</span><span class=p>(</span><span class=n>s</span><span class=p>):</span>
</span></span><span class=line><span class=cl> <span class=n>c</span><span class=o>=</span><span class=n>s</span><span class=p>[</span><span class=n>j</span><span class=p>];</span><span class=n>r</span><span class=o>=</span><span class=n>r</span><span class=o>+</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=k>if</span> <span class=n>c</span><span class=o>==</span><span class=s1>&#39;|&#39;</span><span class=k>else</span> <span class=n>t</span><span class=p>[</span><span class=n>i</span><span class=o>%</span><span class=mi>2</span><span class=p>]</span><span class=o>*</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>c</span><span class=p>)</span><span class=o>&amp;</span><span class=mi>15</span><span class=p>));</span><span class=n>i</span><span class=o>=</span><span class=mi>0</span> <span class=k>if</span> <span class=n>c</span><span class=o>==</span><span class=s1>&#39;|&#39;</span><span class=k>else</span> <span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>;</span><span class=n>j</span><span class=o>=</span><span class=n>j</span><span class=o>+</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>hilogo</span><span class=o>=</span><span class=n>r</span>
</span></span></code></pre></td></tr></table></div></div><p>第二关要求</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>请编写</span> <span class=n>code</span> <span class=n>以输出前0x114514个数的序数词后缀</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_ordinal</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=mi>10</span> <span class=o>&lt;=</span> <span class=n>n</span> <span class=o>%</span> <span class=mi>100</span> <span class=o>&lt;=</span> <span class=mi>20</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=n>suffix</span> <span class=o>=</span> <span class=s1>&#39;th&#39;</span>
</span></span><span class=line><span class=cl>	<span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=n>suffix</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;st&#39;</span><span class=p>,</span> <span class=s1>&#39;nd&#39;</span><span class=p>,</span> <span class=s1>&#39;rd&#39;</span><span class=p>,</span> <span class=s1>&#39;th&#39;</span><span class=p>,</span> <span class=s1>&#39;th&#39;</span><span class=p>,</span> <span class=s1>&#39;th&#39;</span><span class=p>,</span> <span class=s1>&#39;th&#39;</span><span class=p>,</span> <span class=s1>&#39;th&#39;</span><span class=p>,</span> <span class=s1>&#39;th&#39;</span><span class=p>,</span> <span class=s1>&#39;th&#39;</span><span class=p>][</span><span class=n>n</span> <span class=o>%</span> <span class=mi>10</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=n>suffix</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>            <span class=n>test_passed</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>            <span class=n>user_function</span> <span class=o>=</span> <span class=nb>eval</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;lambda n: </span><span class=si>{</span><span class=n>code</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=p>{},</span> <span class=p>{})</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mh>0x114514</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>user_function</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=o>!=</span> <span class=n>get_ordinal</span><span class=p>(</span><span class=n>i</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>test_passed</span> <span class=o>=</span> <span class=kc>False</span>
</span></span></code></pre></td></tr></table></div></div><p>这里开始使用基础的切片方法，始终过不去</p><p>最后在cofegolf上找到了结果</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s1>&#39;tsnrhtdd&#39;</span><span class=p>[</span><span class=n>n</span><span class=o>%</span><span class=mi>5</span><span class=o>*</span><span class=p>(</span><span class=n>n</span><span class=o>%</span><span class=mi>100</span><span class=o>^</span><span class=mi>15</span><span class=o>&gt;</span><span class=mi>4</span><span class=o>&gt;</span><span class=n>n</span><span class=o>%</span><span class=mi>10</span><span class=p>)::</span><span class=mi>4</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=帅的被人砍>帅的被人砍</h2><p>只补全解密后部分，如何得到第二行密钥还需要补充</p><p>图片文件名 <code>hide.jpg</code> 提示可能有隐写，稍作尝试后使用 steghide 提取出 <code>key.txt</code>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PZNCKSLLLNWUMILYTNQSXCIDUNBHBDFV
</span></span></code></pre></td></tr></table></div></div><p>怀疑其是加密使用的密钥，尝试代入解密器源码中编译运行：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>char</span> <span class=n>key</span><span class=p>[</span><span class=mi>32</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=sc>&#39;P&#39;</span><span class=p>,</span> <span class=sc>&#39;Z&#39;</span><span class=p>,</span> <span class=sc>&#39;N&#39;</span><span class=p>,</span> <span class=sc>&#39;C&#39;</span><span class=p>,</span> <span class=sc>&#39;K&#39;</span><span class=p>,</span> <span class=sc>&#39;S&#39;</span><span class=p>,</span> <span class=sc>&#39;L&#39;</span><span class=p>,</span> <span class=sc>&#39;L&#39;</span><span class=p>,</span> <span class=sc>&#39;L&#39;</span><span class=p>,</span> <span class=sc>&#39;N&#39;</span><span class=p>,</span> <span class=sc>&#39;W&#39;</span><span class=p>,</span> <span class=sc>&#39;U&#39;</span><span class=p>,</span> <span class=sc>&#39;M&#39;</span><span class=p>,</span> <span class=sc>&#39;I&#39;</span><span class=p>,</span> <span class=sc>&#39;L&#39;</span><span class=p>,</span> <span class=sc>&#39;Y&#39;</span><span class=p>,</span> <span class=sc>&#39;T&#39;</span><span class=p>,</span> <span class=sc>&#39;N&#39;</span><span class=p>,</span> <span class=sc>&#39;Q&#39;</span><span class=p>,</span> <span class=sc>&#39;S&#39;</span><span class=p>,</span> <span class=sc>&#39;X&#39;</span><span class=p>,</span> <span class=sc>&#39;C&#39;</span><span class=p>,</span> <span class=sc>&#39;I&#39;</span><span class=p>,</span> <span class=sc>&#39;D&#39;</span><span class=p>,</span> <span class=sc>&#39;U&#39;</span><span class=p>,</span> <span class=sc>&#39;N&#39;</span><span class=p>,</span> <span class=sc>&#39;B&#39;</span><span class=p>,</span> <span class=sc>&#39;H&#39;</span><span class=p>,</span> <span class=sc>&#39;B&#39;</span><span class=p>,</span> <span class=sc>&#39;D&#39;</span><span class=p>,</span> <span class=sc>&#39;F&#39;</span><span class=p>,</span> <span class=sc>&#39;V&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=c1>//需要将其换成获得的key 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>decrypt_file</span><span class=p>(</span><span class=s>&#34;动态KEY生成器.lock&#34;</span><span class=p>,</span> <span class=s>&#34;动态KEY生成器.re&#34;</span><span class=p>,</span> <span class=n>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>system</span><span class=p>(</span><span class=s>&#34;chmod +x 动态KEY生成器.re&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>运行后输出 <code>.re</code> 文件，经验证是合法的 Linux ELF 程序。对其进行逆向分析，是取运行时的系统时间，处理后与硬编码数据逐位异或输出。主函数反编译代码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl>  <span class=n>v15</span> <span class=o>=</span> <span class=n>__readfsqword</span><span class=p>(</span><span class=mh>0x28u</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v10</span> <span class=o>=</span> <span class=n>time</span><span class=p>(</span><span class=mi>0LL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>snprintf</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=mh>0x40uLL</span><span class=p>,</span> <span class=s>&#34;%lld&#34;</span><span class=p>,</span> <span class=n>v10</span> <span class=o>*</span> <span class=p>(</span><span class=kr>__int64</span><span class=p>)</span><span class=n>v10</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v11</span> <span class=o>=</span> <span class=n>strlen</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=n>v11</span> <span class=o>&gt;</span> <span class=mi>15</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>v3</span> <span class=o>=</span> <span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=n>v11</span> <span class=o>-</span> <span class=mi>16</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>v4</span> <span class=o>=</span> <span class=o>*</span><span class=p>((</span><span class=n>_QWORD</span> <span class=o>*</span><span class=p>)</span><span class=n>v3</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>v12</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=n>_QWORD</span> <span class=o>*</span><span class=p>)</span><span class=n>v3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>v13</span> <span class=o>=</span> <span class=n>v4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>memset</span><span class=p>(</span><span class=o>&amp;</span><span class=n>v12</span><span class=p>,</span> <span class=mi>48</span><span class=p>,</span> <span class=mi>16</span> <span class=o>-</span> <span class=n>v11</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>memcpy</span><span class=p>((</span><span class=kt>char</span> <span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>v12</span> <span class=o>+</span> <span class=mi>16</span> <span class=o>-</span> <span class=n>v11</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=n>v11</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=mi>3</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>v5</span> <span class=o>=</span> <span class=o>&amp;</span><span class=n>s</span><span class=p>[</span><span class=mi>16</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>64</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>v6</span> <span class=o>=</span> <span class=n>v13</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=p>(</span><span class=n>_QWORD</span> <span class=o>*</span><span class=p>)</span><span class=n>v5</span> <span class=o>=</span> <span class=n>v12</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=p>((</span><span class=n>_QWORD</span> <span class=o>*</span><span class=p>)</span><span class=n>v5</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>=</span> <span class=n>v6</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>printf</span><span class=p>(</span><span class=s>&#34;KEY&gt;&gt;  &#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;=</span> <span class=mi>63</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>putchar</span><span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=n>j</span> <span class=o>+</span> <span class=mi>64</span><span class=p>]</span> <span class=o>^</span> <span class=n>byte_B60</span><span class=p>[</span><span class=n>j</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>  <span class=n>puts</span><span class=p>(</span><span class=o>&amp;::</span><span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0LL</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>​<code>byte_B60</code> 是已知的，但时间我们不知道。考虑到前面从 flag 生成器中得到的未知字符串，可能是加密后数据，于是结合 key 生成逻辑，用脚本进行反推：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>binascii</span> <span class=kn>import</span> <span class=n>unhexlify</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>mask_hex</span><span class=o>=</span><span class=s2>&#34;5E5544425C07040D0751010B42010E000558004B4641454C464A52545F5B5D01767660756D7D4A575C495309070704555E404146405953480201090E0250054B00&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>M</span><span class=o>=</span><span class=nb>bytearray</span><span class=p>(</span><span class=n>unhexlify</span><span class=p>(</span><span class=n>mask_hex</span><span class=p>));</span> <span class=n>M</span><span class=o>=</span><span class=n>M</span><span class=p>[:</span><span class=mi>64</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>cipher</span><span class=o>=</span><span class=sa>b</span><span class=s2>&#34;oeqqh2550i12v3964h5xrtttqrbmkij7&#34;</span>
</span></span><span class=line><span class=cl><span class=n>cands</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>start</span> <span class=ow>in</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>16</span><span class=p>,</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ms</span><span class=o>=</span><span class=n>M</span><span class=p>[</span><span class=n>start</span><span class=p>:</span><span class=n>start</span><span class=o>+</span><span class=mi>32</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>Q</span><span class=o>=</span><span class=nb>bytes</span><span class=p>([</span><span class=n>c</span> <span class=o>^</span> <span class=n>m</span> <span class=k>for</span> <span class=n>c</span><span class=p>,</span><span class=n>m</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>cipher</span><span class=p>,</span> <span class=n>ms</span><span class=p>)])</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span><span class=p>,</span> <span class=n>b</span> <span class=o>=</span> <span class=n>Q</span><span class=p>[:</span><span class=mi>16</span><span class=p>],</span> <span class=n>Q</span><span class=p>[</span><span class=mi>16</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ok_digits</span> <span class=o>=</span> <span class=nb>all</span><span class=p>(</span><span class=mi>48</span> <span class=o>&lt;=</span> <span class=n>x</span> <span class=o>&lt;=</span> <span class=mi>57</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>ms</span><span class=p>)</span><span class=o>==</span><span class=mi>32</span> <span class=ow>and</span> <span class=n>a</span><span class=o>==</span><span class=n>b</span> <span class=ow>and</span> <span class=n>ok_digits</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>cands</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>start</span><span class=p>,</span> <span class=n>a</span><span class=o>.</span><span class=n>decode</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;candidates:&#34;</span><span class=p>,</span> <span class=n>cands</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># candidates: [(0, &#39;1053451878094276&#39;)]</span>
</span></span></code></pre></td></tr></table></div></div><p>得到 <code>1053451878094276</code> 这一个数字，为异或过程用到的 key，解密：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>binascii</span> <span class=kn>import</span> <span class=n>unhexlify</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>S</span><span class=o>=</span><span class=sa>b</span><span class=s1>&#39;1053451878094276&#39;</span>
</span></span><span class=line><span class=cl><span class=n>P</span><span class=o>=</span><span class=n>S</span><span class=o>*</span><span class=mi>4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>mask_hex</span><span class=o>=</span><span class=s1>&#39;5E5544425C07040D0751010B42010E000558004B4641454C464A52545F5B5D01767660756D7D4A575C495309070704555E404146405953480201090E0250054B00&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>M</span><span class=o>=</span><span class=nb>bytearray</span><span class=p>(</span><span class=n>unhexlify</span><span class=p>(</span><span class=n>mask_hex</span><span class=p>))[:</span><span class=mi>64</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>O</span><span class=o>=</span><span class=nb>bytes</span><span class=p>([</span><span class=n>p</span><span class=o>^</span><span class=n>m</span> <span class=k>for</span> <span class=n>p</span><span class=p>,</span><span class=n>m</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>P</span><span class=p>,</span><span class=n>M</span><span class=p>)])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;full64:&#39;</span><span class=p>,</span><span class=n>O</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;latin1&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;first32:&#39;</span><span class=p>,</span><span class=n>O</span><span class=p>[:</span><span class=mi>32</span><span class=p>]</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;latin1&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;last32:&#39;</span><span class=p>,</span><span class=n>O</span><span class=p>[</span><span class=mi>32</span><span class=p>:]</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;latin1&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># full64: oeqqh2550i12v3964h5xrtttqrbmkij7GFUFYH{okqc0353coptutlbp59976b2}</span>
</span></span><span class=line><span class=cl><span class=c1># first32: oeqqh2550i12v3964h5xrtttqrbmkij7</span>
</span></span><span class=line><span class=cl><span class=c1># last32: GFUFYH{okqc0353coptutlbp59976b2}</span>
</span></span></code></pre></td></tr></table></div></div><p>得到的 <code>full64</code> 即为经 flag 生成器处理前的原内容，输入后得到 Flag：</p><p><img src=https://raw.githubusercontent.com/Wh1teJ0ker/PicGo/main/Pic471e20b58165a03fab4259cfbe4338ca-20251012005758-3rur1sm.png alt=471e20b58165a03fab4259cfbe4338ca></p><h2 id=polar>polar</h2><p>‍</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>construction</span><span class=p>(</span><span class=n>N</span><span class=p>,</span> <span class=n>K</span><span class=p>,</span> <span class=n>eps</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>infoIndex</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>frozenIndex</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>infoIndex</span><span class=p>,</span> <span class=n>frozenIndex</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>N</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>encode</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>N</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>N</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>u</span><span class=p>[</span><span class=mi>4</span><span class=p>];</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>u</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>u</span><span class=p>[</span><span class=mi>5</span><span class=p>];</span> <span class=n>x</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=n>u</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=n>u</span><span class=p>[</span><span class=mi>6</span><span class=p>];</span> <span class=n>x</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>=</span> <span class=n>u</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>=</span> <span class=n>u</span><span class=p>[</span><span class=mi>7</span><span class=p>];</span> <span class=n>x</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>=</span> <span class=n>u</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decode</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>frozenIndex</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>N</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>uh</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>N</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>decide</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=n>q</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span> <span class=o>=</span> <span class=n>y</span><span class=p>[</span><span class=n>p</span><span class=p>];</span> <span class=n>b</span> <span class=o>=</span> <span class=n>y</span><span class=p>[</span><span class=n>q</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>a</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>b</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>a</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>b</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>a</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span> <span class=k>if</span> <span class=p>(</span><span class=n>a</span> <span class=o>+</span> <span class=n>b</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>1</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>uh</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=n>decide</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>uh</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>=</span> <span class=n>decide</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>uh</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>=</span> <span class=n>decide</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>uh</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>=</span> <span class=n>decide</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>frozenIndex</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>uh</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>uh</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=dsai>DS&amp;AI</h1><h1 id=mini-modelscope>Mini-modelscope</h1><p>发现使用tensflow，合理猜想思路应该是通过写入，让模型在导入的时候实现命令执行</p><p>根据题目描述，推理时，模型的签名 serve 会返回指定文件（这里是 /flag）的内容</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>tensorflow</span> <span class=k>as</span> <span class=nn>tf</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>shutil</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>zipfile</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>EXPORT_DIR</span> <span class=o>=</span> <span class=s2>&#34;mdoel&#34;</span>
</span></span><span class=line><span class=cl><span class=n>ZIP_NAME</span> <span class=o>=</span> <span class=s2>&#34;model.zip&#34;</span>
</span></span><span class=line><span class=cl><span class=n>FLAG_PATH</span> <span class=o>=</span> <span class=s2>&#34;/flag&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>EXPORT_DIR</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>shutil</span><span class=o>.</span><span class=n>rmtree</span><span class=p>(</span><span class=n>EXPORT_DIR</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>ZIP_NAME</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>ZIP_NAME</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@tf.function</span><span class=p>(</span><span class=n>input_signature</span><span class=o>=</span><span class=p>[</span><span class=n>tf</span><span class=o>.</span><span class=n>TensorSpec</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=p>[</span><span class=kc>None</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>float32</span><span class=p>)])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>serve_fn</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>io</span><span class=o>.</span><span class=n>read_file</span><span class=p>(</span><span class=n>FLAG_PATH</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>batch_dim</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>shape</span><span class=p>(</span><span class=n>x</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>data_vec</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>repeat</span><span class=p>(</span><span class=n>tf</span><span class=o>.</span><span class=n>expand_dims</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>repeats</span><span class=o>=</span><span class=n>batch_dim</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;prediction&#34;</span><span class=p>:</span> <span class=n>data_vec</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ModelWrapper</span><span class=p>(</span><span class=n>tf</span><span class=o>.</span><span class=n>Module</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nd>@tf.function</span><span class=p>(</span><span class=n>input_signature</span><span class=o>=</span><span class=p>[</span><span class=n>tf</span><span class=o>.</span><span class=n>TensorSpec</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=p>[</span><span class=kc>None</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>float32</span><span class=p>)])</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__call__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>inputs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>serve_fn</span><span class=p>(</span><span class=n>inputs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>model_instance</span> <span class=o>=</span> <span class=n>ModelWrapper</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>tf</span><span class=o>.</span><span class=n>saved_model</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>model_instance</span><span class=p>,</span> <span class=n>EXPORT_DIR</span><span class=p>,</span> <span class=n>signatures</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;serve&#34;</span><span class=p>:</span> <span class=n>serve_fn</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>zipfile</span><span class=o>.</span><span class=n>ZipFile</span><span class=p>(</span><span class=n>ZIP_NAME</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>,</span> <span class=n>zipfile</span><span class=o>.</span><span class=n>ZIP_DEFLATED</span><span class=p>)</span> <span class=k>as</span> <span class=n>zf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>root</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>files</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>walk</span><span class=p>(</span><span class=n>EXPORT_DIR</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>file</span> <span class=ow>in</span> <span class=n>files</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>full_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>root</span><span class=p>,</span> <span class=n>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>rel_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>relpath</span><span class=p>(</span><span class=n>full_path</span><span class=p>,</span> <span class=n>EXPORT_DIR</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>zf</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>full_path</span><span class=p>,</span> <span class=n>rel_path</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=dataidsort>dataIdSort</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span><span class=o>,</span> <span class=nn>csv</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pathlib</span> <span class=kn>import</span> <span class=n>Path</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>Counter</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ---------------- 工具函数 ----------------</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>is_valid_date_yyyymmdd</span><span class=p>(</span><span class=n>s</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>datetime</span><span class=o>.</span><span class=n>strptime</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=s2>&#34;%Y%m</span><span class=si>%d</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>id_checksum_char</span><span class=p>(</span><span class=n>id17</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span> <span class=o>=</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>tab</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;1&#39;</span><span class=p>,</span><span class=s1>&#39;0&#39;</span><span class=p>,</span><span class=s1>&#39;X&#39;</span><span class=p>,</span><span class=s1>&#39;9&#39;</span><span class=p>,</span><span class=s1>&#39;8&#39;</span><span class=p>,</span><span class=s1>&#39;7&#39;</span><span class=p>,</span><span class=s1>&#39;6&#39;</span><span class=p>,</span><span class=s1>&#39;5&#39;</span><span class=p>,</span><span class=s1>&#39;4&#39;</span><span class=p>,</span><span class=s1>&#39;3&#39;</span><span class=p>,</span><span class=s1>&#39;2&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>tab</span><span class=p>[</span><span class=nb>sum</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>a</span><span class=p>)</span><span class=o>*</span><span class=n>b</span> <span class=k>for</span> <span class=n>a</span><span class=p>,</span><span class=n>b</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>id17</span><span class=p>,</span> <span class=n>w</span><span class=p>))</span> <span class=o>%</span> <span class=mi>11</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>valid_id</span><span class=p>(</span><span class=n>raw</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>core</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;[-\s]&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>raw</span><span class=p>)</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>re</span><span class=o>.</span><span class=n>fullmatch</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;\d</span><span class=si>{17}</span><span class=s1>[0-9X]&#39;</span><span class=p>,</span> <span class=n>core</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>core</span><span class=p>[:</span><span class=mi>6</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;000000&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>prov</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>core</span><span class=p>[:</span><span class=mi>2</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span><span class=mi>11</span> <span class=o>&lt;=</span> <span class=n>prov</span> <span class=o>&lt;=</span> <span class=mi>65</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>core</span><span class=p>[</span><span class=mi>14</span><span class=p>:</span><span class=mi>17</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;000&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>core</span><span class=p>[</span><span class=mi>6</span><span class=p>:</span><span class=mi>14</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>bd</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>strptime</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=s2>&#34;%Y%m</span><span class=si>%d</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>bd</span><span class=o>.</span><span class=n>year</span> <span class=o>&lt;</span> <span class=mi>1900</span> <span class=ow>or</span> <span class=n>bd</span> <span class=o>&gt;</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>core</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=n>id_checksum_char</span><span class=p>(</span><span class=n>core</span><span class=p>[:</span><span class=mi>17</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>luhn_ok</span><span class=p>(</span><span class=n>num</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>num</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;[\s-]&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span><span class=mi>16</span> <span class=o>&lt;=</span> <span class=nb>len</span><span class=p>(</span><span class=n>num</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=mi>19</span> <span class=ow>and</span> <span class=n>num</span><span class=o>.</span><span class=n>isdigit</span><span class=p>()):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=n>ds</span> <span class=o>=</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>num</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>d</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>ds</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>i</span> <span class=o>%</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>d</span> <span class=o>=</span> <span class=n>d</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>-</span> <span class=mi>9</span> <span class=k>if</span> <span class=n>d</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>&gt;</span> <span class=mi>9</span> <span class=k>else</span> <span class=n>d</span> <span class=o>*</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>+=</span> <span class=n>d</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>s</span> <span class=o>%</span> <span class=mi>10</span> <span class=o>==</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>valid_ip</span><span class=p>(</span><span class=n>ip</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ip</span> <span class=o>=</span> <span class=n>ip</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;．&#34;</span><span class=p>,</span> <span class=s2>&#34;.&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;。&#34;</span><span class=p>,</span> <span class=s2>&#34;.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parts</span> <span class=o>=</span> <span class=n>ip</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>4</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>parts</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span><span class=mi>0</span> <span class=o>&lt;=</span> <span class=nb>int</span><span class=p>(</span><span class=n>p</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=mi>255</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>p</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=ow>and</span> <span class=n>p</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;0&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ---------------- 常量集合 ----------------</span>
</span></span><span class=line><span class=cl><span class=n>PHONE_PREFIX3</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;130&#39;</span><span class=p>,</span><span class=s1>&#39;131&#39;</span><span class=p>,</span><span class=s1>&#39;132&#39;</span><span class=p>,</span><span class=s1>&#39;133&#39;</span><span class=p>,</span><span class=s1>&#39;134&#39;</span><span class=p>,</span><span class=s1>&#39;135&#39;</span><span class=p>,</span><span class=s1>&#39;136&#39;</span><span class=p>,</span><span class=s1>&#39;137&#39;</span><span class=p>,</span><span class=s1>&#39;138&#39;</span><span class=p>,</span><span class=s1>&#39;139&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;140&#39;</span><span class=p>,</span><span class=s1>&#39;145&#39;</span><span class=p>,</span><span class=s1>&#39;146&#39;</span><span class=p>,</span><span class=s1>&#39;149&#39;</span><span class=p>,</span><span class=s1>&#39;150&#39;</span><span class=p>,</span><span class=s1>&#39;151&#39;</span><span class=p>,</span><span class=s1>&#39;152&#39;</span><span class=p>,</span><span class=s1>&#39;153&#39;</span><span class=p>,</span><span class=s1>&#39;155&#39;</span><span class=p>,</span><span class=s1>&#39;156&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;166&#39;</span><span class=p>,</span><span class=s1>&#39;167&#39;</span><span class=p>,</span><span class=s1>&#39;171&#39;</span><span class=p>,</span><span class=s1>&#39;172&#39;</span><span class=p>,</span><span class=s1>&#39;173&#39;</span><span class=p>,</span><span class=s1>&#39;174&#39;</span><span class=p>,</span><span class=s1>&#39;175&#39;</span><span class=p>,</span><span class=s1>&#39;176&#39;</span><span class=p>,</span><span class=s1>&#39;177&#39;</span><span class=p>,</span><span class=s1>&#39;178&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;180&#39;</span><span class=p>,</span><span class=s1>&#39;181&#39;</span><span class=p>,</span><span class=s1>&#39;182&#39;</span><span class=p>,</span><span class=s1>&#39;183&#39;</span><span class=p>,</span><span class=s1>&#39;184&#39;</span><span class=p>,</span><span class=s1>&#39;185&#39;</span><span class=p>,</span><span class=s1>&#39;186&#39;</span><span class=p>,</span><span class=s1>&#39;187&#39;</span><span class=p>,</span><span class=s1>&#39;188&#39;</span><span class=p>,</span><span class=s1>&#39;189&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;190&#39;</span><span class=p>,</span><span class=s1>&#39;191&#39;</span><span class=p>,</span><span class=s1>&#39;193&#39;</span><span class=p>,</span><span class=s1>&#39;195&#39;</span><span class=p>,</span><span class=s1>&#39;196&#39;</span><span class=p>,</span><span class=s1>&#39;198&#39;</span><span class=p>,</span><span class=s1>&#39;199&#39;</span><span class=p>,</span><span class=s1>&#39;147&#39;</span><span class=p>,</span><span class=s1>&#39;148&#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>prefix_alt</span> <span class=o>=</span> <span class=s2>&#34;(?:&#34;</span> <span class=o>+</span> <span class=s2>&#34;|&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>sorted</span><span class=p>(</span><span class=n>PHONE_PREFIX3</span><span class=p>))</span> <span class=o>+</span> <span class=s2>&#34;)&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ---------------- 正则模式 ----------------</span>
</span></span><span class=line><span class=cl><span class=n>PATTERNS</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;idcard&#34;</span><span class=p>:</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;(?&lt;!\d)(?:\d</span><span class=si>{17}</span><span class=s1>[0-9Xx]|\d</span><span class=si>{6}</span><span class=s1>[-\s]+\d</span><span class=si>{8}</span><span class=s1>[-\s]+\d</span><span class=si>{3}</span><span class=s1>[0-9Xx])(?!\d)&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;phone&#34;</span><span class=p>:</span>  <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>rf</span><span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>        (?&lt;!\d)
</span></span></span><span class=line><span class=cl><span class=s1>        (?:\+86\s*|\(\+86\)\s*)?
</span></span></span><span class=line><span class=cl><span class=s1>        (</span><span class=si>{</span><span class=n>prefix_alt</span><span class=si>}</span><span class=s1>)
</span></span></span><span class=line><span class=cl><span class=s1>        (?:
</span></span></span><span class=line><span class=cl><span class=s1>            \d</span><span class=se>{{</span><span class=s1>8</span><span class=se>}}</span><span class=s1>                           # 连续 11 位（已含前三位）
</span></span></span><span class=line><span class=cl><span class=s1>          | [-\s]\d</span><span class=se>{{</span><span class=s1>4</span><span class=se>}}</span><span class=s1>[-\s]\d</span><span class=se>{{</span><span class=s1>4</span><span class=se>}}</span><span class=s1>          # 严格 3-4-4：恰好两处分隔
</span></span></span><span class=line><span class=cl><span class=s1>        )
</span></span></span><span class=line><span class=cl><span class=s1>        (?!\d)
</span></span></span><span class=line><span class=cl><span class=s1>    &#39;&#39;&#39;</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>VERBOSE</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;bankcard&#34;</span><span class=p>:</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>r</span><span class=s1>&#39;(?&lt;!\d)(?:&#39;</span>
</span></span><span class=line><span class=cl>        <span class=sa>r</span><span class=s1>&#39;(?:[1-9]\d{15,18})&#39;</span>
</span></span><span class=line><span class=cl>        <span class=sa>r</span><span class=s1>&#39;)(?!\d)&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;ip&#34;</span><span class=p>:</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;(?&lt;!\d)(?:\d{1,3}\.)</span><span class=si>{3}</span><span class=s1>\d{1,3}(?!\d)&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;mac&#34;</span><span class=p>:</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;[0-9A-Fa-f]</span><span class=si>{2}</span><span class=s1>(?::[0-9A-Fa-f]</span><span class=si>{2}</span><span class=s1>)</span><span class=si>{5}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ---------------- 核心识别函数 ----------------</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>detect_sensitive_data</span><span class=p>(</span><span class=n>text</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span><span class=p>,</span> <span class=n>seen</span> <span class=o>=</span> <span class=p>[],</span> <span class=nb>set</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>push</span><span class=p>(</span><span class=n>cat</span><span class=p>,</span> <span class=n>val</span><span class=p>,</span> <span class=n>pos</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>cat</span><span class=p>,</span> <span class=n>val</span><span class=p>)</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>seen</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>seen</span><span class=o>.</span><span class=n>add</span><span class=p>((</span><span class=n>cat</span><span class=p>,</span> <span class=n>val</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>out</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>pos</span><span class=p>,</span> <span class=n>cat</span><span class=p>,</span> <span class=n>val</span><span class=o>.</span><span class=n>strip</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>PATTERNS</span><span class=p>[</span><span class=s2>&#34;idcard&#34;</span><span class=p>]</span><span class=o>.</span><span class=n>finditer</span><span class=p>(</span><span class=n>text</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>valid_id</span><span class=p>(</span><span class=n>s</span><span class=p>):</span> <span class=n>push</span><span class=p>(</span><span class=s2>&#34;idcard&#34;</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=n>m</span><span class=o>.</span><span class=n>start</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>PATTERNS</span><span class=p>[</span><span class=s2>&#34;phone&#34;</span><span class=p>]</span><span class=o>.</span><span class=n>finditer</span><span class=p>(</span><span class=n>text</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>digits</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;\D&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>digits</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&#34;86&#34;</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=n>digits</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>11</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>digits</span> <span class=o>=</span> <span class=n>digits</span><span class=p>[</span><span class=mi>2</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>digits</span><span class=p>)</span> <span class=o>==</span> <span class=mi>11</span> <span class=ow>and</span> <span class=n>digits</span><span class=p>[:</span><span class=mi>3</span><span class=p>]</span> <span class=ow>in</span> <span class=n>PHONE_PREFIX3</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>mid</span> <span class=o>=</span> <span class=n>digits</span><span class=p>[</span><span class=mi>3</span><span class=p>:</span><span class=mi>7</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;(19|20)\d</span><span class=si>{2}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>mid</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>push</span><span class=p>(</span><span class=s2>&#34;phone&#34;</span><span class=p>,</span> <span class=n>s</span><span class=o>.</span><span class=n>strip</span><span class=p>(),</span> <span class=n>m</span><span class=o>.</span><span class=n>start</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>PATTERNS</span><span class=p>[</span><span class=s2>&#34;bankcard&#34;</span><span class=p>]</span><span class=o>.</span><span class=n>finditer</span><span class=p>(</span><span class=n>text</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>luhn_ok</span><span class=p>(</span><span class=n>s</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;\d</span><span class=si>{6}</span><span class=s1>(19|20)\d</span><span class=si>{2}</span><span class=s1>(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])&#39;</span><span class=p>,</span> <span class=n>s</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>push</span><span class=p>(</span><span class=s2>&#34;bankcard&#34;</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=n>m</span><span class=o>.</span><span class=n>start</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>PATTERNS</span><span class=p>[</span><span class=s2>&#34;ip&#34;</span><span class=p>]</span><span class=o>.</span><span class=n>finditer</span><span class=p>(</span><span class=n>text</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>valid_ip</span><span class=p>(</span><span class=n>s</span><span class=p>):</span> <span class=n>push</span><span class=p>(</span><span class=s2>&#34;ip&#34;</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=n>m</span><span class=o>.</span><span class=n>start</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>PATTERNS</span><span class=p>[</span><span class=s2>&#34;mac&#34;</span><span class=p>]</span><span class=o>.</span><span class=n>finditer</span><span class=p>(</span><span class=n>text</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>all</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>fullmatch</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;[0-9A-Fa-f]</span><span class=si>{2}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>seg</span><span class=p>)</span> <span class=k>for</span> <span class=n>seg</span> <span class=ow>in</span> <span class=n>s</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;:&#34;</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>            <span class=n>push</span><span class=p>(</span><span class=s2>&#34;mac&#34;</span><span class=p>,</span> <span class=n>s</span><span class=o>.</span><span class=n>lower</span><span class=p>(),</span> <span class=n>m</span><span class=o>.</span><span class=n>start</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># ✳️ 改动关键处：分类排序（不按出现顺序，而按类别块排序）</span>
</span></span><span class=line><span class=cl>    <span class=n>category_order</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;idcard&#34;</span><span class=p>,</span> <span class=s2>&#34;phone&#34;</span><span class=p>,</span> <span class=s2>&#34;bankcard&#34;</span><span class=p>,</span> <span class=s2>&#34;ip&#34;</span><span class=p>,</span> <span class=s2>&#34;mac&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=p>(</span><span class=n>category_order</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]),</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>out</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ---------------- 输出 ----------------</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>write_to_csv</span><span class=p>(</span><span class=n>out_data</span><span class=p>,</span> <span class=n>output_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>output_path</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&#34;w&#34;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s2>&#34;utf-8&#34;</span><span class=p>,</span> <span class=n>newline</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>writer</span> <span class=o>=</span> <span class=n>csv</span><span class=o>.</span><span class=n>writer</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>writer</span><span class=o>.</span><span class=n>writerow</span><span class=p>([</span><span class=s2>&#34;category&#34;</span><span class=p>,</span> <span class=s2>&#34;value&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>cat</span><span class=p>,</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>out_data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>writer</span><span class=o>.</span><span class=n>writerow</span><span class=p>([</span><span class=n>cat</span><span class=p>,</span> <span class=n>val</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ---------------- 主程序 ----------------</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>DATA_PATH</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=s2>&#34;data.txt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>OUT_PATH</span>  <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=s2>&#34;result_plus_grouped.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>text</span> <span class=o>=</span> <span class=n>DATA_PATH</span><span class=o>.</span><span class=n>read_text</span><span class=p>(</span><span class=n>encoding</span><span class=o>=</span><span class=s2>&#34;utf-8&#34;</span><span class=p>,</span> <span class=n>errors</span><span class=o>=</span><span class=s2>&#34;ignore&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span> <span class=o>=</span> <span class=n>detect_sensitive_data</span><span class=p>(</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>write_to_csv</span><span class=p>(</span><span class=n>results</span><span class=p>,</span> <span class=n>OUT_PATH</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cnt</span> <span class=o>=</span> <span class=n>Counter</span><span class=p>(</span><span class=n>c</span> <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=n>_</span> <span class=ow>in</span> <span class=n>results</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;✅ 输出文件: </span><span class=si>{</span><span class=n>OUT_PATH</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;📊 统计:&#34;</span><span class=p>,</span> <span class=nb>dict</span><span class=p>(</span><span class=n>cnt</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div></section><div class=comments><script>const getTheme=window.localStorage&&window.localStorage.getItem("theme");let theme=getTheme==="dark"?"dark":"light",s=document.createElement("script");s.src="https://giscus.app/client.js",s.setAttribute("data-repo","Wh1teJ0ker/discussion"),s.setAttribute("data-repo-id","R_kgDOOTzcZA"),s.setAttribute("data-category","Announcements"),s.setAttribute("data-category-id","DIC_kwDOOTzcZM4CoxXV"),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","top"),s.setAttribute("data-theme",theme),s.setAttribute("data-lang","zh-CN"),s.setAttribute("data-loading","lazy"),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div><div class=paginator><a class=next href=https://wh1tej0ker.github.io/post/2025-beijingtianjinhebei-great-wall-cup-ai-kjo1e.html><span>2025京津冀长城杯- AI</span><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966 16.0174 11.8297 16.0154 11.9753 15.9494 12.0063 14.945 12.4779 13.0706 13.9264 12.055 15m3.5006-3.0333C13.1345 12.0608 8 12 6 11" stroke="currentcolor" stroke-linecap="round"/></svg></a></div></article></div><footer class=footer><p>&copy; 2025 <a href=https://wh1tej0ker.github.io/>Wh1teJ0kerのBlog</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=/main.min.cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e.js integrity="sha512-z4PhNX7vuL3xVChQ1m2AB9Yg5AULVxXcg/SpIdNs6c5H0NE8XYXysP+DGNKHfuwvY7kxvUdBeoGlODJ6+SfaPg==" crossorigin=anonymous defer></script></html>